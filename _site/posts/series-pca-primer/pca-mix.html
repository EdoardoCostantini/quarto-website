<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Edoardo Costantini">
<meta name="dcterms.date" content="2022-05-17">

<title>Edo - PCA with metrics, dimensionality reduction through PCA and MCA</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Edo</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-digital-garden" role="button" data-bs-toggle="dropdown" aria-expanded="false">Digital garden</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-digital-garden">    
        <li>
    <a class="dropdown-item" href="../../all-posts.html">
 <span class="dropdown-text">All posts</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../series-pca.html">
 <span class="dropdown-text">A primer on PCA</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../series-sm-course.html">
 <span class="dropdown-text">Course: Statistics and Methodology</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../series-sampling.html">
 <span class="dropdown-text">Sampling</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../research.html">Research</a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">PCA with metrics, dimensionality reduction through PCA and MCA</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Categorical data</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Edoardo Costantini </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">May 17, 2022</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#generalised-singular-value-decomposition" id="toc-generalised-singular-value-decomposition" class="nav-link" data-scroll-target="#generalised-singular-value-decomposition">Generalised Singular Value Decomposition</a></li>
  <li><a href="#relationship-of-gsvd-to-standard-svd" id="toc-relationship-of-gsvd-to-standard-svd" class="nav-link" data-scroll-target="#relationship-of-gsvd-to-standard-svd">Relationship of GSVD to standard SVD</a></li>
  <li><a href="#pca-and-mca-as-special-cases-of-gsvd" id="toc-pca-and-mca-as-special-cases-of-gsvd" class="nav-link" data-scroll-target="#pca-and-mca-as-special-cases-of-gsvd">PCA and MCA as special cases of GSVD</a>
  <ul class="collapse">
  <li><a href="#pca" id="toc-pca" class="nav-link" data-scroll-target="#pca">PCA</a></li>
  <li><a href="#mca" id="toc-mca" class="nav-link" data-scroll-target="#mca">MCA</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#learn-by-coding" id="toc-learn-by-coding" class="nav-link" data-scroll-target="#learn-by-coding">Learn by coding</a></li>
  <li><a href="#tldr-just-give-me-the-code" id="toc-tldr-just-give-me-the-code" class="nav-link" data-scroll-target="#tldr-just-give-me-the-code">TL;DR, just give me the code!</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p><strong>Principal Component Analysis</strong> (PCA) is a technique that finds a low-dimensional representation of a large set of variables contained in an <span class="math inline">\(n \times p\)</span> data matrix <span class="math inline">\(\mathbf{X}\)</span> with minimal loss of information. We refer to this low-dimensional representation as the <span class="math inline">\(n \times r\)</span> matrix <span class="math inline">\(\mathbf{Z}\)</span>, where <span class="math inline">\(r &lt; p\)</span>. The columns of <span class="math inline">\(\mathbf{Z}\)</span> are called principal components (PCs) of <span class="math inline">\(\mathbf{X}\)</span>. We can write the relationship between all the PCs and <span class="math inline">\(\mathbf{X}\)</span> in matrix notation: <span class="math display">\[\begin{equation} \label{eq:PCAmatnot}
    \mathbf{Z} = \mathbf{X} \mathbf{\Lambda}
\end{equation}\]</span> where <span class="math inline">\(\mathbf{\Lambda}\)</span> is a <span class="math inline">\(p \times r\)</span> matrix of coefficients, with columns <span class="math inline">\(\mathbf{\lambda}_1, \dots, \mathbf{\lambda}_r\)</span>. PCA can be thought of as the process of projecting the original data from a <span class="math inline">\(p\)</span>-dimensional space to a lower <span class="math inline">\(q\)</span>-dimensional space. The coefficient vectors <span class="math inline">\(\mathbf{\lambda}_1, \dots, \mathbf{\lambda}_r\)</span> define the directions in which we are projecting the <span class="math inline">\(n\)</span> observations of <span class="math inline">\(\mathbf{x}_1, \dots, \mathbf{x}_p\)</span>. The projected values are the principal component scores <span class="math inline">\(\mathbf{Z}\)</span>.</p>
<p>The goal of PCA is to find the values of <span class="math inline">\(\mathbf{\Lambda}\)</span> that maximize the variance of the columns of <span class="math inline">\(\mathbf{Z}\)</span>. One way to find the PCA solution for <span class="math inline">\(\mathbf{\Lambda}\)</span> is by taking the truncated <a href="https://en.wikipedia.org/wiki/Singular_value_decomposition#Relation_to_eigenvalue_decomposition">singular value decomposition</a> (SVD) of <span class="math inline">\(\mathbf{X}\)</span>:</p>
<p><span class="math display">\[\begin{equation} \label{eq:SVD}
    \mathbf{X} = \mathbf{UDV}'
\end{equation}\]</span></p>
<p>The PCs scores are given by the <span class="math inline">\(n \times r\)</span> matrix <span class="math inline">\(\mathbf{UD}\)</span>, and the weights <span class="math inline">\(\mathbf{\Lambda}\)</span> are given by the <span class="math inline">\(p \times r\)</span> matrix <span class="math inline">\(\mathbf{V}\)</span>.</p>
<p><strong>Multiple Correspondence Analysis</strong> (MCA) is generally regarded as an equivalent tool that applies to discrete data. Chavent et al. <span class="citation" data-cites="chaventEtAl:2014">(<a href="#ref-chaventEtAl:2014" role="doc-biblioref"><strong>chaventEtAl:2014?</strong></a>)</span> have shown how using weights on rows and columns of the input data matrix can define a general PCA framework that includes standard PCA and MCA as special cases. This approach is often referred to as <strong>PCA with metrics</strong>, as metrics are used to introduce the weights. In this post, I want to show how PCA and MCA are related through this framework.</p>
<section id="generalised-singular-value-decomposition" class="level2">
<h2 class="anchored" data-anchor-id="generalised-singular-value-decomposition">Generalised Singular Value Decomposition</h2>
<p>Consider an <span class="math inline">\(n \times p\)</span> matrix of input variables <span class="math inline">\(\mathbf{Z}\)</span> with row metric <span class="math inline">\(\mathbf{N}\)</span> and column metric <span class="math inline">\(\mathbf{M}\)</span>. The Generalized Singular Value Decomposition of <span class="math inline">\(\mathbf{Z}\)</span> can be written as: <span class="math display">\[
\mathbf{Z} = \mathbf{U \Lambda V}^T
\]</span> where:</p>
<ul>
<li><span class="math inline">\(\mathbf{\Lambda}\)</span> is the <span class="math inline">\(r \times r\)</span> diagonal matrix with elements equal to the square root of the non-zero eigenvalues of <span class="math inline">\(\mathbf{ZMZ}^T\mathbf{N}\)</span> and <span class="math inline">\(\mathbf{Z}^T\mathbf{NZM}\)</span>;</li>
<li><span class="math inline">\(\mathbf{U}\)</span> is the <span class="math inline">\(n \times r\)</span> matrix of the first <span class="math inline">\(r\)</span> eigenvectors of <span class="math inline">\(\mathbf{ZMZ}^T\mathbf{N}\)</span> such that <span class="math inline">\(\mathbf{U}^T\mathbf{MU=I}\)</span></li>
<li><span class="math inline">\(\mathbf{V}\)</span> is the <span class="math inline">\(p \times r\)</span> matrix of the first <span class="math inline">\(r\)</span> eigenvectors of <span class="math inline">\(\mathbf{Z}^T\mathbf{NZM}\)</span> such that <span class="math inline">\(\mathbf{V}^T\mathbf{MV=I}\)</span>;</li>
</ul>
<p>The GSVD of <span class="math inline">\(\mathbf{Z}\)</span> can be obtained by taking</p>
<ul>
<li>first taking the standard SVD of the transformed matrix <span class="math inline">\(\tilde{\mathbf{Z}} = \mathbf{N}^{1/2}\mathbf{Z}\mathbf{M}^{1/2}\)</span> which gives: <span class="math display">\[
\tilde{\mathbf{Z}} = \tilde{\mathbf{U}}\tilde{\mathbf{\Lambda}}\tilde{\mathbf{V}}^T
\]</span></li>
<li>and then transforming each element back to the original scale <span class="math display">\[
\mathbf{\Lambda} = \tilde{\mathbf{\Lambda}}
\]</span> <span class="math display">\[
\mathbf{U} = \mathbf{N}^{-1/2}\tilde{\mathbf{U}}
\]</span> <span class="math display">\[
\mathbf{V} = \mathbf{M}^{-1/2}\tilde{\mathbf{V}}
\]</span></li>
</ul>
</section>
<section id="relationship-of-gsvd-to-standard-svd" class="level2">
<h2 class="anchored" data-anchor-id="relationship-of-gsvd-to-standard-svd">Relationship of GSVD to standard SVD</h2>
<p>It’s easy to see how this GSVD differs from the standard formulation of SVD simply by the presence of the metrics <span class="math inline">\(\mathbf{M}\)</span> and <span class="math inline">\(\mathbf{M}\)</span>. As you can see <a href="https://en.wikipedia.org/wiki/Singular_value_decomposition#Relation_to_eigenvalue_decomposition">here</a>, in the standard formulation of SVD:</p>
<ul>
<li><span class="math inline">\(\mathbf{\Lambda}\)</span> is the <span class="math inline">\(r \times r\)</span> diagonal matrix with elements equal to the square root of the non-zero eigenvalues of <span class="math inline">\(\mathbf{ZZ}^T\)</span> and <span class="math inline">\(\mathbf{Z}^T\mathbf{Z}\)</span>;</li>
<li><span class="math inline">\(\mathbf{U}\)</span> is the <span class="math inline">\(n \times r\)</span> matrix of the first <span class="math inline">\(r\)</span> eigenvectors of <span class="math inline">\(\mathbf{ZZ}^T\)</span> such that <span class="math inline">\(\mathbf{U}^T\mathbf{U=I}\)</span></li>
<li><span class="math inline">\(\mathbf{V}\)</span> is the <span class="math inline">\(p \times r\)</span> matrix of the first <span class="math inline">\(r\)</span> eigenvectors of <span class="math inline">\(\mathbf{Z}^T\mathbf{NZM}\)</span> such that <span class="math inline">\(\mathbf{V}^T\mathbf{V=I}\)</span>;</li>
</ul>
</section>
<section id="pca-and-mca-as-special-cases-of-gsvd" class="level2">
<h2 class="anchored" data-anchor-id="pca-and-mca-as-special-cases-of-gsvd">PCA and MCA as special cases of GSVD</h2>
<p>The solutions for both PCA and MCA can be obtained as special cases of the GSVD approach described by setting <span class="math inline">\(\mathbf{Z}\)</span> equal to a preprocessed version of the original data <span class="math inline">\(\mathbf{X}\)</span> and using <span class="math inline">\(\mathbf{N}\)</span> and <span class="math inline">\(\mathbf{M}\)</span> to appropriately weight the rows and columns.</p>
<section id="pca" class="level3">
<h3 class="anchored" data-anchor-id="pca">PCA</h3>
<p>The input data for standard PCA is the <span class="math inline">\(n \times p\)</span> matrix <span class="math inline">\(\mathbf{X}\)</span> of <span class="math inline">\(n\)</span> rows (observations) described by <span class="math inline">\(p\)</span> numerical variables. The columns of this matrix are usually centered and standardized. The GSVD can be used to find the solution to PCA by setting <span class="math inline">\(\mathbf{Z}\)</span> equal to the centered and standardized version of <span class="math inline">\(\mathbf{X}\)</span> and weighting:</p>
<ul>
<li>its rows by <span class="math inline">\(1/n\)</span>, which is obtained by setting <span class="math inline">\(\mathbf{N} = \frac{1}{n}I_n\)</span></li>
<li>its columns by <span class="math inline">\(1\)</span>, which is obtained by setting <span class="math inline">\(\mathbf{M} = I_p\)</span>. This metric indicates that the distance between two observations is the standard euclidean distance between two rows of <span class="math inline">\(\mathbf{Z}\)</span></li>
</ul>
<p>By setting these values for the metrics, it is easy to see how the GSVD of <span class="math inline">\(\mathbf{X}\)</span> reduces to the standard SVD of <span class="math inline">\(\mathbf{Z}\)</span>.</p>
</section>
<section id="mca" class="level3">
<h3 class="anchored" data-anchor-id="mca">MCA</h3>
<p>For an <span class="math inline">\(n \times p\)</span> data matrix <span class="math inline">\(\mathbf{X}\)</span> with <span class="math inline">\(n\)</span> observations (rows) and <span class="math inline">\(p\)</span> discrete predictors (columns). Each <span class="math inline">\(j = 1, \dots, p\)</span> discrete variable has <span class="math inline">\(k_j\)</span> possible values. The sum of the <span class="math inline">\(p\)</span> <span class="math inline">\(k_j\)</span> values is <span class="math inline">\(k\)</span>. <span class="math inline">\(\mathbf{X}\)</span> is preprocessed by coding each level of the discrete items as binary variables describing whether each observation takes a specific value for every discrete variable. This results in an <span class="math inline">\(n \times k\)</span> <a href="https://www.xlstat.com/en/solutions/features/complete-disjuncive-tables-creating-dummy-variables">complete disjunctive table</a> <span class="math inline">\(\mathbf{G}\)</span>, sometimes also referred to as an indicator matrix.</p>
<p>MCA is usually obtained by applying Correspondence Analysis to <span class="math inline">\(\mathbf{G}\)</span>, which means applying standard PCA to the matrices of the row profiles and the column profiles. In particular, for the goal of obtaining a lower-dimensional representation of <span class="math inline">\(\mathbf{X}\)</span> we are interested in the standard PCA of the row profiles. Within the framework of PCA with metrics, MCA can be obtained by first setting:</p>
<ul>
<li><span class="math inline">\(\mathbf{Z}\)</span> to the centered <span class="math inline">\(\mathbf{G}\)</span></li>
<li><span class="math inline">\(\mathbf{N} = \frac{1}{n}I_n\)</span></li>
<li><span class="math inline">\(\mathbf{M} = \text{diag}(\frac{n}{n_s}, s = 1, \dots, k)\)</span></li>
</ul>
<p>The coordinates of the observations (the principal component scores) can be obtained by applying the GSVD of <span class="math inline">\(\mathbf{Z}\)</span> with the given metrics.</p>
</section>
</section>
</section>
<section id="learn-by-coding" class="level1">
<h1>Learn by coding</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Object: Performing Multiple Correspondance Analysis in R </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="do">### Source: Practical Guide to Principal Component Methods </span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="do">###         (Chapter 5 Code)</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Packages</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(<span class="st">"FactoMineR"</span>) <span class="co"># for analysis</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(<span class="st">"factoextra"</span>) <span class="co"># for visualizarion1</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   library("httpg")</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Data Prep ---------------------------------------------------------------</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data</span>(<span class="st">"poison"</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(poison[, <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>], <span class="dv">3</span>) <span class="co"># survey style data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Age Time   Sick Sex   Nausea Vomiting Abdominals
1   9   22 Sick_y   F Nausea_y  Vomit_n     Abdo_y
2   5    0 Sick_n   F Nausea_n  Vomit_n     Abdo_n
3   6   16 Sick_y   F Nausea_n  Vomit_y     Abdo_y</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset active individuals and variables</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  poison.active <span class="ot">&lt;-</span> poison[<span class="dv">1</span><span class="sc">:</span><span class="dv">55</span>, <span class="dv">5</span><span class="sc">:</span><span class="dv">15</span>] </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(poison.active[, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>], <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Nausea Vomiting Abdominals   Fever   Diarrhae   Potato
1 Nausea_y  Vomit_n     Abdo_y Fever_y Diarrhea_y Potato_y
2 Nausea_n  Vomit_n     Abdo_n Fever_n Diarrhea_n Potato_y
3 Nausea_n  Vomit_y     Abdo_y Fever_y Diarrhea_y Potato_y</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summaries</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str</span>(poison.active)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   55 obs. of  11 variables:
 $ Nausea    : Factor w/ 2 levels "Nausea_n","Nausea_y": 2 1 1 1 1 1 1 2 2 1 ...
 $ Vomiting  : Factor w/ 2 levels "Vomit_n","Vomit_y": 1 1 2 1 2 1 2 2 1 2 ...
 $ Abdominals: Factor w/ 2 levels "Abdo_n","Abdo_y": 2 1 2 1 2 2 2 2 2 1 ...
 $ Fever     : Factor w/ 2 levels "Fever_n","Fever_y": 2 1 2 1 2 2 2 2 2 2 ...
 $ Diarrhae  : Factor w/ 2 levels "Diarrhea_n","Diarrhea_y": 2 1 2 1 2 2 2 2 2 2 ...
 $ Potato    : Factor w/ 2 levels "Potato_n","Potato_y": 2 2 2 2 2 2 2 2 2 2 ...
 $ Fish      : Factor w/ 2 levels "Fish_n","Fish_y": 2 2 2 2 2 1 2 2 2 2 ...
 $ Mayo      : Factor w/ 2 levels "Mayo_n","Mayo_y": 2 2 2 1 2 2 2 2 2 2 ...
 $ Courgette : Factor w/ 2 levels "Courg_n","Courg_y": 2 2 2 2 2 2 2 2 2 2 ...
 $ Cheese    : Factor w/ 2 levels "Cheese_n","Cheese_y": 2 1 2 2 2 2 2 2 2 2 ...
 $ Icecream  : Factor w/ 2 levels "Icecream_n","Icecream_y": 2 2 2 2 2 2 2 2 2 2 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(poison.active[,i], <span class="at">main=</span><span class="fu">colnames</span>(poison.active)[i],</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylab =</span> <span class="st">"Count"</span>, <span class="at">col=</span><span class="st">"steelblue"</span>, <span class="at">las =</span> <span class="dv">2</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="pca-mix_files/figure-html/mca-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="pca-mix_files/figure-html/mca-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="pca-mix_files/figure-html/mca-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="pca-mix_files/figure-html/mca-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The analysis ------------------------------------------------------------</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  res.mca <span class="ot">&lt;-</span> FactoMineR<span class="sc">::</span><span class="fu">MCA</span>(<span class="at">X =</span> poison.active,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">ncp =</span> <span class="dv">5</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">graph =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization -----------------------------------------------------------</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Eigenvalues / Variances</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  eig.val <span class="ot">&lt;-</span> <span class="fu">get_eigenvalue</span>(res.mca)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  eig.val <span class="co"># proportion of variances retained by dimensions</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       eigenvalue variance.percent cumulative.variance.percent
Dim.1  0.33523140        33.523140                    33.52314
Dim.2  0.12913979        12.913979                    46.43712
Dim.3  0.10734849        10.734849                    57.17197
Dim.4  0.09587950         9.587950                    66.75992
Dim.5  0.07883277         7.883277                    74.64319
Dim.6  0.07108981         7.108981                    81.75217
Dim.7  0.06016580         6.016580                    87.76876
Dim.8  0.05577301         5.577301                    93.34606
Dim.9  0.04120578         4.120578                    97.46663
Dim.10 0.01304158         1.304158                    98.77079
Dim.11 0.01229208         1.229208                   100.00000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Percentages of Inertia explained by MCA</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fviz_screeplot</span>(res.mca, <span class="at">addlabels =</span> <span class="cn">TRUE</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">45</span>))</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Biplot</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fviz_mca_biplot</span>(res.mca,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">repel =</span> <span class="cn">TRUE</span>, <span class="co"># avoid text overlapping</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ggtheme =</span> <span class="fu">theme_minimal</span>())</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Rows (individuals) are represented by blue points;</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Columns (variable categories) by red triangles.</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Graph of variables</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  var <span class="ot">&lt;-</span> <span class="fu">get_mca_var</span>(res.mca) </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  var</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Multiple Correspondence Analysis Results for variables
 ===================================================
  Name       Description                  
1 "$coord"   "Coordinates for categories" 
2 "$cos2"    "Cos2 for categories"        
3 "$contrib" "contributions of categories"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Coordinates </span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(var<span class="sc">$</span>coord)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Dim 1       Dim 2        Dim 3       Dim 4       Dim 5
Nausea_n  0.2673909  0.12139029 -0.265583253  0.03376130  0.07370500
Nausea_y -0.9581506 -0.43498187  0.951673323 -0.12097801 -0.26410958
Vomit_n   0.4790279 -0.40919465  0.084492799  0.27361142  0.05245250
Vomit_y  -0.7185419  0.61379197 -0.126739198 -0.41041713 -0.07867876
Abdo_n    1.3180221 -0.03574501 -0.005094243 -0.15360951 -0.06986987
Abdo_y   -0.6411999  0.01738946  0.002478280  0.07472895  0.03399075</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Cos2: quality on the factore map </span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(var<span class="sc">$</span>cos2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Dim 1        Dim 2        Dim 3       Dim 4       Dim 5
Nausea_n 0.2562007 0.0528025759 2.527485e-01 0.004084375 0.019466197
Nausea_y 0.2562007 0.0528025759 2.527485e-01 0.004084375 0.019466197
Vomit_n  0.3442016 0.2511603912 1.070855e-02 0.112294813 0.004126898
Vomit_y  0.3442016 0.2511603912 1.070855e-02 0.112294813 0.004126898
Abdo_n   0.8451157 0.0006215864 1.262496e-05 0.011479077 0.002374929
Abdo_y   0.8451157 0.0006215864 1.262496e-05 0.011479077 0.002374929</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Contributions to the principal components</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(var<span class="sc">$</span>contrib)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Dim 1       Dim 2        Dim 3      Dim 4      Dim 5
Nausea_n  1.515869  0.81100008 4.670018e+00 0.08449397 0.48977906
Nausea_y  5.431862  2.90608363 1.673423e+01 0.30277007 1.75504164
Vomit_n   3.733667  7.07226253 3.627455e-01 4.25893721 0.19036376
Vomit_y   5.600500 10.60839380 5.441183e-01 6.38840581 0.28554563
Abdo_n   15.417637  0.02943661 7.192511e-04 0.73219636 0.18424268
Abdo_y    7.500472  0.01432051 3.499060e-04 0.35620363 0.08963157</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Graph of individuals</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  ind <span class="ot">&lt;-</span> <span class="fu">get_mca_ind</span>(res.mca) <span class="co"># extract the results for individuals</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  ind</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Multiple Correspondence Analysis Results for individuals
 ===================================================
  Name       Description                       
1 "$coord"   "Coordinates for the individuals" 
2 "$cos2"    "Cos2 for the individuals"        
3 "$contrib" "contributions of the individuals"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Coordinates of column points</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(ind<span class="sc">$</span>coord)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Dim 1       Dim 2       Dim 3       Dim 4       Dim 5
1 -0.4525811 -0.26415072  0.17151614  0.01369348 -0.11696806
2  0.8361700 -0.03193457 -0.07208249 -0.08550351  0.51978710
3 -0.4481892  0.13538726 -0.22484048 -0.14170168 -0.05004753
4  0.8803694 -0.08536230 -0.02052044 -0.07275873 -0.22935022
5 -0.4481892  0.13538726 -0.22484048 -0.14170168 -0.05004753
6 -0.3594324 -0.43604390 -1.20932223  1.72464616  0.04348157</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Quality of representation</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(ind<span class="sc">$</span>cos2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Dim 1        Dim 2        Dim 3        Dim 4        Dim 5
1 0.34652591 0.1180447167 0.0497683175 0.0003172275 0.0231460846
2 0.55589562 0.0008108236 0.0041310808 0.0058126211 0.2148103098
3 0.54813888 0.0500176790 0.1379484860 0.0547920948 0.0068349171
4 0.74773962 0.0070299584 0.0004062504 0.0051072923 0.0507479873
5 0.54813888 0.0500176790 0.1379484860 0.0547920948 0.0068349171
6 0.02485357 0.0365775483 0.2813443706 0.5722083217 0.0003637178</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Contributions</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(ind<span class="sc">$</span>contrib)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Dim 1      Dim 2        Dim 3        Dim 4      Dim 5
1 1.110927 0.98238297  0.498254685  0.003555817 0.31554778
2 3.792117 0.01435818  0.088003703  0.138637089 6.23134138
3 1.089470 0.25806722  0.856229950  0.380768961 0.05776914
4 4.203611 0.10259105  0.007132055  0.100387990 1.21319013
5 1.089470 0.25806722  0.856229950  0.380768961 0.05776914
6 0.700692 2.67693398 24.769968729 56.404214518 0.04360547</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># BIplot for individuals only (no vars)</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fviz_mca_ind</span>(res.mca, <span class="at">col.ind =</span> <span class="st">"cos2"</span>,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">gradient.cols =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span>),</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">repel =</span> <span class="cn">TRUE</span>, <span class="at">ggtheme =</span> <span class="fu">theme_minimal</span>())</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fviz_mca_ind</span>(res.mca, </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">label =</span> <span class="st">"none"</span>,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">habillage =</span> <span class="st">"Vomiting"</span>, <span class="co"># color by groups defined by variable</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>),</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">addEllipses =</span> <span class="cn">TRUE</span>, <span class="at">ellipse.type =</span> <span class="st">"confidence"</span>,</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">repel =</span> <span class="cn">TRUE</span>, <span class="at">ggtheme =</span> <span class="fu">theme_minimal</span>())</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># More than 1 grouping variable</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fviz_ellipses</span>(res.mca, <span class="fu">c</span>(<span class="st">"Vomiting"</span>, <span class="st">"Fever"</span>),</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">"point"</span>)</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Bar plot for Cos2 of individuals </span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fviz_cos2</span>(res.mca, <span class="at">choice =</span> <span class="st">"ind"</span>, <span class="at">axes =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">top =</span> <span class="dv">20</span>)</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Contribution of individuals to the dimensions </span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fviz_contrib</span>(res.mca, <span class="at">choice =</span> <span class="st">"ind"</span>, <span class="at">axes =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">top =</span> <span class="dv">20</span>)</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Supplementary elements --------------------------------------------------</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a><span class="co">#   res.mca &lt;- MCA(poison, </span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a><span class="co">#                  ind.sup = 53:55)</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a><span class="co">#   ind &lt;- get_mca_ind(res.mca)</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a><span class="co">#   ind$coord</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a><span class="co">#   res.mca$ind.sup # Supplementary individuals </span></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Doing it by hand --------------------------------------------------------</span></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Data</span></span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data</span>(wine)</span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>  MCA.dt <span class="ot">&lt;-</span> wine[, <span class="fu">sapply</span>(wine, is.factor)]</span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sapply</span>(MCA.dt, nlevels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Label  Soil 
    3     4 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Goal: Find the coordinates of </span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  npcs <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  res.mca <span class="ot">&lt;-</span> FactoMineR<span class="sc">::</span><span class="fu">MCA</span>(<span class="at">X =</span> MCA.dt, <span class="at">ncp =</span> npcs, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  res.mca<span class="sc">$</span>ind<span class="sc">$</span>coord <span class="co"># Coordinates of the individuals on the dimensions</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Dim 1       Dim 2         Dim 3       Dim 4
2EL  -0.08524441 -0.36629820  8.660254e-01 -0.42338794
1CHA -0.08524441 -0.36629820  8.660254e-01 -0.42338794
1FON -1.13625682  0.13134188  8.660254e-01  0.07425214
1VAU  1.19013068  1.42046767  2.646476e-16  0.44277818
1DAM -0.08524441 -0.36629820 -8.660254e-01 -0.42338794
2BOU -1.13625682  0.13134188 -8.660254e-01  0.07425214
1BOI -1.13625682  0.13134188 -8.660254e-01  0.07425214
3EL  -0.08524441 -0.36629820  8.660254e-01 -0.42338794
DOM1  0.08871159  0.96016779  8.660254e-01  0.90307806
1TUR  1.01617468  0.09400168  1.274326e-15 -0.88368782
4EL   1.01617468  0.09400168  1.274326e-15 -0.88368782
PER1  1.01617468  0.09400168  1.274326e-15 -0.88368782
2DAM -0.08524441 -0.36629820 -8.660254e-01 -0.42338794
1POY -0.08524441 -0.36629820 -8.660254e-01 -0.42338794
1ING -1.13625682  0.13134188  8.660254e-01  0.07425214
1BEN -1.13625682  0.13134188 -8.660254e-01  0.07425214
2BEA  0.08871159  0.96016779 -8.660254e-01  0.90307806
1ROC  1.19013068  1.42046767  3.995551e-16  0.44277818
2ING -1.13625682  0.13134188  8.660254e-01  0.07425214
T1    0.86139937 -1.81676901 -3.719373e-16  1.02708287
T2    0.86139937 -1.81676901 -3.719373e-16  1.02708287</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>  res.mca<span class="sc">$</span>svd<span class="sc">$</span>V</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]        [,2]          [,3]        [,4]
[1,]  0.5343096 -0.78968614 -4.844048e-15 -0.78968614
[2,] -1.5677152  0.20559402 -3.260525e-15  0.20559402
[3,]  0.8822216  1.86324585 -6.725946e-15  1.86324585
[4,] -0.7047984  0.05708973 -1.732051e+00 -0.05708973
[5,] -0.7047984  0.05708973  1.732051e+00 -0.05708973
[6,]  1.4980398  0.97768949  6.898331e-15 -0.97768949
[7,]  1.1884892 -2.84385187  3.204282e-15  2.84385187</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Following AudigierEtAl2016_MICAT ----------------------------------------</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  I <span class="ot">&lt;-</span> <span class="fu">nrow</span>(MCA.dt)     <span class="co"># numebr of individuals</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">ncol</span>(MCA.dt)     <span class="co"># number of categorical predictors</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  qk <span class="ot">&lt;-</span> <span class="fu">sapply</span>(MCA.dt,  <span class="co"># number of levels per categorical variable </span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>               nlevels) </span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  J <span class="ot">&lt;-</span> <span class="fu">sum</span>(qk)          <span class="co"># total number of categories</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Disjunctive table</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  Z <span class="ot">&lt;-</span> <span class="fu">tab.disjonctif</span>(MCA.dt)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Notice the relationship between the disjunctive table and a </span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&nbsp;contingency table </span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="fu">t</span>(Z[, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]) <span class="sc">%*%</span> Z[, <span class="dv">4</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  N <span class="sc">-</span> <span class="fu">table</span>(MCA.dt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Reference Env1 Env2 Env4
Saumur             0    0    0    0
Bourgueuil         0    0    0    0
Chinon             0    0    0    0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Distance Metric Matrix</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  pxkqk <span class="ot">&lt;-</span> <span class="fu">colSums</span>(Z)<span class="sc">/</span>I <span class="co"># props ids taking category value on variable</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  D_Sigma <span class="ot">&lt;-</span> <span class="fu">diag</span>(pxkqk)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Weight Matrix</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  W_mat <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="fu">rep</span>(<span class="dv">1</span>, I))<span class="sc">/</span>I</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># M matrix (center matrix)</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  M <span class="ot">&lt;-</span> <span class="fu">matrix</span>((<span class="fu">rep</span>(<span class="fu">colMeans</span>(Z), <span class="fu">nrow</span>(Z))), </span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">nrow =</span> <span class="fu">nrow</span>(Z), </span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># SVD of triplet (Z-M, D_Sigma, W_mat)</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  SVD.trip <span class="ot">&lt;-</span> <span class="fu">svd.triplet</span>(<span class="at">X =</span> Z <span class="sc">-</span> M,</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>                          <span class="at">row.w =</span> <span class="fu">diag</span>(W_mat),</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>                          <span class="at">col.w =</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span>K<span class="sc">*</span><span class="fu">solve</span>(D_Sigma)),</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ncp =</span> npcs)</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Manual SVD triplet</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>  SVD.man <span class="ot">&lt;-</span> <span class="fu">svd</span>(<span class="fu">sqrt</span>(W_mat) <span class="sc">%*%</span> (Z <span class="sc">-</span> M) <span class="sc">%*%</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span>K<span class="sc">*</span><span class="fu">solve</span>(D_Sigma)))</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert back to correct scales (according to Chaven 2017 p. 3)</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>  V.man <span class="ot">&lt;-</span> (<span class="fu">solve</span>(<span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span>K<span class="sc">*</span><span class="fu">solve</span>(D_Sigma))) <span class="sc">%*%</span> SVD.man<span class="sc">$</span>v)[, <span class="dv">1</span><span class="sc">:</span>npcs]</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>  U.man <span class="ot">&lt;-</span> (<span class="fu">solve</span>(<span class="fu">sqrt</span>(W_mat)) <span class="sc">%*%</span> SVD.man<span class="sc">$</span>u)[, <span class="dv">1</span><span class="sc">:</span>npcs]</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>  L.man <span class="ot">&lt;-</span> SVD.man<span class="sc">$</span>d[<span class="dv">1</span><span class="sc">:</span>npcs]</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compare SVD triplet and manual SVD of weighted matrix</span></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="fu">abs</span>(SVD.trip<span class="sc">$</span>V) <span class="sc">-</span> <span class="fu">abs</span>(V.man), <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4]
[1,]    0    0    0    0
[2,]    0    0    0    0
[3,]    0    0    0    0
[4,]    0    0    0    0
[5,]    0    0    0    0
[6,]    0    0    0    0
[7,]    0    0    0    0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="fu">abs</span>(SVD.trip<span class="sc">$</span>U) <span class="sc">-</span> <span class="fu">abs</span>(U.man), <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1] [,2] [,3] [,4]
 [1,]    0    0    0    0
 [2,]    0    0    0    0
 [3,]    0    0    0    0
 [4,]    0    0    0    0
 [5,]    0    0    0    0
 [6,]    0    0    0    0
 [7,]    0    0    0    0
 [8,]    0    0    0    0
 [9,]    0    0    0    0
[10,]    0    0    0    0
[11,]    0    0    0    0
[12,]    0    0    0    0
[13,]    0    0    0    0
[14,]    0    0    0    0
[15,]    0    0    0    0
[16,]    0    0    0    0
[17,]    0    0    0    0
[18,]    0    0    0    0
[19,]    0    0    0    0
[20,]    0    0    0    0
[21,]    0    0    0    0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="fu">abs</span>(SVD.trip<span class="sc">$</span>vs[<span class="dv">1</span><span class="sc">:</span>npcs]) <span class="sc">-</span> <span class="fu">abs</span>(L.man), <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0 0 0 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Reconstruction Formula</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  d_hat <span class="ot">&lt;-</span> SVD.trip<span class="sc">$</span>vs[<span class="dv">1</span><span class="sc">:</span>npcs] <span class="co"># matrix of the singular values </span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>                            <span class="co"># (Squared would be eigenvalues of Z)</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  u_hat <span class="ot">&lt;-</span> SVD.trip<span class="sc">$</span>U <span class="co"># Left singular vectors matrix</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  v_hat <span class="ot">&lt;-</span> SVD.trip<span class="sc">$</span>V <span class="co"># Right singular vectors matrix</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  z_hat <span class="ot">&lt;-</span> u_hat <span class="sc">%*%</span> <span class="fu">diag</span>(d_hat) <span class="sc">%*%</span> <span class="fu">t</span>(v_hat) <span class="sc">+</span> M</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colSums</span>(z_hat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11  6  4  7  7  5  2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colSums</span>(Z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Saumur Bourgueuil     Chinon  Reference       Env1       Env2       Env4 
        11          6          4          7          7          5          2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compare SVD matrices</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Matrix of singular values</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  res.mca<span class="sc">$</span>svd<span class="sc">$</span>vs[<span class="dv">1</span><span class="sc">:</span>npcs] <span class="sc">-</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    d_hat[<span class="dv">1</span><span class="sc">:</span>npcs]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.000000e+00 0.000000e+00 1.110223e-16 2.220446e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>  res.mca<span class="sc">$</span>svd<span class="sc">$</span>vs[<span class="dv">1</span><span class="sc">:</span>npcs] <span class="sc">-</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>    L.man</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.000000e+00 0.000000e+00 2.220446e-16 6.661338e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Left Singular Vectors Matrix</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    res.mca<span class="sc">$</span>svd<span class="sc">$</span>U <span class="sc">-</span> u_hat,</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1] [,2]   [,3] [,4]
 [1,]    0    0  2.449    0
 [2,]    0    0  2.449    0
 [3,]    0    0  2.449    0
 [4,]    0    0  0.000    0
 [5,]    0    0 -2.449    0
 [6,]    0    0 -2.449    0
 [7,]    0    0 -2.449    0
 [8,]    0    0  2.449    0
 [9,]    0    0  2.449    0
[10,]    0    0  0.000    0
[11,]    0    0  0.000    0
[12,]    0    0  0.000    0
[13,]    0    0 -2.449    0
[14,]    0    0 -2.449    0
[15,]    0    0  2.449    0
[16,]    0    0 -2.449    0
[17,]    0    0 -2.449    0
[18,]    0    0  0.000    0
[19,]    0    0  2.449    0
[20,]    0    0  0.000    0
[21,]    0    0  0.000    0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>    res.mca<span class="sc">$</span>svd<span class="sc">$</span>U <span class="sc">-</span> U.man,</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        [,1]   [,2]   [,3] [,4]
 [1,] -0.200 -0.917  2.449    0
 [2,] -0.200 -0.917  2.449    0
 [3,] -2.669  0.329  2.449    0
 [4,]  2.796  3.554  0.000    0
 [5,] -0.200 -0.917 -2.449    0
 [6,] -2.669  0.329 -2.449    0
 [7,] -2.669  0.329 -2.449    0
 [8,] -0.200 -0.917  2.449    0
 [9,]  0.208  2.403  2.449    0
[10,]  2.387  0.235  0.000    0
[11,]  2.387  0.235  0.000    0
[12,]  2.387  0.235  0.000    0
[13,] -0.200 -0.917 -2.449    0
[14,] -0.200 -0.917 -2.449    0
[15,] -2.669  0.329  2.449    0
[16,] -2.669  0.329 -2.449    0
[17,]  0.208  2.403 -2.449    0
[18,]  2.796  3.554  0.000    0
[19,] -2.669  0.329  2.449    0
[20,]  2.024 -4.546  0.000    0
[21,]  2.024 -4.546  0.000    0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Right Singular Vectors Matrix</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>    res.mca<span class="sc">$</span>svd<span class="sc">$</span>V <span class="sc">-</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>      v_hat, </span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       [,1]   [,2]   [,3]   [,4]
[1,]  0.254 -0.376  0.000 -0.376
[2,] -1.120  0.147  0.000  0.147
[3,]  0.714  1.508  0.000  1.508
[4,] -0.470  0.038 -2.309 -0.038
[5,] -0.470  0.038  2.309 -0.038
[6,]  1.141  0.745  0.000 -0.745
[7,]  1.075 -2.573  0.000  2.573</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Correlation between columns</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># And look into the PCAmixdata package</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="fu">cor</span>(v_hat, res.mca<span class="sc">$</span>svd<span class="sc">$</span>V), <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4]
[1,]  0.9  0.0    0  0.0
[2,]  0.0  0.8    0  0.0
[3,]  0.0  0.0   -1  0.0
[4,]  0.0  0.0    0  0.9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Coordinates on Dimensions are recovered</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>    res.mca<span class="sc">$</span>ind<span class="sc">$</span>coord <span class="sc">-</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>      u_hat <span class="sc">%*%</span> <span class="fu">diag</span>(d_hat),</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Dim 1 Dim 2  Dim 3 Dim 4
2EL      0     0  1.732     0
1CHA     0     0  1.732     0
1FON     0     0  1.732     0
1VAU     0     0  0.000     0
1DAM     0     0 -1.732     0
2BOU     0     0 -1.732     0
1BOI     0     0 -1.732     0
3EL      0     0  1.732     0
DOM1     0     0  1.732     0
1TUR     0     0  0.000     0
4EL      0     0  0.000     0
PER1     0     0  0.000     0
2DAM     0     0 -1.732     0
1POY     0     0 -1.732     0
1ING     0     0  1.732     0
1BEN     0     0 -1.732     0
2BEA     0     0 -1.732     0
1ROC     0     0  0.000     0
2ING     0     0  1.732     0
T1       0     0  0.000     0
T2       0     0  0.000     0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Following JosseHusson2016 -----------------------------------------------</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  I <span class="ot">&lt;-</span> <span class="fu">nrow</span>(MCA.dt)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  J <span class="ot">&lt;-</span> <span class="fu">ncol</span>(MCA.dt)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">tab.disjonctif</span>(MCA.dt)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  rowMarg <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(X) <span class="co"># = J</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  colMarg <span class="ot">&lt;-</span> <span class="fu">colSums</span>(X) <span class="co"># = number of ids in a category</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  D_Sigma <span class="ot">&lt;-</span> <span class="fu">diag</span>(colMarg)</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>  D <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>I <span class="sc">*</span> <span class="fu">diag</span>(<span class="fu">rep</span>(<span class="dv">1</span>, I)) <span class="co"># rowMasses</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>  SVD.trip <span class="ot">&lt;-</span> <span class="fu">svd.triplet</span>(<span class="at">X =</span> <span class="fu">diag</span>(<span class="fu">rep</span>(<span class="dv">1</span>, I)) <span class="sc">%*%</span> X <span class="sc">%*%</span> <span class="fu">solve</span>(D_Sigma),</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">row.w =</span> <span class="fu">diag</span>( D ),</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">col.w =</span> <span class="fu">diag</span>( <span class="dv">1</span><span class="sc">/</span>(I<span class="sc">*</span>J)<span class="sc">*</span>D_Sigma ),</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ncp=</span><span class="dv">2</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>                          )</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">svd</span>(I <span class="sc">*</span> X <span class="sc">%*%</span> <span class="fu">solve</span>(D_Sigma))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$d
[1] 1.514660e+01 1.236990e+01 1.054821e+01 7.978230e+00 7.937254e+00
[6] 6.179826e+00 9.636589e-16

$u
             [,1]        [,2]        [,3]        [,4]          [,5]        [,6]
 [1,] 0.032591337 -0.07625736  0.13536164  0.10431026 -2.672612e-01 -0.33476464
 [2,] 0.032591337 -0.07625736  0.13536164  0.10431026 -2.672612e-01 -0.33476464
 [3,] 0.007760225 -0.10152263  0.35440169  0.02151024 -2.672612e-01  0.17388603
 [4,] 0.020375871 -0.49923872 -0.22465765 -0.05818667  8.885241e-17  0.17269077
 [5,] 0.032591337 -0.07625736  0.13536164  0.10431026  2.672612e-01 -0.33476464
 [6,] 0.007760225 -0.10152263  0.35440169  0.02151024  2.672612e-01  0.17388603
 [7,] 0.007760225 -0.10152263  0.35440169  0.02151024  2.672612e-01  0.17388603
 [8,] 0.032591337 -0.07625736  0.13536164  0.10431026 -2.672612e-01 -0.33476464
 [9,] 0.013386482 -0.36360489  0.01780574 -0.40099813 -2.672612e-01 -0.19957224
[10,] 0.039580726 -0.21189120 -0.10710176  0.44712172 -1.379817e-16  0.03749837
[11,] 0.039580726 -0.21189120 -0.10710176  0.44712172 -1.379817e-16  0.03749837
[12,] 0.039580726 -0.21189120 -0.10710176  0.44712172 -1.379817e-16  0.03749837
[13,] 0.032591337 -0.07625736  0.13536164  0.10431026  2.672612e-01 -0.33476464
[14,] 0.032591337 -0.07625736  0.13536164  0.10431026  2.672612e-01 -0.33476464
[15,] 0.007760225 -0.10152263  0.35440169  0.02151024 -2.672612e-01  0.17388603
[16,] 0.007760225 -0.10152263  0.35440169  0.02151024  2.672612e-01  0.17388603
[17,] 0.013386482 -0.36360489  0.01780574 -0.40099813  2.672612e-01 -0.19957224
[18,] 0.020375871 -0.49923872 -0.22465765 -0.05818667  1.352292e-16  0.17269077
[19,] 0.007760225 -0.10152263  0.35440169  0.02151024 -2.672612e-01  0.17388603
[20,] 0.702629651  0.05328487 -0.01535314 -0.04368183  3.942058e-17  0.03644825
[21,] 0.702629651  0.05328487 -0.01535314 -0.04368183  3.942058e-17  0.03644825
               [,7]
 [1,]  4.208432e-01
 [2,]  4.991001e-01
 [3,] -3.618114e-02
 [4,] -1.518978e-01
 [5,] -2.291723e-01
 [6,]  4.197641e-01
 [7,]  4.193287e-03
 [8,] -3.900336e-01
 [9,] -1.017590e-01
[10,] -2.744259e-02
[11,] -2.744259e-02
[12,] -2.744259e-02
[13,] -1.092048e-01
[14,] -1.092048e-01
[15,] -1.959848e-01
[16,]  4.193287e-03
[17,]  1.943126e-02
[18,]  2.342255e-01
[19,] -1.959848e-01
[20,] -2.270596e-17
[21,] -2.270596e-17

$v
           [,1]        [,2]        [,3]         [,4]          [,5]        [,6]
[1,] 0.21673353 -0.15227297  0.08328278  0.449827802  0.000000e+00 -0.56322741
[2,] 0.01075916 -0.17235191  0.70556405  0.056618453 -5.143453e-16  0.59089151
[3,] 0.02340490 -0.73241180 -0.20590657 -0.604324602  7.308978e-16 -0.04567368
[4,] 0.02662799 -0.21753089  0.42294271 -0.008850321  7.071068e-01 -0.33117829
[5,] 0.02662799 -0.21753089  0.42294271 -0.008850321 -7.071068e-01 -0.33117829
[6,] 0.04422606 -0.55484980 -0.30683950  0.644875605  2.730638e-17  0.31118708
[7,] 0.97416066  0.09046012 -0.03056595 -0.114977701 -1.236662e-16  0.12385678
           [,7]
[1,] -0.6350853
[2,] -0.3464102
[3,] -0.2309401
[4,]  0.4041452
[5,]  0.4041452
[6,]  0.2886751
[7,]  0.1154701</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>  SVD.trip<span class="sc">$</span>vs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.761905e-02 4.054015e-02 3.806073e-02 3.367175e-02 2.861739e-02
[6] 2.498139e-02 6.677878e-18</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(SVD.trip<span class="sc">$</span>vs[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>] <span class="sc">-</span> res.mca<span class="sc">$</span>svd<span class="sc">$</span>vs[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.811 -0.761</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>  SVD.trip<span class="sc">$</span>U</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1]       [,2]
 [1,]    1 -0.1001293
 [2,]    1 -0.1001293
 [3,]    1 -1.3346637
 [4,]    1  1.3979447
 [5,]    1 -0.1001293
 [6,]    1 -1.3346637
 [7,]    1 -1.3346637
 [8,]    1 -0.1001293
 [9,]    1  0.1042019
[10,]    1  1.1936135
[11,]    1  1.1936135
[12,]    1  1.1936135
[13,]    1 -0.1001293
[14,]    1 -0.1001293
[15,]    1 -1.3346637
[16,]    1 -1.3346637
[17,]    1  0.1042019
[18,]    1  1.3979447
[19,]    1 -1.3346637
[20,]    1  1.0118122
[21,]    1  1.0118122</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>  res.mca<span class="sc">$</span>svd<span class="sc">$</span>U</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            [,1]       [,2]          [,3]       [,4]
 [1,] -0.1001293 -0.4582879  1.224745e+00 -0.7045133
 [2,] -0.1001293 -0.4582879  1.224745e+00 -0.7045133
 [3,] -1.3346637  0.1643262  1.224745e+00  0.1235548
 [4,]  1.3979447  1.7771946  3.742682e-16  0.7367785
 [5,] -0.1001293 -0.4582879 -1.224745e+00 -0.7045133
 [6,] -1.3346637  0.1643262 -1.224745e+00  0.1235548
 [7,] -1.3346637  0.1643262 -1.224745e+00  0.1235548
 [8,] -0.1001293 -0.4582879  1.224745e+00 -0.7045133
 [9,]  0.1042019  1.2012980  1.224745e+00  1.5027130
[10,]  1.1936135  0.1176086  1.802169e-15 -1.4704478
[11,]  1.1936135  0.1176086  1.802169e-15 -1.4704478
[12,]  1.1936135  0.1176086  1.802169e-15 -1.4704478
[13,] -0.1001293 -0.4582879 -1.224745e+00 -0.7045133
[14,] -0.1001293 -0.4582879 -1.224745e+00 -0.7045133
[15,] -1.3346637  0.1643262  1.224745e+00  0.1235548
[16,] -1.3346637  0.1643262 -1.224745e+00  0.1235548
[17,]  0.1042019  1.2012980 -1.224745e+00  1.5027130
[18,]  1.3979447  1.7771946  5.650563e-16  0.7367785
[19,] -1.3346637  0.1643262  1.224745e+00  0.1235548
[20,]  1.0118122 -2.2730204 -5.259988e-16  1.7090557
[21,]  1.0118122 -2.2730204 -5.259988e-16  1.7090557</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co">#   round(SVD.trip$U[, 2:3] - res.mca$svd$U, 3)</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  res.mca<span class="sc">$</span>svd<span class="sc">$</span>U</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            [,1]       [,2]          [,3]       [,4]
 [1,] -0.1001293 -0.4582879  1.224745e+00 -0.7045133
 [2,] -0.1001293 -0.4582879  1.224745e+00 -0.7045133
 [3,] -1.3346637  0.1643262  1.224745e+00  0.1235548
 [4,]  1.3979447  1.7771946  3.742682e-16  0.7367785
 [5,] -0.1001293 -0.4582879 -1.224745e+00 -0.7045133
 [6,] -1.3346637  0.1643262 -1.224745e+00  0.1235548
 [7,] -1.3346637  0.1643262 -1.224745e+00  0.1235548
 [8,] -0.1001293 -0.4582879  1.224745e+00 -0.7045133
 [9,]  0.1042019  1.2012980  1.224745e+00  1.5027130
[10,]  1.1936135  0.1176086  1.802169e-15 -1.4704478
[11,]  1.1936135  0.1176086  1.802169e-15 -1.4704478
[12,]  1.1936135  0.1176086  1.802169e-15 -1.4704478
[13,] -0.1001293 -0.4582879 -1.224745e+00 -0.7045133
[14,] -0.1001293 -0.4582879 -1.224745e+00 -0.7045133
[15,] -1.3346637  0.1643262  1.224745e+00  0.1235548
[16,] -1.3346637  0.1643262 -1.224745e+00  0.1235548
[17,]  0.1042019  1.2012980 -1.224745e+00  1.5027130
[18,]  1.3979447  1.7771946  5.650563e-16  0.7367785
[19,] -1.3346637  0.1643262  1.224745e+00  0.1235548
[20,]  1.0118122 -2.2730204 -5.259988e-16  1.7090557
[21,]  1.0118122 -2.2730204 -5.259988e-16  1.7090557</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co">#   SVD.trip$V</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   round(SVD.trip$V[, 2:3] - res.mca$svd$V, 3)</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   res.mca$svd$V</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare environment ----------------------------------------------------------</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'psych'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:ggplot2':

    %+%, alpha</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PCAmixdata)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"FactoMineR"</span>)</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"factoextra"</span>)</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(tea)</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tea)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      breakfast     tea.time     evening     lunch     dinner     always home
1     breakfast Not.tea time Not.evening Not.lunch Not.dinner Not.always home
2     breakfast Not.tea time Not.evening Not.lunch Not.dinner Not.always home
3 Not.breakfast     tea time     evening Not.lunch     dinner Not.always home
4 Not.breakfast Not.tea time Not.evening Not.lunch     dinner Not.always home
5     breakfast Not.tea time     evening Not.lunch Not.dinner     always home
6 Not.breakfast Not.tea time Not.evening Not.lunch     dinner Not.always home
      work     tearoom     friends     resto     pub       Tea   How    sugar
1 Not.work Not.tearoom Not.friends Not.resto Not.pub     black alone    sugar
2 Not.work Not.tearoom Not.friends Not.resto Not.pub     black  milk No.sugar
3     work Not.tearoom     friends     resto Not.pub Earl Grey alone No.sugar
4 Not.work Not.tearoom Not.friends Not.resto Not.pub Earl Grey alone    sugar
5 Not.work Not.tearoom Not.friends Not.resto Not.pub Earl Grey alone No.sugar
6 Not.work Not.tearoom Not.friends Not.resto Not.pub Earl Grey alone No.sugar
      how       where           price age sex          SPC         Sport age_Q
1 tea bag chain store       p_unknown  39   M       middle     sportsman 35-44
2 tea bag chain store      p_variable  45   F       middle     sportsman 45-59
3 tea bag chain store      p_variable  47   F other worker     sportsman 45-59
4 tea bag chain store      p_variable  23   M      student Not.sportsman 15-24
5 tea bag chain store      p_variable  48   M     employee     sportsman 45-59
6 tea bag chain store p_private label  21   M      student     sportsman 15-24
  frequency     escape.exoticism     spirituality     healthy     diuretic
1     1/day Not.escape-exoticism Not.spirituality     healthy Not.diuretic
2     1/day     escape-exoticism Not.spirituality     healthy     diuretic
3    +2/day Not.escape-exoticism Not.spirituality     healthy     diuretic
4     1/day     escape-exoticism     spirituality     healthy Not.diuretic
5    +2/day     escape-exoticism     spirituality Not.healthy     diuretic
6     1/day Not.escape-exoticism Not.spirituality     healthy Not.diuretic
      friendliness     iron.absorption     feminine     sophisticated
1 Not.friendliness Not.iron absorption Not.feminine Not.sophisticated
2 Not.friendliness Not.iron absorption Not.feminine Not.sophisticated
3     friendliness Not.iron absorption Not.feminine Not.sophisticated
4 Not.friendliness Not.iron absorption Not.feminine     sophisticated
5     friendliness Not.iron absorption Not.feminine Not.sophisticated
6 Not.friendliness Not.iron absorption Not.feminine Not.sophisticated
     slimming    exciting    relaxing    effect.on.health
1 No.slimming No.exciting No.relaxing No.effect on health
2 No.slimming    exciting No.relaxing No.effect on health
3 No.slimming No.exciting    relaxing No.effect on health
4 No.slimming No.exciting    relaxing No.effect on health
5 No.slimming No.exciting    relaxing No.effect on health
6 No.slimming No.exciting    relaxing No.effect on health</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(tea[, <span class="fu">c</span>(<span class="st">"where"</span>, <span class="st">"how"</span>, <span class="st">"SPC"</span>)], nlevels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$where
[1] 3

$how
[1] 3

$SPC
[1] 7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(tea, nlevels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       breakfast         tea.time          evening            lunch 
               2                2                2                2 
          dinner           always             home             work 
               2                2                2                2 
         tearoom          friends            resto              pub 
               2                2                2                2 
             Tea              How            sugar              how 
               3                4                2                3 
           where            price              age              sex 
               3                6                0                2 
             SPC            Sport            age_Q        frequency 
               7                2                5                4 
escape.exoticism     spirituality          healthy         diuretic 
               2                2                2                2 
    friendliness  iron.absorption         feminine    sophisticated 
               2                2                2                2 
        slimming         exciting         relaxing effect.on.health 
               2                2                2                2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> tea[, <span class="fu">c</span>(<span class="st">"where"</span>, <span class="st">"how"</span>, <span class="st">"Tea"</span>)]</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>CTD <span class="ot">&lt;-</span> <span class="fu">tab.disjonctif</span>(x)</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>pk <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(CTD)</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>CTD[<span class="dv">1</span>, ] <span class="sc">/</span> pk</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         chain store chain store+tea shop             tea shop 
            1.562500             0.000000             0.000000 
             tea bag   tea bag+unpackaged           unpackaged 
            1.764706             0.000000             0.000000 
               black            Earl Grey                green 
            4.054054             0.000000             0.000000 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>CTD[<span class="dv">4</span>, ] <span class="sc">/</span> pk</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         chain store chain store+tea shop             tea shop 
            1.562500             0.000000             0.000000 
             tea bag   tea bag+unpackaged           unpackaged 
            1.764706             0.000000             0.000000 
               black            Earl Grey                green 
            0.000000             1.554404             0.000000 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">/</span>.<span class="dv">64</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.5625</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">/</span>.<span class="dv">56666667</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.764706</code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>CTD_t <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(CTD, <span class="dv">1</span>, <span class="cf">function</span>(r) {<span class="fu">t</span>(r)<span class="sc">/</span>pk} ))</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colMeans</span>(CTD_t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 1 1 1 1 1 1 1 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">tab.disjonctif</span>(x)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">/</span><span class="fu">nrow</span>(tea)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.003333333</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correspondance analysis based on contingency table ---------------------------</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> tea[, <span class="fu">c</span>(<span class="st">"SPC"</span>, <span class="st">"where"</span>)]</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">nlevels</span>(x[, <span class="dv">1</span>]) </span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">nlevels</span>(x[, <span class="dv">2</span>]) </span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">table</span>(x)</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Contingency table</span></span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>N</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              where
SPC            chain store chain store+tea shop tea shop
  employee              46                   11        2
  middle                21                   12        7
  non-worker            35                   22        7
  other worker          14                    4        2
  senior                16                   14        5
  student               55                   12        3
  workman                5                    3        4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Indicator matrix</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">tab.disjonctif</span>(x)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>Z1 <span class="ot">&lt;-</span> Z[, <span class="dv">1</span><span class="sc">:</span>r]</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>Z2 <span class="ot">&lt;-</span> Z[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>r)]</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>N <span class="sc">-</span> <span class="fu">t</span>(Z1) <span class="sc">%*%</span> Z2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              where
SPC            chain store chain store+tea shop tea shop
  employee               0                    0        0
  middle                 0                    0        0
  non-worker             0                    0        0
  other worker           0                    0        0
  senior                 0                    0        0
  student                0                    0        0
  workman                0                    0        0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correspondance matrix</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n <span class="sc">*</span> N</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="co"># From Greenacre1984</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>N</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              where
SPC            chain store chain store+tea shop tea shop
  employee              46                   11        2
  middle                21                   12        7
  non-worker            35                   22        7
  other worker          14                    4        2
  senior                16                   14        5
  student               55                   12        3
  workman                5                    3        4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Column and row sums</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>r_bold <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(N)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>c_bold <span class="ot">&lt;-</span> <span class="fu">colSums</span>(N)</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="fu">drop</span>(N <span class="sc">%*%</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">ncol</span>(N))) <span class="sc">-</span> r_bold</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    employee       middle   non-worker other worker       senior      student 
           0            0            0            0            0            0 
     workman 
           0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">drop</span>(<span class="fu">t</span>(N) <span class="sc">%*%</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(N))) <span class="sc">-</span> c_bold</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         chain store chain store+tea shop             tea shop 
                   0                    0                    0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>D_r <span class="ot">&lt;-</span> <span class="fu">diag</span>(r_bold)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>D_c <span class="ot">&lt;-</span> <span class="fu">diag</span>(c_bold)</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrices of profiles</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fu">solve</span>(D_r) <span class="sc">%*%</span> P</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">solve</span>(D_c) <span class="sc">%*%</span> <span class="fu">t</span>(P)</span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Centroids</span></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">t</span>(C) <span class="sc">%*%</span> c_bold</span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">t</span>(R) <span class="sc">%*%</span> r_bold</span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Generalized SVD of P - r_bold t(c_bold)</span></span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a>P <span class="sc">-</span> r_bold <span class="sc">%*%</span> <span class="fu">t</span>(c_bold)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              where
SPC            chain store chain store+tea shop    tea shop
  employee     -11327.8467           -4601.9633  -1769.9933
  middle        -7679.9300           -3119.9600  -1199.9767
  non-worker   -12287.8833           -4991.9267  -1919.9767
  other worker  -3839.9533           -1559.9867   -599.9933
  senior        -6719.9467           -2729.9533  -1049.9833
  student      -13439.8167           -5459.9600  -2099.9900
  workman       -2303.9833            -935.9900   -359.9867</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">svd</span>(P <span class="sc">-</span> r <span class="sc">%*%</span> <span class="fu">t</span>(c))<span class="sc">$</span>u</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">svd</span>(P <span class="sc">-</span> r <span class="sc">%*%</span> <span class="fu">t</span>(c))<span class="sc">$</span>v</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(A) <span class="sc">%*%</span> <span class="fu">solve</span>(D_r) <span class="sc">%*%</span> A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             [,1]         [,2]         [,3]
[1,]  0.019696233  0.004907973 -0.002761302
[2,]  0.004907973  0.042624633 -0.004062585
[3,] -0.002761302 -0.004062585  0.017670747</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(B) <span class="sc">%*%</span> <span class="fu">solve</span>(D_c) <span class="sc">%*%</span> B</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            [,1]        [,2]        [,3]
[1,] 0.009787727 0.004094881 0.007204504
[2,] 0.004094881 0.024453726 0.009443356
[3,] 0.007204504 0.009443356 0.017120726</code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># From Jolliffe p. 37</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="co"># r_bold &lt;- rep(1, r)</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="co"># c_bold &lt;- rep(1, C)</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="co"># D_r &lt;- diag(r_bold)</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a><span class="co"># D_c &lt;- diag(c_bold)</span></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Omega &lt;- solve(D_r)</span></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Psi &lt;- solve(D_c)</span></span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a><span class="co"># X &lt;- P - r_bold %*% t(c_bold)</span></span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a><span class="co"># V &lt;- svd(X)$u</span></span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a><span class="co"># M &lt;- diag(svd(X)$d)</span></span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a><span class="co"># B &lt;- svd(X)$v</span></span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a><span class="co"># round(t(V) %*% Omega %*% V, 3)</span></span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a><span class="co"># round(t(B) %*% Psi %*% B, 3)</span></span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a><span class="co"># X_til &lt;- sqrt(Omega) %*% X %*% sqrt(Psi)</span></span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a><span class="co"># W &lt;- svd(X_til)$u</span></span>
<span id="cb108-20"><a href="#cb108-20" aria-hidden="true" tabindex="-1"></a><span class="co"># K &lt;- diag(svd(X_til)$d)</span></span>
<span id="cb108-21"><a href="#cb108-21" aria-hidden="true" tabindex="-1"></a><span class="co"># C &lt;- svd(X_til)$v</span></span>
<span id="cb108-22"><a href="#cb108-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-23"><a href="#cb108-23" aria-hidden="true" tabindex="-1"></a><span class="co"># solve(sqrt(Omega)) %*% W - V</span></span>
<span id="cb108-24"><a href="#cb108-24" aria-hidden="true" tabindex="-1"></a><span class="co"># solve(sqrt(Omega)) %*% C - B</span></span>
<span id="cb108-25"><a href="#cb108-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-26"><a href="#cb108-26" aria-hidden="true" tabindex="-1"></a><span class="co"># W %*% K</span></span>
<span id="cb108-27"><a href="#cb108-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-28"><a href="#cb108-28" aria-hidden="true" tabindex="-1"></a><span class="co"># # Row profiles</span></span>
<span id="cb108-29"><a href="#cb108-29" aria-hidden="true" tabindex="-1"></a><span class="co"># D_r</span></span>
<span id="cb108-30"><a href="#cb108-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-31"><a href="#cb108-31" aria-hidden="true" tabindex="-1"></a><span class="co"># MCA based on Audigier et al 2017 p. 505 (p. 5 of pdf) ------------------------</span></span>
<span id="cb108-32"><a href="#cb108-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-33"><a href="#cb108-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Work with categorical predictors from the tea dataset</span></span>
<span id="cb108-34"><a href="#cb108-34" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> tea[, <span class="fu">c</span>(<span class="st">"where"</span>, <span class="st">"how"</span>, <span class="st">"Tea"</span>)]</span>
<span id="cb108-35"><a href="#cb108-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-36"><a href="#cb108-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define row weights</span></span>
<span id="cb108-37"><a href="#cb108-37" aria-hidden="true" tabindex="-1"></a>    I <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb108-38"><a href="#cb108-38" aria-hidden="true" tabindex="-1"></a>    R <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">1</span> <span class="sc">/</span> I, I)</span>
<span id="cb108-39"><a href="#cb108-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-40"><a href="#cb108-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define Z (the disjunctive table)</span></span>
<span id="cb108-41"><a href="#cb108-41" aria-hidden="true" tabindex="-1"></a>    Z <span class="ot">&lt;-</span> <span class="fu">tab.disjonctif</span>(x)</span>
<span id="cb108-42"><a href="#cb108-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-43"><a href="#cb108-43" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define column weights</span></span>
<span id="cb108-44"><a href="#cb108-44" aria-hidden="true" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">ncol</span>(x)</span>
<span id="cb108-45"><a href="#cb108-45" aria-hidden="true" tabindex="-1"></a>    plxk <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(Z)</span>
<span id="cb108-46"><a href="#cb108-46" aria-hidden="true" tabindex="-1"></a>    D_sigma <span class="ot">&lt;-</span> <span class="fu">diag</span>(plxk)</span>
<span id="cb108-47"><a href="#cb108-47" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span> <span class="sc">/</span> K <span class="sc">*</span> <span class="fu">solve</span>(D_sigma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]     [,2]     [,3]      [,4]    [,5]     [,6]     [,7]      [,8]
 [1,] 0.5208333 0.000000 0.000000 0.0000000 0.00000 0.000000 0.000000 0.0000000
 [2,] 0.0000000 1.282051 0.000000 0.0000000 0.00000 0.000000 0.000000 0.0000000
 [3,] 0.0000000 0.000000 3.333333 0.0000000 0.00000 0.000000 0.000000 0.0000000
 [4,] 0.0000000 0.000000 0.000000 0.5882353 0.00000 0.000000 0.000000 0.0000000
 [5,] 0.0000000 0.000000 0.000000 0.0000000 1.06383 0.000000 0.000000 0.0000000
 [6,] 0.0000000 0.000000 0.000000 0.0000000 0.00000 2.777778 0.000000 0.0000000
 [7,] 0.0000000 0.000000 0.000000 0.0000000 0.00000 0.000000 1.351351 0.0000000
 [8,] 0.0000000 0.000000 0.000000 0.0000000 0.00000 0.000000 0.000000 0.5181347
 [9,] 0.0000000 0.000000 0.000000 0.0000000 0.00000 0.000000 0.000000 0.0000000
          [,9]
 [1,] 0.000000
 [2,] 0.000000
 [3,] 0.000000
 [4,] 0.000000
 [5,] 0.000000
 [6,] 0.000000
 [7,] 0.000000
 [8,] 0.000000
 [9,] 3.030303</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define M</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>    M <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(plxk, I), <span class="at">nrow =</span> I, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Centered matrix?</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>    Z <span class="sc">-</span> M</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    chain store chain store+tea shop tea shop    tea bag tea bag+unpackaged
1          0.36                -0.26     -0.1  0.4333333         -0.3133333
2          0.36                -0.26     -0.1  0.4333333         -0.3133333
3          0.36                -0.26     -0.1  0.4333333         -0.3133333
4          0.36                -0.26     -0.1  0.4333333         -0.3133333
5          0.36                -0.26     -0.1  0.4333333         -0.3133333
6          0.36                -0.26     -0.1  0.4333333         -0.3133333
7          0.36                -0.26     -0.1  0.4333333         -0.3133333
8          0.36                -0.26     -0.1  0.4333333         -0.3133333
9         -0.64                 0.74     -0.1 -0.5666667          0.6866667
10        -0.64                 0.74     -0.1 -0.5666667          0.6866667
11         0.36                -0.26     -0.1  0.4333333         -0.3133333
12         0.36                -0.26     -0.1  0.4333333         -0.3133333
13        -0.64                 0.74     -0.1 -0.5666667          0.6866667
14         0.36                -0.26     -0.1  0.4333333         -0.3133333
15        -0.64                 0.74     -0.1  0.4333333         -0.3133333
16        -0.64                 0.74     -0.1 -0.5666667         -0.3133333
17        -0.64                 0.74     -0.1 -0.5666667          0.6866667
18        -0.64                 0.74     -0.1  0.4333333         -0.3133333
19         0.36                -0.26     -0.1  0.4333333         -0.3133333
20         0.36                -0.26     -0.1  0.4333333         -0.3133333
21        -0.64                 0.74     -0.1  0.4333333         -0.3133333
22        -0.64                 0.74     -0.1 -0.5666667          0.6866667
23         0.36                -0.26     -0.1  0.4333333         -0.3133333
24         0.36                -0.26     -0.1  0.4333333         -0.3133333
25        -0.64                 0.74     -0.1 -0.5666667         -0.3133333
26        -0.64                 0.74     -0.1  0.4333333         -0.3133333
27         0.36                -0.26     -0.1  0.4333333         -0.3133333
28         0.36                -0.26     -0.1 -0.5666667          0.6866667
29         0.36                -0.26     -0.1  0.4333333         -0.3133333
30         0.36                -0.26     -0.1  0.4333333         -0.3133333
31        -0.64                -0.26      0.9 -0.5666667         -0.3133333
32        -0.64                 0.74     -0.1 -0.5666667          0.6866667
33        -0.64                 0.74     -0.1 -0.5666667          0.6866667
34         0.36                -0.26     -0.1  0.4333333         -0.3133333
35        -0.64                 0.74     -0.1 -0.5666667          0.6866667
36         0.36                -0.26     -0.1  0.4333333         -0.3133333
37         0.36                -0.26     -0.1 -0.5666667          0.6866667
38         0.36                -0.26     -0.1  0.4333333         -0.3133333
39        -0.64                 0.74     -0.1  0.4333333         -0.3133333
40        -0.64                 0.74     -0.1 -0.5666667          0.6866667
41         0.36                -0.26     -0.1  0.4333333         -0.3133333
42         0.36                -0.26     -0.1  0.4333333         -0.3133333
43         0.36                -0.26     -0.1  0.4333333         -0.3133333
44        -0.64                 0.74     -0.1  0.4333333         -0.3133333
45         0.36                -0.26     -0.1  0.4333333         -0.3133333
46         0.36                -0.26     -0.1  0.4333333         -0.3133333
47         0.36                -0.26     -0.1  0.4333333         -0.3133333
48        -0.64                 0.74     -0.1 -0.5666667          0.6866667
49         0.36                -0.26     -0.1 -0.5666667          0.6866667
50        -0.64                 0.74     -0.1 -0.5666667          0.6866667
51        -0.64                 0.74     -0.1 -0.5666667          0.6866667
52         0.36                -0.26     -0.1 -0.5666667          0.6866667
53        -0.64                -0.26      0.9 -0.5666667         -0.3133333
54         0.36                -0.26     -0.1  0.4333333         -0.3133333
55         0.36                -0.26     -0.1  0.4333333         -0.3133333
56         0.36                -0.26     -0.1 -0.5666667          0.6866667
57         0.36                -0.26     -0.1  0.4333333         -0.3133333
58        -0.64                 0.74     -0.1 -0.5666667          0.6866667
59        -0.64                 0.74     -0.1 -0.5666667          0.6866667
60         0.36                -0.26     -0.1 -0.5666667          0.6866667
61        -0.64                 0.74     -0.1 -0.5666667          0.6866667
62        -0.64                -0.26      0.9 -0.5666667         -0.3133333
63         0.36                -0.26     -0.1  0.4333333         -0.3133333
64        -0.64                 0.74     -0.1  0.4333333         -0.3133333
65         0.36                -0.26     -0.1 -0.5666667          0.6866667
66        -0.64                 0.74     -0.1 -0.5666667          0.6866667
67        -0.64                 0.74     -0.1 -0.5666667          0.6866667
68        -0.64                 0.74     -0.1 -0.5666667          0.6866667
69         0.36                -0.26     -0.1  0.4333333         -0.3133333
70         0.36                -0.26     -0.1  0.4333333         -0.3133333
71         0.36                -0.26     -0.1  0.4333333         -0.3133333
72        -0.64                 0.74     -0.1 -0.5666667          0.6866667
73         0.36                -0.26     -0.1  0.4333333         -0.3133333
74        -0.64                -0.26      0.9 -0.5666667         -0.3133333
75         0.36                -0.26     -0.1  0.4333333         -0.3133333
76         0.36                -0.26     -0.1  0.4333333         -0.3133333
77         0.36                -0.26     -0.1  0.4333333         -0.3133333
78         0.36                -0.26     -0.1 -0.5666667          0.6866667
79        -0.64                -0.26      0.9  0.4333333         -0.3133333
80         0.36                -0.26     -0.1 -0.5666667          0.6866667
81         0.36                -0.26     -0.1  0.4333333         -0.3133333
82         0.36                -0.26     -0.1 -0.5666667         -0.3133333
83        -0.64                 0.74     -0.1  0.4333333         -0.3133333
84         0.36                -0.26     -0.1  0.4333333         -0.3133333
85         0.36                -0.26     -0.1  0.4333333         -0.3133333
86         0.36                -0.26     -0.1  0.4333333         -0.3133333
87        -0.64                 0.74     -0.1 -0.5666667          0.6866667
88         0.36                -0.26     -0.1  0.4333333         -0.3133333
89        -0.64                 0.74     -0.1  0.4333333         -0.3133333
90         0.36                -0.26     -0.1 -0.5666667          0.6866667
91         0.36                -0.26     -0.1 -0.5666667          0.6866667
92         0.36                -0.26     -0.1 -0.5666667          0.6866667
93         0.36                -0.26     -0.1  0.4333333         -0.3133333
94         0.36                -0.26     -0.1 -0.5666667         -0.3133333
95        -0.64                -0.26      0.9 -0.5666667         -0.3133333
96         0.36                -0.26     -0.1 -0.5666667          0.6866667
97         0.36                -0.26     -0.1  0.4333333         -0.3133333
98         0.36                -0.26     -0.1  0.4333333         -0.3133333
99        -0.64                 0.74     -0.1 -0.5666667          0.6866667
100       -0.64                -0.26      0.9 -0.5666667         -0.3133333
101        0.36                -0.26     -0.1  0.4333333         -0.3133333
102        0.36                -0.26     -0.1 -0.5666667          0.6866667
103       -0.64                 0.74     -0.1 -0.5666667          0.6866667
104        0.36                -0.26     -0.1  0.4333333         -0.3133333
105        0.36                -0.26     -0.1  0.4333333         -0.3133333
106        0.36                -0.26     -0.1  0.4333333         -0.3133333
107        0.36                -0.26     -0.1  0.4333333         -0.3133333
108        0.36                -0.26     -0.1 -0.5666667          0.6866667
109       -0.64                 0.74     -0.1  0.4333333         -0.3133333
110       -0.64                -0.26      0.9 -0.5666667          0.6866667
111        0.36                -0.26     -0.1  0.4333333         -0.3133333
112       -0.64                 0.74     -0.1 -0.5666667          0.6866667
113       -0.64                 0.74     -0.1  0.4333333         -0.3133333
114        0.36                -0.26     -0.1  0.4333333         -0.3133333
115        0.36                -0.26     -0.1  0.4333333         -0.3133333
116        0.36                -0.26     -0.1  0.4333333         -0.3133333
117        0.36                -0.26     -0.1  0.4333333         -0.3133333
118        0.36                -0.26     -0.1  0.4333333         -0.3133333
119        0.36                -0.26     -0.1 -0.5666667          0.6866667
120       -0.64                 0.74     -0.1  0.4333333         -0.3133333
121        0.36                -0.26     -0.1  0.4333333         -0.3133333
122       -0.64                 0.74     -0.1 -0.5666667          0.6866667
123        0.36                -0.26     -0.1  0.4333333         -0.3133333
124        0.36                -0.26     -0.1  0.4333333         -0.3133333
125        0.36                -0.26     -0.1  0.4333333         -0.3133333
126        0.36                -0.26     -0.1  0.4333333         -0.3133333
127       -0.64                 0.74     -0.1 -0.5666667          0.6866667
128        0.36                -0.26     -0.1 -0.5666667          0.6866667
129        0.36                -0.26     -0.1  0.4333333         -0.3133333
130        0.36                -0.26     -0.1  0.4333333         -0.3133333
131        0.36                -0.26     -0.1  0.4333333         -0.3133333
132        0.36                -0.26     -0.1  0.4333333         -0.3133333
133       -0.64                 0.74     -0.1 -0.5666667          0.6866667
134        0.36                -0.26     -0.1  0.4333333         -0.3133333
135        0.36                -0.26     -0.1  0.4333333         -0.3133333
136       -0.64                 0.74     -0.1  0.4333333         -0.3133333
137        0.36                -0.26     -0.1  0.4333333         -0.3133333
138        0.36                -0.26     -0.1  0.4333333         -0.3133333
139        0.36                -0.26     -0.1  0.4333333         -0.3133333
140        0.36                -0.26     -0.1  0.4333333         -0.3133333
141        0.36                -0.26     -0.1  0.4333333         -0.3133333
142        0.36                -0.26     -0.1  0.4333333         -0.3133333
143        0.36                -0.26     -0.1  0.4333333         -0.3133333
144        0.36                -0.26     -0.1  0.4333333         -0.3133333
145        0.36                -0.26     -0.1  0.4333333         -0.3133333
146        0.36                -0.26     -0.1  0.4333333         -0.3133333
147        0.36                -0.26     -0.1  0.4333333         -0.3133333
148       -0.64                 0.74     -0.1  0.4333333         -0.3133333
149       -0.64                -0.26      0.9  0.4333333         -0.3133333
150        0.36                -0.26     -0.1  0.4333333         -0.3133333
151        0.36                -0.26     -0.1 -0.5666667          0.6866667
152        0.36                -0.26     -0.1  0.4333333         -0.3133333
153        0.36                -0.26     -0.1 -0.5666667         -0.3133333
154        0.36                -0.26     -0.1  0.4333333         -0.3133333
155        0.36                -0.26     -0.1  0.4333333         -0.3133333
156        0.36                -0.26     -0.1  0.4333333         -0.3133333
157        0.36                -0.26     -0.1  0.4333333         -0.3133333
158        0.36                -0.26     -0.1  0.4333333         -0.3133333
159       -0.64                 0.74     -0.1 -0.5666667         -0.3133333
160       -0.64                 0.74     -0.1  0.4333333         -0.3133333
161        0.36                -0.26     -0.1 -0.5666667         -0.3133333
162        0.36                -0.26     -0.1  0.4333333         -0.3133333
163        0.36                -0.26     -0.1 -0.5666667          0.6866667
164        0.36                -0.26     -0.1 -0.5666667          0.6866667
165        0.36                -0.26     -0.1 -0.5666667         -0.3133333
166        0.36                -0.26     -0.1  0.4333333         -0.3133333
167        0.36                -0.26     -0.1  0.4333333         -0.3133333
168       -0.64                -0.26      0.9 -0.5666667         -0.3133333
169        0.36                -0.26     -0.1  0.4333333         -0.3133333
170        0.36                -0.26     -0.1  0.4333333         -0.3133333
171       -0.64                 0.74     -0.1 -0.5666667         -0.3133333
172       -0.64                 0.74     -0.1 -0.5666667          0.6866667
173        0.36                -0.26     -0.1 -0.5666667          0.6866667
174        0.36                -0.26     -0.1  0.4333333         -0.3133333
175        0.36                -0.26     -0.1  0.4333333         -0.3133333
176        0.36                -0.26     -0.1  0.4333333         -0.3133333
177        0.36                -0.26     -0.1  0.4333333         -0.3133333
178        0.36                -0.26     -0.1 -0.5666667          0.6866667
179        0.36                -0.26     -0.1  0.4333333         -0.3133333
180        0.36                -0.26     -0.1 -0.5666667          0.6866667
181        0.36                -0.26     -0.1  0.4333333         -0.3133333
182       -0.64                -0.26      0.9 -0.5666667         -0.3133333
183        0.36                -0.26     -0.1  0.4333333         -0.3133333
184        0.36                -0.26     -0.1  0.4333333         -0.3133333
185        0.36                -0.26     -0.1 -0.5666667          0.6866667
186        0.36                -0.26     -0.1  0.4333333         -0.3133333
187        0.36                -0.26     -0.1  0.4333333         -0.3133333
188        0.36                -0.26     -0.1  0.4333333         -0.3133333
189        0.36                -0.26     -0.1 -0.5666667          0.6866667
190       -0.64                -0.26      0.9 -0.5666667         -0.3133333
191       -0.64                -0.26      0.9 -0.5666667          0.6866667
192        0.36                -0.26     -0.1 -0.5666667          0.6866667
193        0.36                -0.26     -0.1  0.4333333         -0.3133333
194        0.36                -0.26     -0.1 -0.5666667          0.6866667
195       -0.64                -0.26      0.9 -0.5666667         -0.3133333
196        0.36                -0.26     -0.1 -0.5666667         -0.3133333
197        0.36                -0.26     -0.1  0.4333333         -0.3133333
198       -0.64                 0.74     -0.1  0.4333333         -0.3133333
199       -0.64                -0.26      0.9  0.4333333         -0.3133333
200        0.36                -0.26     -0.1  0.4333333         -0.3133333
201       -0.64                 0.74     -0.1 -0.5666667          0.6866667
202       -0.64                -0.26      0.9 -0.5666667         -0.3133333
203       -0.64                 0.74     -0.1 -0.5666667          0.6866667
204        0.36                -0.26     -0.1  0.4333333         -0.3133333
205        0.36                -0.26     -0.1  0.4333333         -0.3133333
206        0.36                -0.26     -0.1 -0.5666667         -0.3133333
207       -0.64                 0.74     -0.1 -0.5666667          0.6866667
208       -0.64                -0.26      0.9 -0.5666667         -0.3133333
209        0.36                -0.26     -0.1 -0.5666667         -0.3133333
210        0.36                -0.26     -0.1  0.4333333         -0.3133333
211       -0.64                -0.26      0.9 -0.5666667         -0.3133333
212       -0.64                -0.26      0.9  0.4333333         -0.3133333
213        0.36                -0.26     -0.1  0.4333333         -0.3133333
214       -0.64                 0.74     -0.1  0.4333333         -0.3133333
215        0.36                -0.26     -0.1  0.4333333         -0.3133333
216        0.36                -0.26     -0.1  0.4333333         -0.3133333
217        0.36                -0.26     -0.1 -0.5666667          0.6866667
218        0.36                -0.26     -0.1  0.4333333         -0.3133333
219        0.36                -0.26     -0.1  0.4333333         -0.3133333
220       -0.64                -0.26      0.9 -0.5666667         -0.3133333
221        0.36                -0.26     -0.1 -0.5666667          0.6866667
222       -0.64                -0.26      0.9 -0.5666667          0.6866667
223        0.36                -0.26     -0.1  0.4333333         -0.3133333
224       -0.64                 0.74     -0.1 -0.5666667          0.6866667
225       -0.64                 0.74     -0.1 -0.5666667          0.6866667
226        0.36                -0.26     -0.1  0.4333333         -0.3133333
227       -0.64                -0.26      0.9 -0.5666667          0.6866667
228        0.36                -0.26     -0.1  0.4333333         -0.3133333
229       -0.64                -0.26      0.9 -0.5666667         -0.3133333
230        0.36                -0.26     -0.1  0.4333333         -0.3133333
231        0.36                -0.26     -0.1 -0.5666667          0.6866667
232        0.36                -0.26     -0.1  0.4333333         -0.3133333
233       -0.64                 0.74     -0.1 -0.5666667          0.6866667
234       -0.64                 0.74     -0.1 -0.5666667          0.6866667
235        0.36                -0.26     -0.1 -0.5666667          0.6866667
236        0.36                -0.26     -0.1  0.4333333         -0.3133333
237        0.36                -0.26     -0.1  0.4333333         -0.3133333
238       -0.64                 0.74     -0.1 -0.5666667         -0.3133333
239       -0.64                 0.74     -0.1  0.4333333         -0.3133333
240       -0.64                 0.74     -0.1 -0.5666667          0.6866667
241       -0.64                 0.74     -0.1 -0.5666667          0.6866667
242        0.36                -0.26     -0.1 -0.5666667          0.6866667
243       -0.64                 0.74     -0.1 -0.5666667          0.6866667
244       -0.64                 0.74     -0.1 -0.5666667          0.6866667
245        0.36                -0.26     -0.1  0.4333333         -0.3133333
246       -0.64                 0.74     -0.1 -0.5666667          0.6866667
247        0.36                -0.26     -0.1  0.4333333         -0.3133333
248       -0.64                -0.26      0.9 -0.5666667         -0.3133333
249       -0.64                -0.26      0.9 -0.5666667          0.6866667
250        0.36                -0.26     -0.1  0.4333333         -0.3133333
251       -0.64                 0.74     -0.1 -0.5666667          0.6866667
252       -0.64                 0.74     -0.1 -0.5666667          0.6866667
253       -0.64                 0.74     -0.1 -0.5666667          0.6866667
254        0.36                -0.26     -0.1  0.4333333         -0.3133333
255        0.36                -0.26     -0.1 -0.5666667         -0.3133333
256        0.36                -0.26     -0.1  0.4333333         -0.3133333
257        0.36                -0.26     -0.1  0.4333333         -0.3133333
258        0.36                -0.26     -0.1  0.4333333         -0.3133333
259       -0.64                 0.74     -0.1 -0.5666667          0.6866667
260        0.36                -0.26     -0.1 -0.5666667          0.6866667
261       -0.64                -0.26      0.9 -0.5666667         -0.3133333
262        0.36                -0.26     -0.1  0.4333333         -0.3133333
263        0.36                -0.26     -0.1  0.4333333         -0.3133333
264       -0.64                 0.74     -0.1 -0.5666667          0.6866667
265       -0.64                 0.74     -0.1 -0.5666667          0.6866667
266        0.36                -0.26     -0.1 -0.5666667          0.6866667
267        0.36                -0.26     -0.1 -0.5666667          0.6866667
268       -0.64                 0.74     -0.1 -0.5666667          0.6866667
269       -0.64                 0.74     -0.1 -0.5666667          0.6866667
270       -0.64                 0.74     -0.1 -0.5666667          0.6866667
271       -0.64                 0.74     -0.1 -0.5666667         -0.3133333
272       -0.64                -0.26      0.9 -0.5666667         -0.3133333
273       -0.64                 0.74     -0.1 -0.5666667          0.6866667
274        0.36                -0.26     -0.1  0.4333333         -0.3133333
275        0.36                -0.26     -0.1  0.4333333         -0.3133333
276        0.36                -0.26     -0.1  0.4333333         -0.3133333
277       -0.64                 0.74     -0.1 -0.5666667         -0.3133333
278       -0.64                 0.74     -0.1 -0.5666667         -0.3133333
279        0.36                -0.26     -0.1 -0.5666667          0.6866667
280        0.36                -0.26     -0.1  0.4333333         -0.3133333
281        0.36                -0.26     -0.1  0.4333333         -0.3133333
282        0.36                -0.26     -0.1  0.4333333         -0.3133333
283       -0.64                 0.74     -0.1 -0.5666667          0.6866667
284        0.36                -0.26     -0.1  0.4333333         -0.3133333
285        0.36                -0.26     -0.1  0.4333333         -0.3133333
286        0.36                -0.26     -0.1  0.4333333         -0.3133333
287       -0.64                -0.26      0.9 -0.5666667         -0.3133333
288        0.36                -0.26     -0.1  0.4333333         -0.3133333
289       -0.64                 0.74     -0.1  0.4333333         -0.3133333
290        0.36                -0.26     -0.1  0.4333333         -0.3133333
291        0.36                -0.26     -0.1 -0.5666667          0.6866667
292        0.36                -0.26     -0.1  0.4333333         -0.3133333
293        0.36                -0.26     -0.1  0.4333333         -0.3133333
294        0.36                -0.26     -0.1  0.4333333         -0.3133333
295       -0.64                 0.74     -0.1 -0.5666667          0.6866667
296        0.36                -0.26     -0.1  0.4333333         -0.3133333
297       -0.64                -0.26      0.9 -0.5666667          0.6866667
298        0.36                -0.26     -0.1  0.4333333         -0.3133333
299       -0.64                -0.26      0.9  0.4333333         -0.3133333
300        0.36                -0.26     -0.1  0.4333333         -0.3133333
    unpackaged      black  Earl Grey green
1        -0.12  0.7533333 -0.6433333 -0.11
2        -0.12  0.7533333 -0.6433333 -0.11
3        -0.12 -0.2466667  0.3566667 -0.11
4        -0.12 -0.2466667  0.3566667 -0.11
5        -0.12 -0.2466667  0.3566667 -0.11
6        -0.12 -0.2466667  0.3566667 -0.11
7        -0.12 -0.2466667  0.3566667 -0.11
8        -0.12  0.7533333 -0.6433333 -0.11
9        -0.12 -0.2466667  0.3566667 -0.11
10       -0.12  0.7533333 -0.6433333 -0.11
11       -0.12 -0.2466667  0.3566667 -0.11
12       -0.12 -0.2466667  0.3566667 -0.11
13       -0.12 -0.2466667  0.3566667 -0.11
14       -0.12  0.7533333 -0.6433333 -0.11
15       -0.12  0.7533333 -0.6433333 -0.11
16        0.88 -0.2466667  0.3566667 -0.11
17       -0.12  0.7533333 -0.6433333 -0.11
18       -0.12 -0.2466667  0.3566667 -0.11
19       -0.12  0.7533333 -0.6433333 -0.11
20       -0.12  0.7533333 -0.6433333 -0.11
21       -0.12 -0.2466667  0.3566667 -0.11
22       -0.12  0.7533333 -0.6433333 -0.11
23       -0.12 -0.2466667  0.3566667 -0.11
24       -0.12  0.7533333 -0.6433333 -0.11
25        0.88 -0.2466667  0.3566667 -0.11
26       -0.12 -0.2466667  0.3566667 -0.11
27       -0.12 -0.2466667  0.3566667 -0.11
28       -0.12 -0.2466667  0.3566667 -0.11
29       -0.12  0.7533333 -0.6433333 -0.11
30       -0.12 -0.2466667  0.3566667 -0.11
31        0.88 -0.2466667  0.3566667 -0.11
32       -0.12 -0.2466667  0.3566667 -0.11
33       -0.12 -0.2466667  0.3566667 -0.11
34       -0.12  0.7533333 -0.6433333 -0.11
35       -0.12  0.7533333 -0.6433333 -0.11
36       -0.12 -0.2466667  0.3566667 -0.11
37       -0.12 -0.2466667 -0.6433333  0.89
38       -0.12 -0.2466667 -0.6433333  0.89
39       -0.12 -0.2466667  0.3566667 -0.11
40       -0.12 -0.2466667 -0.6433333  0.89
41       -0.12 -0.2466667  0.3566667 -0.11
42       -0.12 -0.2466667 -0.6433333  0.89
43       -0.12 -0.2466667  0.3566667 -0.11
44       -0.12  0.7533333 -0.6433333 -0.11
45       -0.12 -0.2466667  0.3566667 -0.11
46       -0.12 -0.2466667  0.3566667 -0.11
47       -0.12 -0.2466667  0.3566667 -0.11
48       -0.12 -0.2466667  0.3566667 -0.11
49       -0.12 -0.2466667  0.3566667 -0.11
50       -0.12  0.7533333 -0.6433333 -0.11
51       -0.12 -0.2466667  0.3566667 -0.11
52       -0.12  0.7533333 -0.6433333 -0.11
53        0.88 -0.2466667  0.3566667 -0.11
54       -0.12 -0.2466667  0.3566667 -0.11
55       -0.12 -0.2466667 -0.6433333  0.89
56       -0.12 -0.2466667  0.3566667 -0.11
57       -0.12 -0.2466667 -0.6433333  0.89
58       -0.12 -0.2466667  0.3566667 -0.11
59       -0.12 -0.2466667 -0.6433333  0.89
60       -0.12  0.7533333 -0.6433333 -0.11
61       -0.12 -0.2466667  0.3566667 -0.11
62        0.88 -0.2466667  0.3566667 -0.11
63       -0.12 -0.2466667  0.3566667 -0.11
64       -0.12  0.7533333 -0.6433333 -0.11
65       -0.12 -0.2466667  0.3566667 -0.11
66       -0.12  0.7533333 -0.6433333 -0.11
67       -0.12 -0.2466667  0.3566667 -0.11
68       -0.12 -0.2466667  0.3566667 -0.11
69       -0.12 -0.2466667  0.3566667 -0.11
70       -0.12 -0.2466667  0.3566667 -0.11
71       -0.12 -0.2466667  0.3566667 -0.11
72       -0.12 -0.2466667  0.3566667 -0.11
73       -0.12 -0.2466667  0.3566667 -0.11
74        0.88 -0.2466667  0.3566667 -0.11
75       -0.12  0.7533333 -0.6433333 -0.11
76       -0.12 -0.2466667  0.3566667 -0.11
77       -0.12 -0.2466667  0.3566667 -0.11
78       -0.12 -0.2466667  0.3566667 -0.11
79       -0.12 -0.2466667  0.3566667 -0.11
80       -0.12 -0.2466667  0.3566667 -0.11
81       -0.12  0.7533333 -0.6433333 -0.11
82        0.88 -0.2466667  0.3566667 -0.11
83       -0.12 -0.2466667  0.3566667 -0.11
84       -0.12 -0.2466667  0.3566667 -0.11
85       -0.12 -0.2466667  0.3566667 -0.11
86       -0.12 -0.2466667  0.3566667 -0.11
87       -0.12 -0.2466667  0.3566667 -0.11
88       -0.12 -0.2466667  0.3566667 -0.11
89       -0.12 -0.2466667  0.3566667 -0.11
90       -0.12 -0.2466667  0.3566667 -0.11
91       -0.12  0.7533333 -0.6433333 -0.11
92       -0.12 -0.2466667  0.3566667 -0.11
93       -0.12  0.7533333 -0.6433333 -0.11
94        0.88 -0.2466667  0.3566667 -0.11
95        0.88 -0.2466667  0.3566667 -0.11
96       -0.12  0.7533333 -0.6433333 -0.11
97       -0.12 -0.2466667  0.3566667 -0.11
98       -0.12 -0.2466667  0.3566667 -0.11
99       -0.12  0.7533333 -0.6433333 -0.11
100       0.88 -0.2466667  0.3566667 -0.11
101      -0.12 -0.2466667  0.3566667 -0.11
102      -0.12 -0.2466667 -0.6433333  0.89
103      -0.12 -0.2466667  0.3566667 -0.11
104      -0.12 -0.2466667  0.3566667 -0.11
105      -0.12 -0.2466667  0.3566667 -0.11
106      -0.12 -0.2466667  0.3566667 -0.11
107      -0.12 -0.2466667  0.3566667 -0.11
108      -0.12 -0.2466667  0.3566667 -0.11
109      -0.12 -0.2466667  0.3566667 -0.11
110      -0.12 -0.2466667  0.3566667 -0.11
111      -0.12 -0.2466667  0.3566667 -0.11
112      -0.12 -0.2466667  0.3566667 -0.11
113      -0.12 -0.2466667  0.3566667 -0.11
114      -0.12 -0.2466667  0.3566667 -0.11
115      -0.12 -0.2466667  0.3566667 -0.11
116      -0.12 -0.2466667  0.3566667 -0.11
117      -0.12 -0.2466667  0.3566667 -0.11
118      -0.12 -0.2466667  0.3566667 -0.11
119      -0.12 -0.2466667  0.3566667 -0.11
120      -0.12 -0.2466667  0.3566667 -0.11
121      -0.12 -0.2466667  0.3566667 -0.11
122      -0.12 -0.2466667  0.3566667 -0.11
123      -0.12 -0.2466667  0.3566667 -0.11
124      -0.12 -0.2466667  0.3566667 -0.11
125      -0.12 -0.2466667  0.3566667 -0.11
126      -0.12 -0.2466667  0.3566667 -0.11
127      -0.12  0.7533333 -0.6433333 -0.11
128      -0.12  0.7533333 -0.6433333 -0.11
129      -0.12 -0.2466667  0.3566667 -0.11
130      -0.12 -0.2466667  0.3566667 -0.11
131      -0.12 -0.2466667  0.3566667 -0.11
132      -0.12  0.7533333 -0.6433333 -0.11
133      -0.12 -0.2466667  0.3566667 -0.11
134      -0.12  0.7533333 -0.6433333 -0.11
135      -0.12  0.7533333 -0.6433333 -0.11
136      -0.12 -0.2466667  0.3566667 -0.11
137      -0.12 -0.2466667  0.3566667 -0.11
138      -0.12 -0.2466667  0.3566667 -0.11
139      -0.12 -0.2466667  0.3566667 -0.11
140      -0.12 -0.2466667  0.3566667 -0.11
141      -0.12 -0.2466667  0.3566667 -0.11
142      -0.12 -0.2466667  0.3566667 -0.11
143      -0.12 -0.2466667  0.3566667 -0.11
144      -0.12 -0.2466667  0.3566667 -0.11
145      -0.12 -0.2466667  0.3566667 -0.11
146      -0.12 -0.2466667  0.3566667 -0.11
147      -0.12 -0.2466667  0.3566667 -0.11
148      -0.12  0.7533333 -0.6433333 -0.11
149      -0.12 -0.2466667  0.3566667 -0.11
150      -0.12 -0.2466667  0.3566667 -0.11
151      -0.12  0.7533333 -0.6433333 -0.11
152      -0.12 -0.2466667  0.3566667 -0.11
153       0.88  0.7533333 -0.6433333 -0.11
154      -0.12 -0.2466667 -0.6433333  0.89
155      -0.12 -0.2466667  0.3566667 -0.11
156      -0.12  0.7533333 -0.6433333 -0.11
157      -0.12 -0.2466667  0.3566667 -0.11
158      -0.12 -0.2466667  0.3566667 -0.11
159       0.88  0.7533333 -0.6433333 -0.11
160      -0.12  0.7533333 -0.6433333 -0.11
161       0.88  0.7533333 -0.6433333 -0.11
162      -0.12  0.7533333 -0.6433333 -0.11
163      -0.12 -0.2466667 -0.6433333  0.89
164      -0.12  0.7533333 -0.6433333 -0.11
165       0.88 -0.2466667 -0.6433333  0.89
166      -0.12 -0.2466667  0.3566667 -0.11
167      -0.12 -0.2466667 -0.6433333  0.89
168       0.88  0.7533333 -0.6433333 -0.11
169      -0.12 -0.2466667  0.3566667 -0.11
170      -0.12 -0.2466667  0.3566667 -0.11
171       0.88 -0.2466667  0.3566667 -0.11
172      -0.12 -0.2466667  0.3566667 -0.11
173      -0.12  0.7533333 -0.6433333 -0.11
174      -0.12 -0.2466667  0.3566667 -0.11
175      -0.12 -0.2466667  0.3566667 -0.11
176      -0.12 -0.2466667  0.3566667 -0.11
177      -0.12 -0.2466667  0.3566667 -0.11
178      -0.12 -0.2466667  0.3566667 -0.11
179      -0.12 -0.2466667  0.3566667 -0.11
180      -0.12 -0.2466667 -0.6433333  0.89
181      -0.12  0.7533333 -0.6433333 -0.11
182       0.88  0.7533333 -0.6433333 -0.11
183      -0.12  0.7533333 -0.6433333 -0.11
184      -0.12 -0.2466667  0.3566667 -0.11
185      -0.12 -0.2466667  0.3566667 -0.11
186      -0.12 -0.2466667 -0.6433333  0.89
187      -0.12 -0.2466667 -0.6433333  0.89
188      -0.12 -0.2466667 -0.6433333  0.89
189      -0.12 -0.2466667 -0.6433333  0.89
190       0.88 -0.2466667 -0.6433333  0.89
191      -0.12 -0.2466667  0.3566667 -0.11
192      -0.12 -0.2466667  0.3566667 -0.11
193      -0.12 -0.2466667  0.3566667 -0.11
194      -0.12 -0.2466667  0.3566667 -0.11
195       0.88 -0.2466667 -0.6433333  0.89
196       0.88  0.7533333 -0.6433333 -0.11
197      -0.12 -0.2466667  0.3566667 -0.11
198      -0.12 -0.2466667  0.3566667 -0.11
199      -0.12 -0.2466667 -0.6433333  0.89
200      -0.12 -0.2466667 -0.6433333  0.89
201      -0.12 -0.2466667  0.3566667 -0.11
202       0.88  0.7533333 -0.6433333 -0.11
203      -0.12 -0.2466667  0.3566667 -0.11
204      -0.12 -0.2466667  0.3566667 -0.11
205      -0.12 -0.2466667 -0.6433333  0.89
206       0.88  0.7533333 -0.6433333 -0.11
207      -0.12  0.7533333 -0.6433333 -0.11
208       0.88  0.7533333 -0.6433333 -0.11
209       0.88 -0.2466667 -0.6433333  0.89
210      -0.12 -0.2466667  0.3566667 -0.11
211       0.88  0.7533333 -0.6433333 -0.11
212      -0.12 -0.2466667 -0.6433333  0.89
213      -0.12  0.7533333 -0.6433333 -0.11
214      -0.12 -0.2466667  0.3566667 -0.11
215      -0.12 -0.2466667  0.3566667 -0.11
216      -0.12  0.7533333 -0.6433333 -0.11
217      -0.12  0.7533333 -0.6433333 -0.11
218      -0.12 -0.2466667  0.3566667 -0.11
219      -0.12 -0.2466667  0.3566667 -0.11
220       0.88 -0.2466667  0.3566667 -0.11
221      -0.12 -0.2466667  0.3566667 -0.11
222      -0.12 -0.2466667 -0.6433333  0.89
223      -0.12 -0.2466667  0.3566667 -0.11
224      -0.12 -0.2466667  0.3566667 -0.11
225      -0.12  0.7533333 -0.6433333 -0.11
226      -0.12 -0.2466667 -0.6433333  0.89
227      -0.12 -0.2466667 -0.6433333  0.89
228      -0.12  0.7533333 -0.6433333 -0.11
229       0.88 -0.2466667 -0.6433333  0.89
230      -0.12 -0.2466667  0.3566667 -0.11
231      -0.12  0.7533333 -0.6433333 -0.11
232      -0.12 -0.2466667  0.3566667 -0.11
233      -0.12 -0.2466667  0.3566667 -0.11
234      -0.12 -0.2466667  0.3566667 -0.11
235      -0.12 -0.2466667  0.3566667 -0.11
236      -0.12 -0.2466667  0.3566667 -0.11
237      -0.12 -0.2466667  0.3566667 -0.11
238       0.88 -0.2466667  0.3566667 -0.11
239      -0.12 -0.2466667  0.3566667 -0.11
240      -0.12 -0.2466667  0.3566667 -0.11
241      -0.12 -0.2466667  0.3566667 -0.11
242      -0.12 -0.2466667  0.3566667 -0.11
243      -0.12 -0.2466667 -0.6433333  0.89
244      -0.12 -0.2466667  0.3566667 -0.11
245      -0.12 -0.2466667  0.3566667 -0.11
246      -0.12 -0.2466667  0.3566667 -0.11
247      -0.12  0.7533333 -0.6433333 -0.11
248       0.88 -0.2466667  0.3566667 -0.11
249      -0.12 -0.2466667  0.3566667 -0.11
250      -0.12 -0.2466667  0.3566667 -0.11
251      -0.12 -0.2466667  0.3566667 -0.11
252      -0.12 -0.2466667  0.3566667 -0.11
253      -0.12 -0.2466667  0.3566667 -0.11
254      -0.12 -0.2466667  0.3566667 -0.11
255       0.88 -0.2466667  0.3566667 -0.11
256      -0.12  0.7533333 -0.6433333 -0.11
257      -0.12  0.7533333 -0.6433333 -0.11
258      -0.12 -0.2466667 -0.6433333  0.89
259      -0.12 -0.2466667  0.3566667 -0.11
260      -0.12 -0.2466667  0.3566667 -0.11
261       0.88  0.7533333 -0.6433333 -0.11
262      -0.12 -0.2466667 -0.6433333  0.89
263      -0.12  0.7533333 -0.6433333 -0.11
264      -0.12 -0.2466667  0.3566667 -0.11
265      -0.12 -0.2466667  0.3566667 -0.11
266      -0.12 -0.2466667  0.3566667 -0.11
267      -0.12  0.7533333 -0.6433333 -0.11
268      -0.12 -0.2466667  0.3566667 -0.11
269      -0.12  0.7533333 -0.6433333 -0.11
270      -0.12 -0.2466667  0.3566667 -0.11
271       0.88  0.7533333 -0.6433333 -0.11
272       0.88  0.7533333 -0.6433333 -0.11
273      -0.12 -0.2466667  0.3566667 -0.11
274      -0.12 -0.2466667  0.3566667 -0.11
275      -0.12  0.7533333 -0.6433333 -0.11
276      -0.12 -0.2466667  0.3566667 -0.11
277       0.88  0.7533333 -0.6433333 -0.11
278       0.88  0.7533333 -0.6433333 -0.11
279      -0.12  0.7533333 -0.6433333 -0.11
280      -0.12 -0.2466667  0.3566667 -0.11
281      -0.12 -0.2466667  0.3566667 -0.11
282      -0.12 -0.2466667  0.3566667 -0.11
283      -0.12 -0.2466667  0.3566667 -0.11
284      -0.12  0.7533333 -0.6433333 -0.11
285      -0.12 -0.2466667  0.3566667 -0.11
286      -0.12 -0.2466667  0.3566667 -0.11
287       0.88 -0.2466667  0.3566667 -0.11
288      -0.12  0.7533333 -0.6433333 -0.11
289      -0.12 -0.2466667  0.3566667 -0.11
290      -0.12 -0.2466667  0.3566667 -0.11
291      -0.12 -0.2466667  0.3566667 -0.11
292      -0.12 -0.2466667  0.3566667 -0.11
293      -0.12 -0.2466667  0.3566667 -0.11
294      -0.12 -0.2466667  0.3566667 -0.11
295      -0.12 -0.2466667  0.3566667 -0.11
296      -0.12 -0.2466667 -0.6433333  0.89
297      -0.12 -0.2466667 -0.6433333  0.89
298      -0.12 -0.2466667  0.3566667 -0.11
299      -0.12  0.7533333 -0.6433333 -0.11
300      -0.12  0.7533333 -0.6433333 -0.11</code></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># MCA based on Chavent Et Al 2017 et al 2017 p. 505 (p. 5 of pdf) -----------1  ---</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Work with categorical predictors from the tea dataset</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> tea[, <span class="fu">c</span>(<span class="st">"where"</span>, <span class="st">"how"</span>, <span class="st">"Tea"</span>)]</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define Z (the disjunctive table)</span></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>    G <span class="ot">&lt;-</span> <span class="fu">tab.disjonctif</span>(x)</span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define row weights</span></span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>    N <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">1</span> <span class="sc">/</span> n, n)</span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define column weights</span></span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a>    M <span class="ot">&lt;-</span> <span class="fu">diag</span>(n <span class="sc">/</span> <span class="fu">colSums</span>(G))</span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">solve</span>(D_sigma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        [,1]     [,2] [,3]     [,4]     [,5]     [,6]     [,7]     [,8]
 [1,] 1.5625 0.000000    0 0.000000 0.000000 0.000000 0.000000 0.000000
 [2,] 0.0000 3.846154    0 0.000000 0.000000 0.000000 0.000000 0.000000
 [3,] 0.0000 0.000000   10 0.000000 0.000000 0.000000 0.000000 0.000000
 [4,] 0.0000 0.000000    0 1.764706 0.000000 0.000000 0.000000 0.000000
 [5,] 0.0000 0.000000    0 0.000000 3.191489 0.000000 0.000000 0.000000
 [6,] 0.0000 0.000000    0 0.000000 0.000000 8.333333 0.000000 0.000000
 [7,] 0.0000 0.000000    0 0.000000 0.000000 0.000000 4.054054 0.000000
 [8,] 0.0000 0.000000    0 0.000000 0.000000 0.000000 0.000000 1.554404
 [9,] 0.0000 0.000000    0 0.000000 0.000000 0.000000 0.000000 0.000000
          [,9]
 [1,] 0.000000
 [2,] 0.000000
 [3,] 0.000000
 [4,] 0.000000
 [5,] 0.000000
 [6,] 0.000000
 [7,] 0.000000
 [8,] 0.000000
 [9,] 9.090909</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create Z, the centered G?</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>    plxk <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(G)</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>    G <span class="sc">-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(plxk, I), <span class="at">nrow =</span> I, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    chain store chain store+tea shop tea shop    tea bag tea bag+unpackaged
1          0.36                -0.26     -0.1  0.4333333         -0.3133333
2          0.36                -0.26     -0.1  0.4333333         -0.3133333
3          0.36                -0.26     -0.1  0.4333333         -0.3133333
4          0.36                -0.26     -0.1  0.4333333         -0.3133333
5          0.36                -0.26     -0.1  0.4333333         -0.3133333
6          0.36                -0.26     -0.1  0.4333333         -0.3133333
7          0.36                -0.26     -0.1  0.4333333         -0.3133333
8          0.36                -0.26     -0.1  0.4333333         -0.3133333
9         -0.64                 0.74     -0.1 -0.5666667          0.6866667
10        -0.64                 0.74     -0.1 -0.5666667          0.6866667
11         0.36                -0.26     -0.1  0.4333333         -0.3133333
12         0.36                -0.26     -0.1  0.4333333         -0.3133333
13        -0.64                 0.74     -0.1 -0.5666667          0.6866667
14         0.36                -0.26     -0.1  0.4333333         -0.3133333
15        -0.64                 0.74     -0.1  0.4333333         -0.3133333
16        -0.64                 0.74     -0.1 -0.5666667         -0.3133333
17        -0.64                 0.74     -0.1 -0.5666667          0.6866667
18        -0.64                 0.74     -0.1  0.4333333         -0.3133333
19         0.36                -0.26     -0.1  0.4333333         -0.3133333
20         0.36                -0.26     -0.1  0.4333333         -0.3133333
21        -0.64                 0.74     -0.1  0.4333333         -0.3133333
22        -0.64                 0.74     -0.1 -0.5666667          0.6866667
23         0.36                -0.26     -0.1  0.4333333         -0.3133333
24         0.36                -0.26     -0.1  0.4333333         -0.3133333
25        -0.64                 0.74     -0.1 -0.5666667         -0.3133333
26        -0.64                 0.74     -0.1  0.4333333         -0.3133333
27         0.36                -0.26     -0.1  0.4333333         -0.3133333
28         0.36                -0.26     -0.1 -0.5666667          0.6866667
29         0.36                -0.26     -0.1  0.4333333         -0.3133333
30         0.36                -0.26     -0.1  0.4333333         -0.3133333
31        -0.64                -0.26      0.9 -0.5666667         -0.3133333
32        -0.64                 0.74     -0.1 -0.5666667          0.6866667
33        -0.64                 0.74     -0.1 -0.5666667          0.6866667
34         0.36                -0.26     -0.1  0.4333333         -0.3133333
35        -0.64                 0.74     -0.1 -0.5666667          0.6866667
36         0.36                -0.26     -0.1  0.4333333         -0.3133333
37         0.36                -0.26     -0.1 -0.5666667          0.6866667
38         0.36                -0.26     -0.1  0.4333333         -0.3133333
39        -0.64                 0.74     -0.1  0.4333333         -0.3133333
40        -0.64                 0.74     -0.1 -0.5666667          0.6866667
41         0.36                -0.26     -0.1  0.4333333         -0.3133333
42         0.36                -0.26     -0.1  0.4333333         -0.3133333
43         0.36                -0.26     -0.1  0.4333333         -0.3133333
44        -0.64                 0.74     -0.1  0.4333333         -0.3133333
45         0.36                -0.26     -0.1  0.4333333         -0.3133333
46         0.36                -0.26     -0.1  0.4333333         -0.3133333
47         0.36                -0.26     -0.1  0.4333333         -0.3133333
48        -0.64                 0.74     -0.1 -0.5666667          0.6866667
49         0.36                -0.26     -0.1 -0.5666667          0.6866667
50        -0.64                 0.74     -0.1 -0.5666667          0.6866667
51        -0.64                 0.74     -0.1 -0.5666667          0.6866667
52         0.36                -0.26     -0.1 -0.5666667          0.6866667
53        -0.64                -0.26      0.9 -0.5666667         -0.3133333
54         0.36                -0.26     -0.1  0.4333333         -0.3133333
55         0.36                -0.26     -0.1  0.4333333         -0.3133333
56         0.36                -0.26     -0.1 -0.5666667          0.6866667
57         0.36                -0.26     -0.1  0.4333333         -0.3133333
58        -0.64                 0.74     -0.1 -0.5666667          0.6866667
59        -0.64                 0.74     -0.1 -0.5666667          0.6866667
60         0.36                -0.26     -0.1 -0.5666667          0.6866667
61        -0.64                 0.74     -0.1 -0.5666667          0.6866667
62        -0.64                -0.26      0.9 -0.5666667         -0.3133333
63         0.36                -0.26     -0.1  0.4333333         -0.3133333
64        -0.64                 0.74     -0.1  0.4333333         -0.3133333
65         0.36                -0.26     -0.1 -0.5666667          0.6866667
66        -0.64                 0.74     -0.1 -0.5666667          0.6866667
67        -0.64                 0.74     -0.1 -0.5666667          0.6866667
68        -0.64                 0.74     -0.1 -0.5666667          0.6866667
69         0.36                -0.26     -0.1  0.4333333         -0.3133333
70         0.36                -0.26     -0.1  0.4333333         -0.3133333
71         0.36                -0.26     -0.1  0.4333333         -0.3133333
72        -0.64                 0.74     -0.1 -0.5666667          0.6866667
73         0.36                -0.26     -0.1  0.4333333         -0.3133333
74        -0.64                -0.26      0.9 -0.5666667         -0.3133333
75         0.36                -0.26     -0.1  0.4333333         -0.3133333
76         0.36                -0.26     -0.1  0.4333333         -0.3133333
77         0.36                -0.26     -0.1  0.4333333         -0.3133333
78         0.36                -0.26     -0.1 -0.5666667          0.6866667
79        -0.64                -0.26      0.9  0.4333333         -0.3133333
80         0.36                -0.26     -0.1 -0.5666667          0.6866667
81         0.36                -0.26     -0.1  0.4333333         -0.3133333
82         0.36                -0.26     -0.1 -0.5666667         -0.3133333
83        -0.64                 0.74     -0.1  0.4333333         -0.3133333
84         0.36                -0.26     -0.1  0.4333333         -0.3133333
85         0.36                -0.26     -0.1  0.4333333         -0.3133333
86         0.36                -0.26     -0.1  0.4333333         -0.3133333
87        -0.64                 0.74     -0.1 -0.5666667          0.6866667
88         0.36                -0.26     -0.1  0.4333333         -0.3133333
89        -0.64                 0.74     -0.1  0.4333333         -0.3133333
90         0.36                -0.26     -0.1 -0.5666667          0.6866667
91         0.36                -0.26     -0.1 -0.5666667          0.6866667
92         0.36                -0.26     -0.1 -0.5666667          0.6866667
93         0.36                -0.26     -0.1  0.4333333         -0.3133333
94         0.36                -0.26     -0.1 -0.5666667         -0.3133333
95        -0.64                -0.26      0.9 -0.5666667         -0.3133333
96         0.36                -0.26     -0.1 -0.5666667          0.6866667
97         0.36                -0.26     -0.1  0.4333333         -0.3133333
98         0.36                -0.26     -0.1  0.4333333         -0.3133333
99        -0.64                 0.74     -0.1 -0.5666667          0.6866667
100       -0.64                -0.26      0.9 -0.5666667         -0.3133333
101        0.36                -0.26     -0.1  0.4333333         -0.3133333
102        0.36                -0.26     -0.1 -0.5666667          0.6866667
103       -0.64                 0.74     -0.1 -0.5666667          0.6866667
104        0.36                -0.26     -0.1  0.4333333         -0.3133333
105        0.36                -0.26     -0.1  0.4333333         -0.3133333
106        0.36                -0.26     -0.1  0.4333333         -0.3133333
107        0.36                -0.26     -0.1  0.4333333         -0.3133333
108        0.36                -0.26     -0.1 -0.5666667          0.6866667
109       -0.64                 0.74     -0.1  0.4333333         -0.3133333
110       -0.64                -0.26      0.9 -0.5666667          0.6866667
111        0.36                -0.26     -0.1  0.4333333         -0.3133333
112       -0.64                 0.74     -0.1 -0.5666667          0.6866667
113       -0.64                 0.74     -0.1  0.4333333         -0.3133333
114        0.36                -0.26     -0.1  0.4333333         -0.3133333
115        0.36                -0.26     -0.1  0.4333333         -0.3133333
116        0.36                -0.26     -0.1  0.4333333         -0.3133333
117        0.36                -0.26     -0.1  0.4333333         -0.3133333
118        0.36                -0.26     -0.1  0.4333333         -0.3133333
119        0.36                -0.26     -0.1 -0.5666667          0.6866667
120       -0.64                 0.74     -0.1  0.4333333         -0.3133333
121        0.36                -0.26     -0.1  0.4333333         -0.3133333
122       -0.64                 0.74     -0.1 -0.5666667          0.6866667
123        0.36                -0.26     -0.1  0.4333333         -0.3133333
124        0.36                -0.26     -0.1  0.4333333         -0.3133333
125        0.36                -0.26     -0.1  0.4333333         -0.3133333
126        0.36                -0.26     -0.1  0.4333333         -0.3133333
127       -0.64                 0.74     -0.1 -0.5666667          0.6866667
128        0.36                -0.26     -0.1 -0.5666667          0.6866667
129        0.36                -0.26     -0.1  0.4333333         -0.3133333
130        0.36                -0.26     -0.1  0.4333333         -0.3133333
131        0.36                -0.26     -0.1  0.4333333         -0.3133333
132        0.36                -0.26     -0.1  0.4333333         -0.3133333
133       -0.64                 0.74     -0.1 -0.5666667          0.6866667
134        0.36                -0.26     -0.1  0.4333333         -0.3133333
135        0.36                -0.26     -0.1  0.4333333         -0.3133333
136       -0.64                 0.74     -0.1  0.4333333         -0.3133333
137        0.36                -0.26     -0.1  0.4333333         -0.3133333
138        0.36                -0.26     -0.1  0.4333333         -0.3133333
139        0.36                -0.26     -0.1  0.4333333         -0.3133333
140        0.36                -0.26     -0.1  0.4333333         -0.3133333
141        0.36                -0.26     -0.1  0.4333333         -0.3133333
142        0.36                -0.26     -0.1  0.4333333         -0.3133333
143        0.36                -0.26     -0.1  0.4333333         -0.3133333
144        0.36                -0.26     -0.1  0.4333333         -0.3133333
145        0.36                -0.26     -0.1  0.4333333         -0.3133333
146        0.36                -0.26     -0.1  0.4333333         -0.3133333
147        0.36                -0.26     -0.1  0.4333333         -0.3133333
148       -0.64                 0.74     -0.1  0.4333333         -0.3133333
149       -0.64                -0.26      0.9  0.4333333         -0.3133333
150        0.36                -0.26     -0.1  0.4333333         -0.3133333
151        0.36                -0.26     -0.1 -0.5666667          0.6866667
152        0.36                -0.26     -0.1  0.4333333         -0.3133333
153        0.36                -0.26     -0.1 -0.5666667         -0.3133333
154        0.36                -0.26     -0.1  0.4333333         -0.3133333
155        0.36                -0.26     -0.1  0.4333333         -0.3133333
156        0.36                -0.26     -0.1  0.4333333         -0.3133333
157        0.36                -0.26     -0.1  0.4333333         -0.3133333
158        0.36                -0.26     -0.1  0.4333333         -0.3133333
159       -0.64                 0.74     -0.1 -0.5666667         -0.3133333
160       -0.64                 0.74     -0.1  0.4333333         -0.3133333
161        0.36                -0.26     -0.1 -0.5666667         -0.3133333
162        0.36                -0.26     -0.1  0.4333333         -0.3133333
163        0.36                -0.26     -0.1 -0.5666667          0.6866667
164        0.36                -0.26     -0.1 -0.5666667          0.6866667
165        0.36                -0.26     -0.1 -0.5666667         -0.3133333
166        0.36                -0.26     -0.1  0.4333333         -0.3133333
167        0.36                -0.26     -0.1  0.4333333         -0.3133333
168       -0.64                -0.26      0.9 -0.5666667         -0.3133333
169        0.36                -0.26     -0.1  0.4333333         -0.3133333
170        0.36                -0.26     -0.1  0.4333333         -0.3133333
171       -0.64                 0.74     -0.1 -0.5666667         -0.3133333
172       -0.64                 0.74     -0.1 -0.5666667          0.6866667
173        0.36                -0.26     -0.1 -0.5666667          0.6866667
174        0.36                -0.26     -0.1  0.4333333         -0.3133333
175        0.36                -0.26     -0.1  0.4333333         -0.3133333
176        0.36                -0.26     -0.1  0.4333333         -0.3133333
177        0.36                -0.26     -0.1  0.4333333         -0.3133333
178        0.36                -0.26     -0.1 -0.5666667          0.6866667
179        0.36                -0.26     -0.1  0.4333333         -0.3133333
180        0.36                -0.26     -0.1 -0.5666667          0.6866667
181        0.36                -0.26     -0.1  0.4333333         -0.3133333
182       -0.64                -0.26      0.9 -0.5666667         -0.3133333
183        0.36                -0.26     -0.1  0.4333333         -0.3133333
184        0.36                -0.26     -0.1  0.4333333         -0.3133333
185        0.36                -0.26     -0.1 -0.5666667          0.6866667
186        0.36                -0.26     -0.1  0.4333333         -0.3133333
187        0.36                -0.26     -0.1  0.4333333         -0.3133333
188        0.36                -0.26     -0.1  0.4333333         -0.3133333
189        0.36                -0.26     -0.1 -0.5666667          0.6866667
190       -0.64                -0.26      0.9 -0.5666667         -0.3133333
191       -0.64                -0.26      0.9 -0.5666667          0.6866667
192        0.36                -0.26     -0.1 -0.5666667          0.6866667
193        0.36                -0.26     -0.1  0.4333333         -0.3133333
194        0.36                -0.26     -0.1 -0.5666667          0.6866667
195       -0.64                -0.26      0.9 -0.5666667         -0.3133333
196        0.36                -0.26     -0.1 -0.5666667         -0.3133333
197        0.36                -0.26     -0.1  0.4333333         -0.3133333
198       -0.64                 0.74     -0.1  0.4333333         -0.3133333
199       -0.64                -0.26      0.9  0.4333333         -0.3133333
200        0.36                -0.26     -0.1  0.4333333         -0.3133333
201       -0.64                 0.74     -0.1 -0.5666667          0.6866667
202       -0.64                -0.26      0.9 -0.5666667         -0.3133333
203       -0.64                 0.74     -0.1 -0.5666667          0.6866667
204        0.36                -0.26     -0.1  0.4333333         -0.3133333
205        0.36                -0.26     -0.1  0.4333333         -0.3133333
206        0.36                -0.26     -0.1 -0.5666667         -0.3133333
207       -0.64                 0.74     -0.1 -0.5666667          0.6866667
208       -0.64                -0.26      0.9 -0.5666667         -0.3133333
209        0.36                -0.26     -0.1 -0.5666667         -0.3133333
210        0.36                -0.26     -0.1  0.4333333         -0.3133333
211       -0.64                -0.26      0.9 -0.5666667         -0.3133333
212       -0.64                -0.26      0.9  0.4333333         -0.3133333
213        0.36                -0.26     -0.1  0.4333333         -0.3133333
214       -0.64                 0.74     -0.1  0.4333333         -0.3133333
215        0.36                -0.26     -0.1  0.4333333         -0.3133333
216        0.36                -0.26     -0.1  0.4333333         -0.3133333
217        0.36                -0.26     -0.1 -0.5666667          0.6866667
218        0.36                -0.26     -0.1  0.4333333         -0.3133333
219        0.36                -0.26     -0.1  0.4333333         -0.3133333
220       -0.64                -0.26      0.9 -0.5666667         -0.3133333
221        0.36                -0.26     -0.1 -0.5666667          0.6866667
222       -0.64                -0.26      0.9 -0.5666667          0.6866667
223        0.36                -0.26     -0.1  0.4333333         -0.3133333
224       -0.64                 0.74     -0.1 -0.5666667          0.6866667
225       -0.64                 0.74     -0.1 -0.5666667          0.6866667
226        0.36                -0.26     -0.1  0.4333333         -0.3133333
227       -0.64                -0.26      0.9 -0.5666667          0.6866667
228        0.36                -0.26     -0.1  0.4333333         -0.3133333
229       -0.64                -0.26      0.9 -0.5666667         -0.3133333
230        0.36                -0.26     -0.1  0.4333333         -0.3133333
231        0.36                -0.26     -0.1 -0.5666667          0.6866667
232        0.36                -0.26     -0.1  0.4333333         -0.3133333
233       -0.64                 0.74     -0.1 -0.5666667          0.6866667
234       -0.64                 0.74     -0.1 -0.5666667          0.6866667
235        0.36                -0.26     -0.1 -0.5666667          0.6866667
236        0.36                -0.26     -0.1  0.4333333         -0.3133333
237        0.36                -0.26     -0.1  0.4333333         -0.3133333
238       -0.64                 0.74     -0.1 -0.5666667         -0.3133333
239       -0.64                 0.74     -0.1  0.4333333         -0.3133333
240       -0.64                 0.74     -0.1 -0.5666667          0.6866667
241       -0.64                 0.74     -0.1 -0.5666667          0.6866667
242        0.36                -0.26     -0.1 -0.5666667          0.6866667
243       -0.64                 0.74     -0.1 -0.5666667          0.6866667
244       -0.64                 0.74     -0.1 -0.5666667          0.6866667
245        0.36                -0.26     -0.1  0.4333333         -0.3133333
246       -0.64                 0.74     -0.1 -0.5666667          0.6866667
247        0.36                -0.26     -0.1  0.4333333         -0.3133333
248       -0.64                -0.26      0.9 -0.5666667         -0.3133333
249       -0.64                -0.26      0.9 -0.5666667          0.6866667
250        0.36                -0.26     -0.1  0.4333333         -0.3133333
251       -0.64                 0.74     -0.1 -0.5666667          0.6866667
252       -0.64                 0.74     -0.1 -0.5666667          0.6866667
253       -0.64                 0.74     -0.1 -0.5666667          0.6866667
254        0.36                -0.26     -0.1  0.4333333         -0.3133333
255        0.36                -0.26     -0.1 -0.5666667         -0.3133333
256        0.36                -0.26     -0.1  0.4333333         -0.3133333
257        0.36                -0.26     -0.1  0.4333333         -0.3133333
258        0.36                -0.26     -0.1  0.4333333         -0.3133333
259       -0.64                 0.74     -0.1 -0.5666667          0.6866667
260        0.36                -0.26     -0.1 -0.5666667          0.6866667
261       -0.64                -0.26      0.9 -0.5666667         -0.3133333
262        0.36                -0.26     -0.1  0.4333333         -0.3133333
263        0.36                -0.26     -0.1  0.4333333         -0.3133333
264       -0.64                 0.74     -0.1 -0.5666667          0.6866667
265       -0.64                 0.74     -0.1 -0.5666667          0.6866667
266        0.36                -0.26     -0.1 -0.5666667          0.6866667
267        0.36                -0.26     -0.1 -0.5666667          0.6866667
268       -0.64                 0.74     -0.1 -0.5666667          0.6866667
269       -0.64                 0.74     -0.1 -0.5666667          0.6866667
270       -0.64                 0.74     -0.1 -0.5666667          0.6866667
271       -0.64                 0.74     -0.1 -0.5666667         -0.3133333
272       -0.64                -0.26      0.9 -0.5666667         -0.3133333
273       -0.64                 0.74     -0.1 -0.5666667          0.6866667
274        0.36                -0.26     -0.1  0.4333333         -0.3133333
275        0.36                -0.26     -0.1  0.4333333         -0.3133333
276        0.36                -0.26     -0.1  0.4333333         -0.3133333
277       -0.64                 0.74     -0.1 -0.5666667         -0.3133333
278       -0.64                 0.74     -0.1 -0.5666667         -0.3133333
279        0.36                -0.26     -0.1 -0.5666667          0.6866667
280        0.36                -0.26     -0.1  0.4333333         -0.3133333
281        0.36                -0.26     -0.1  0.4333333         -0.3133333
282        0.36                -0.26     -0.1  0.4333333         -0.3133333
283       -0.64                 0.74     -0.1 -0.5666667          0.6866667
284        0.36                -0.26     -0.1  0.4333333         -0.3133333
285        0.36                -0.26     -0.1  0.4333333         -0.3133333
286        0.36                -0.26     -0.1  0.4333333         -0.3133333
287       -0.64                -0.26      0.9 -0.5666667         -0.3133333
288        0.36                -0.26     -0.1  0.4333333         -0.3133333
289       -0.64                 0.74     -0.1  0.4333333         -0.3133333
290        0.36                -0.26     -0.1  0.4333333         -0.3133333
291        0.36                -0.26     -0.1 -0.5666667          0.6866667
292        0.36                -0.26     -0.1  0.4333333         -0.3133333
293        0.36                -0.26     -0.1  0.4333333         -0.3133333
294        0.36                -0.26     -0.1  0.4333333         -0.3133333
295       -0.64                 0.74     -0.1 -0.5666667          0.6866667
296        0.36                -0.26     -0.1  0.4333333         -0.3133333
297       -0.64                -0.26      0.9 -0.5666667          0.6866667
298        0.36                -0.26     -0.1  0.4333333         -0.3133333
299       -0.64                -0.26      0.9  0.4333333         -0.3133333
300        0.36                -0.26     -0.1  0.4333333         -0.3133333
    unpackaged      black  Earl Grey green
1        -0.12  0.7533333 -0.6433333 -0.11
2        -0.12  0.7533333 -0.6433333 -0.11
3        -0.12 -0.2466667  0.3566667 -0.11
4        -0.12 -0.2466667  0.3566667 -0.11
5        -0.12 -0.2466667  0.3566667 -0.11
6        -0.12 -0.2466667  0.3566667 -0.11
7        -0.12 -0.2466667  0.3566667 -0.11
8        -0.12  0.7533333 -0.6433333 -0.11
9        -0.12 -0.2466667  0.3566667 -0.11
10       -0.12  0.7533333 -0.6433333 -0.11
11       -0.12 -0.2466667  0.3566667 -0.11
12       -0.12 -0.2466667  0.3566667 -0.11
13       -0.12 -0.2466667  0.3566667 -0.11
14       -0.12  0.7533333 -0.6433333 -0.11
15       -0.12  0.7533333 -0.6433333 -0.11
16        0.88 -0.2466667  0.3566667 -0.11
17       -0.12  0.7533333 -0.6433333 -0.11
18       -0.12 -0.2466667  0.3566667 -0.11
19       -0.12  0.7533333 -0.6433333 -0.11
20       -0.12  0.7533333 -0.6433333 -0.11
21       -0.12 -0.2466667  0.3566667 -0.11
22       -0.12  0.7533333 -0.6433333 -0.11
23       -0.12 -0.2466667  0.3566667 -0.11
24       -0.12  0.7533333 -0.6433333 -0.11
25        0.88 -0.2466667  0.3566667 -0.11
26       -0.12 -0.2466667  0.3566667 -0.11
27       -0.12 -0.2466667  0.3566667 -0.11
28       -0.12 -0.2466667  0.3566667 -0.11
29       -0.12  0.7533333 -0.6433333 -0.11
30       -0.12 -0.2466667  0.3566667 -0.11
31        0.88 -0.2466667  0.3566667 -0.11
32       -0.12 -0.2466667  0.3566667 -0.11
33       -0.12 -0.2466667  0.3566667 -0.11
34       -0.12  0.7533333 -0.6433333 -0.11
35       -0.12  0.7533333 -0.6433333 -0.11
36       -0.12 -0.2466667  0.3566667 -0.11
37       -0.12 -0.2466667 -0.6433333  0.89
38       -0.12 -0.2466667 -0.6433333  0.89
39       -0.12 -0.2466667  0.3566667 -0.11
40       -0.12 -0.2466667 -0.6433333  0.89
41       -0.12 -0.2466667  0.3566667 -0.11
42       -0.12 -0.2466667 -0.6433333  0.89
43       -0.12 -0.2466667  0.3566667 -0.11
44       -0.12  0.7533333 -0.6433333 -0.11
45       -0.12 -0.2466667  0.3566667 -0.11
46       -0.12 -0.2466667  0.3566667 -0.11
47       -0.12 -0.2466667  0.3566667 -0.11
48       -0.12 -0.2466667  0.3566667 -0.11
49       -0.12 -0.2466667  0.3566667 -0.11
50       -0.12  0.7533333 -0.6433333 -0.11
51       -0.12 -0.2466667  0.3566667 -0.11
52       -0.12  0.7533333 -0.6433333 -0.11
53        0.88 -0.2466667  0.3566667 -0.11
54       -0.12 -0.2466667  0.3566667 -0.11
55       -0.12 -0.2466667 -0.6433333  0.89
56       -0.12 -0.2466667  0.3566667 -0.11
57       -0.12 -0.2466667 -0.6433333  0.89
58       -0.12 -0.2466667  0.3566667 -0.11
59       -0.12 -0.2466667 -0.6433333  0.89
60       -0.12  0.7533333 -0.6433333 -0.11
61       -0.12 -0.2466667  0.3566667 -0.11
62        0.88 -0.2466667  0.3566667 -0.11
63       -0.12 -0.2466667  0.3566667 -0.11
64       -0.12  0.7533333 -0.6433333 -0.11
65       -0.12 -0.2466667  0.3566667 -0.11
66       -0.12  0.7533333 -0.6433333 -0.11
67       -0.12 -0.2466667  0.3566667 -0.11
68       -0.12 -0.2466667  0.3566667 -0.11
69       -0.12 -0.2466667  0.3566667 -0.11
70       -0.12 -0.2466667  0.3566667 -0.11
71       -0.12 -0.2466667  0.3566667 -0.11
72       -0.12 -0.2466667  0.3566667 -0.11
73       -0.12 -0.2466667  0.3566667 -0.11
74        0.88 -0.2466667  0.3566667 -0.11
75       -0.12  0.7533333 -0.6433333 -0.11
76       -0.12 -0.2466667  0.3566667 -0.11
77       -0.12 -0.2466667  0.3566667 -0.11
78       -0.12 -0.2466667  0.3566667 -0.11
79       -0.12 -0.2466667  0.3566667 -0.11
80       -0.12 -0.2466667  0.3566667 -0.11
81       -0.12  0.7533333 -0.6433333 -0.11
82        0.88 -0.2466667  0.3566667 -0.11
83       -0.12 -0.2466667  0.3566667 -0.11
84       -0.12 -0.2466667  0.3566667 -0.11
85       -0.12 -0.2466667  0.3566667 -0.11
86       -0.12 -0.2466667  0.3566667 -0.11
87       -0.12 -0.2466667  0.3566667 -0.11
88       -0.12 -0.2466667  0.3566667 -0.11
89       -0.12 -0.2466667  0.3566667 -0.11
90       -0.12 -0.2466667  0.3566667 -0.11
91       -0.12  0.7533333 -0.6433333 -0.11
92       -0.12 -0.2466667  0.3566667 -0.11
93       -0.12  0.7533333 -0.6433333 -0.11
94        0.88 -0.2466667  0.3566667 -0.11
95        0.88 -0.2466667  0.3566667 -0.11
96       -0.12  0.7533333 -0.6433333 -0.11
97       -0.12 -0.2466667  0.3566667 -0.11
98       -0.12 -0.2466667  0.3566667 -0.11
99       -0.12  0.7533333 -0.6433333 -0.11
100       0.88 -0.2466667  0.3566667 -0.11
101      -0.12 -0.2466667  0.3566667 -0.11
102      -0.12 -0.2466667 -0.6433333  0.89
103      -0.12 -0.2466667  0.3566667 -0.11
104      -0.12 -0.2466667  0.3566667 -0.11
105      -0.12 -0.2466667  0.3566667 -0.11
106      -0.12 -0.2466667  0.3566667 -0.11
107      -0.12 -0.2466667  0.3566667 -0.11
108      -0.12 -0.2466667  0.3566667 -0.11
109      -0.12 -0.2466667  0.3566667 -0.11
110      -0.12 -0.2466667  0.3566667 -0.11
111      -0.12 -0.2466667  0.3566667 -0.11
112      -0.12 -0.2466667  0.3566667 -0.11
113      -0.12 -0.2466667  0.3566667 -0.11
114      -0.12 -0.2466667  0.3566667 -0.11
115      -0.12 -0.2466667  0.3566667 -0.11
116      -0.12 -0.2466667  0.3566667 -0.11
117      -0.12 -0.2466667  0.3566667 -0.11
118      -0.12 -0.2466667  0.3566667 -0.11
119      -0.12 -0.2466667  0.3566667 -0.11
120      -0.12 -0.2466667  0.3566667 -0.11
121      -0.12 -0.2466667  0.3566667 -0.11
122      -0.12 -0.2466667  0.3566667 -0.11
123      -0.12 -0.2466667  0.3566667 -0.11
124      -0.12 -0.2466667  0.3566667 -0.11
125      -0.12 -0.2466667  0.3566667 -0.11
126      -0.12 -0.2466667  0.3566667 -0.11
127      -0.12  0.7533333 -0.6433333 -0.11
128      -0.12  0.7533333 -0.6433333 -0.11
129      -0.12 -0.2466667  0.3566667 -0.11
130      -0.12 -0.2466667  0.3566667 -0.11
131      -0.12 -0.2466667  0.3566667 -0.11
132      -0.12  0.7533333 -0.6433333 -0.11
133      -0.12 -0.2466667  0.3566667 -0.11
134      -0.12  0.7533333 -0.6433333 -0.11
135      -0.12  0.7533333 -0.6433333 -0.11
136      -0.12 -0.2466667  0.3566667 -0.11
137      -0.12 -0.2466667  0.3566667 -0.11
138      -0.12 -0.2466667  0.3566667 -0.11
139      -0.12 -0.2466667  0.3566667 -0.11
140      -0.12 -0.2466667  0.3566667 -0.11
141      -0.12 -0.2466667  0.3566667 -0.11
142      -0.12 -0.2466667  0.3566667 -0.11
143      -0.12 -0.2466667  0.3566667 -0.11
144      -0.12 -0.2466667  0.3566667 -0.11
145      -0.12 -0.2466667  0.3566667 -0.11
146      -0.12 -0.2466667  0.3566667 -0.11
147      -0.12 -0.2466667  0.3566667 -0.11
148      -0.12  0.7533333 -0.6433333 -0.11
149      -0.12 -0.2466667  0.3566667 -0.11
150      -0.12 -0.2466667  0.3566667 -0.11
151      -0.12  0.7533333 -0.6433333 -0.11
152      -0.12 -0.2466667  0.3566667 -0.11
153       0.88  0.7533333 -0.6433333 -0.11
154      -0.12 -0.2466667 -0.6433333  0.89
155      -0.12 -0.2466667  0.3566667 -0.11
156      -0.12  0.7533333 -0.6433333 -0.11
157      -0.12 -0.2466667  0.3566667 -0.11
158      -0.12 -0.2466667  0.3566667 -0.11
159       0.88  0.7533333 -0.6433333 -0.11
160      -0.12  0.7533333 -0.6433333 -0.11
161       0.88  0.7533333 -0.6433333 -0.11
162      -0.12  0.7533333 -0.6433333 -0.11
163      -0.12 -0.2466667 -0.6433333  0.89
164      -0.12  0.7533333 -0.6433333 -0.11
165       0.88 -0.2466667 -0.6433333  0.89
166      -0.12 -0.2466667  0.3566667 -0.11
167      -0.12 -0.2466667 -0.6433333  0.89
168       0.88  0.7533333 -0.6433333 -0.11
169      -0.12 -0.2466667  0.3566667 -0.11
170      -0.12 -0.2466667  0.3566667 -0.11
171       0.88 -0.2466667  0.3566667 -0.11
172      -0.12 -0.2466667  0.3566667 -0.11
173      -0.12  0.7533333 -0.6433333 -0.11
174      -0.12 -0.2466667  0.3566667 -0.11
175      -0.12 -0.2466667  0.3566667 -0.11
176      -0.12 -0.2466667  0.3566667 -0.11
177      -0.12 -0.2466667  0.3566667 -0.11
178      -0.12 -0.2466667  0.3566667 -0.11
179      -0.12 -0.2466667  0.3566667 -0.11
180      -0.12 -0.2466667 -0.6433333  0.89
181      -0.12  0.7533333 -0.6433333 -0.11
182       0.88  0.7533333 -0.6433333 -0.11
183      -0.12  0.7533333 -0.6433333 -0.11
184      -0.12 -0.2466667  0.3566667 -0.11
185      -0.12 -0.2466667  0.3566667 -0.11
186      -0.12 -0.2466667 -0.6433333  0.89
187      -0.12 -0.2466667 -0.6433333  0.89
188      -0.12 -0.2466667 -0.6433333  0.89
189      -0.12 -0.2466667 -0.6433333  0.89
190       0.88 -0.2466667 -0.6433333  0.89
191      -0.12 -0.2466667  0.3566667 -0.11
192      -0.12 -0.2466667  0.3566667 -0.11
193      -0.12 -0.2466667  0.3566667 -0.11
194      -0.12 -0.2466667  0.3566667 -0.11
195       0.88 -0.2466667 -0.6433333  0.89
196       0.88  0.7533333 -0.6433333 -0.11
197      -0.12 -0.2466667  0.3566667 -0.11
198      -0.12 -0.2466667  0.3566667 -0.11
199      -0.12 -0.2466667 -0.6433333  0.89
200      -0.12 -0.2466667 -0.6433333  0.89
201      -0.12 -0.2466667  0.3566667 -0.11
202       0.88  0.7533333 -0.6433333 -0.11
203      -0.12 -0.2466667  0.3566667 -0.11
204      -0.12 -0.2466667  0.3566667 -0.11
205      -0.12 -0.2466667 -0.6433333  0.89
206       0.88  0.7533333 -0.6433333 -0.11
207      -0.12  0.7533333 -0.6433333 -0.11
208       0.88  0.7533333 -0.6433333 -0.11
209       0.88 -0.2466667 -0.6433333  0.89
210      -0.12 -0.2466667  0.3566667 -0.11
211       0.88  0.7533333 -0.6433333 -0.11
212      -0.12 -0.2466667 -0.6433333  0.89
213      -0.12  0.7533333 -0.6433333 -0.11
214      -0.12 -0.2466667  0.3566667 -0.11
215      -0.12 -0.2466667  0.3566667 -0.11
216      -0.12  0.7533333 -0.6433333 -0.11
217      -0.12  0.7533333 -0.6433333 -0.11
218      -0.12 -0.2466667  0.3566667 -0.11
219      -0.12 -0.2466667  0.3566667 -0.11
220       0.88 -0.2466667  0.3566667 -0.11
221      -0.12 -0.2466667  0.3566667 -0.11
222      -0.12 -0.2466667 -0.6433333  0.89
223      -0.12 -0.2466667  0.3566667 -0.11
224      -0.12 -0.2466667  0.3566667 -0.11
225      -0.12  0.7533333 -0.6433333 -0.11
226      -0.12 -0.2466667 -0.6433333  0.89
227      -0.12 -0.2466667 -0.6433333  0.89
228      -0.12  0.7533333 -0.6433333 -0.11
229       0.88 -0.2466667 -0.6433333  0.89
230      -0.12 -0.2466667  0.3566667 -0.11
231      -0.12  0.7533333 -0.6433333 -0.11
232      -0.12 -0.2466667  0.3566667 -0.11
233      -0.12 -0.2466667  0.3566667 -0.11
234      -0.12 -0.2466667  0.3566667 -0.11
235      -0.12 -0.2466667  0.3566667 -0.11
236      -0.12 -0.2466667  0.3566667 -0.11
237      -0.12 -0.2466667  0.3566667 -0.11
238       0.88 -0.2466667  0.3566667 -0.11
239      -0.12 -0.2466667  0.3566667 -0.11
240      -0.12 -0.2466667  0.3566667 -0.11
241      -0.12 -0.2466667  0.3566667 -0.11
242      -0.12 -0.2466667  0.3566667 -0.11
243      -0.12 -0.2466667 -0.6433333  0.89
244      -0.12 -0.2466667  0.3566667 -0.11
245      -0.12 -0.2466667  0.3566667 -0.11
246      -0.12 -0.2466667  0.3566667 -0.11
247      -0.12  0.7533333 -0.6433333 -0.11
248       0.88 -0.2466667  0.3566667 -0.11
249      -0.12 -0.2466667  0.3566667 -0.11
250      -0.12 -0.2466667  0.3566667 -0.11
251      -0.12 -0.2466667  0.3566667 -0.11
252      -0.12 -0.2466667  0.3566667 -0.11
253      -0.12 -0.2466667  0.3566667 -0.11
254      -0.12 -0.2466667  0.3566667 -0.11
255       0.88 -0.2466667  0.3566667 -0.11
256      -0.12  0.7533333 -0.6433333 -0.11
257      -0.12  0.7533333 -0.6433333 -0.11
258      -0.12 -0.2466667 -0.6433333  0.89
259      -0.12 -0.2466667  0.3566667 -0.11
260      -0.12 -0.2466667  0.3566667 -0.11
261       0.88  0.7533333 -0.6433333 -0.11
262      -0.12 -0.2466667 -0.6433333  0.89
263      -0.12  0.7533333 -0.6433333 -0.11
264      -0.12 -0.2466667  0.3566667 -0.11
265      -0.12 -0.2466667  0.3566667 -0.11
266      -0.12 -0.2466667  0.3566667 -0.11
267      -0.12  0.7533333 -0.6433333 -0.11
268      -0.12 -0.2466667  0.3566667 -0.11
269      -0.12  0.7533333 -0.6433333 -0.11
270      -0.12 -0.2466667  0.3566667 -0.11
271       0.88  0.7533333 -0.6433333 -0.11
272       0.88  0.7533333 -0.6433333 -0.11
273      -0.12 -0.2466667  0.3566667 -0.11
274      -0.12 -0.2466667  0.3566667 -0.11
275      -0.12  0.7533333 -0.6433333 -0.11
276      -0.12 -0.2466667  0.3566667 -0.11
277       0.88  0.7533333 -0.6433333 -0.11
278       0.88  0.7533333 -0.6433333 -0.11
279      -0.12  0.7533333 -0.6433333 -0.11
280      -0.12 -0.2466667  0.3566667 -0.11
281      -0.12 -0.2466667  0.3566667 -0.11
282      -0.12 -0.2466667  0.3566667 -0.11
283      -0.12 -0.2466667  0.3566667 -0.11
284      -0.12  0.7533333 -0.6433333 -0.11
285      -0.12 -0.2466667  0.3566667 -0.11
286      -0.12 -0.2466667  0.3566667 -0.11
287       0.88 -0.2466667  0.3566667 -0.11
288      -0.12  0.7533333 -0.6433333 -0.11
289      -0.12 -0.2466667  0.3566667 -0.11
290      -0.12 -0.2466667  0.3566667 -0.11
291      -0.12 -0.2466667  0.3566667 -0.11
292      -0.12 -0.2466667  0.3566667 -0.11
293      -0.12 -0.2466667  0.3566667 -0.11
294      -0.12 -0.2466667  0.3566667 -0.11
295      -0.12 -0.2466667  0.3566667 -0.11
296      -0.12 -0.2466667 -0.6433333  0.89
297      -0.12 -0.2466667 -0.6433333  0.89
298      -0.12 -0.2466667  0.3566667 -0.11
299      -0.12  0.7533333 -0.6433333 -0.11
300      -0.12  0.7533333 -0.6433333 -0.11</code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>    Z <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">t</span>(G) <span class="sc">-</span> plxk)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># SVD of Z</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>    u_til <span class="ot">&lt;-</span> <span class="fu">svd</span>(Z)<span class="sc">$</span>u</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>    lambda_til <span class="ot">&lt;-</span> <span class="fu">svd</span>(Z)<span class="sc">$</span>d</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Principal Compoent Scores (factor coordinates of the rows)</span></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>    u_til[, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>] <span class="sc">%*%</span> <span class="fu">diag</span>(lambda_til[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               [,1]       [,2]         [,3]
  [1,] -0.613096145 -0.9538928  0.120541074
  [2,] -0.613096145 -0.9538928  0.120541074
  [3,] -0.744174103  0.3861053 -0.009621709
  [4,] -0.744174103  0.3861053 -0.009621709
  [5,] -0.744174103  0.3861053 -0.009621709
  [6,] -0.744174103  0.3861053 -0.009621709
  [7,] -0.744174103  0.3861053 -0.009621709
  [8,] -0.613096145 -0.9538928  0.120541074
  [9,]  1.216425166  0.6443304  0.164938880
 [10,]  1.347503124 -0.6956677  0.295101663
 [11,] -0.744174103  0.3861053 -0.009621709
 [12,] -0.744174103  0.3861053 -0.009621709
 [13,]  1.216425166  0.6443304  0.164938880
 [14,] -0.613096145 -0.9538928  0.120541074
 [15,]  0.328572730 -0.7268964 -0.484310700
 [16,]  0.863719636  0.4129066 -0.882496815
 [17,]  1.347503124 -0.6956677  0.295101663
 [18,]  0.197494772  0.6131018 -0.614473483
 [19,] -0.613096145 -0.9538928  0.120541074
 [20,] -0.613096145 -0.9538928  0.120541074
 [21,]  0.197494772  0.6131018 -0.614473483
 [22,]  1.347503124 -0.6956677  0.295101663
 [23,] -0.744174103  0.3861053 -0.009621709
 [24,] -0.613096145 -0.9538928  0.120541074
 [25,]  0.863719636  0.4129066 -0.882496815
 [26,]  0.197494772  0.6131018 -0.614473483
 [27,] -0.744174103  0.3861053 -0.009621709
 [28,]  0.274756291  0.4173340  0.769790654
 [29,] -0.613096145 -0.9538928  0.120541074
 [30,] -0.744174103  0.3861053 -0.009621709
 [31,]  0.530060157  0.1605672 -1.149342708
 [32,]  1.216425166  0.6443304  0.164938880
 [33,]  1.216425166  0.6443304  0.164938880
 [34,] -0.613096145 -0.9538928  0.120541074
 [35,]  1.347503124 -0.6956677  0.295101663
 [36,] -0.744174103  0.3861053 -0.009621709
 [37,]  0.338345859 -0.4719277  0.859727411
 [38,] -0.680584535 -0.5031564  0.080315048
 [39,]  0.197494772  0.6131018 -0.614473483
 [40,]  1.280014734 -0.2449313  0.254875636
 [41,] -0.744174103  0.3861053 -0.009621709
 [42,] -0.680584535 -0.5031564  0.080315048
 [43,] -0.744174103  0.3861053 -0.009621709
 [44,]  0.328572730 -0.7268964 -0.484310700
 [45,] -0.744174103  0.3861053 -0.009621709
 [46,] -0.744174103  0.3861053 -0.009621709
 [47,] -0.744174103  0.3861053 -0.009621709
 [48,]  1.216425166  0.6443304  0.164938880
 [49,]  0.274756291  0.4173340  0.769790654
 [50,]  1.347503124 -0.6956677  0.295101663
 [51,]  1.216425166  0.6443304  0.164938880
 [52,]  0.405834249 -0.9226642  0.899953437
 [53,]  0.530060157  0.1605672 -1.149342708
 [54,] -0.744174103  0.3861053 -0.009621709
 [55,] -0.680584535 -0.5031564  0.080315048
 [56,]  0.274756291  0.4173340  0.769790654
 [57,] -0.680584535 -0.5031564  0.080315048
 [58,]  1.216425166  0.6443304  0.164938880
 [59,]  1.280014734 -0.2449313  0.254875636
 [60,]  0.405834249 -0.9226642  0.899953437
 [61,]  1.216425166  0.6443304  0.164938880
 [62,]  0.530060157  0.1605672 -1.149342708
 [63,] -0.744174103  0.3861053 -0.009621709
 [64,]  0.328572730 -0.7268964 -0.484310700
 [65,]  0.274756291  0.4173340  0.769790654
 [66,]  1.347503124 -0.6956677  0.295101663
 [67,]  1.216425166  0.6443304  0.164938880
 [68,]  1.216425166  0.6443304  0.164938880
 [69,] -0.744174103  0.3861053 -0.009621709
 [70,] -0.744174103  0.3861053 -0.009621709
 [71,] -0.744174103  0.3861053 -0.009621709
 [72,]  1.216425166  0.6443304  0.164938880
 [73,] -0.744174103  0.3861053 -0.009621709
 [74,]  0.530060157  0.1605672 -1.149342708
 [75,] -0.613096145 -0.9538928  0.120541074
 [76,] -0.744174103  0.3861053 -0.009621709
 [77,] -0.744174103  0.3861053 -0.009621709
 [78,]  0.274756291  0.4173340  0.769790654
 [79,] -0.136164706  0.3607624 -0.881319377
 [80,]  0.274756291  0.4173340  0.769790654
 [81,] -0.613096145 -0.9538928  0.120541074
 [82,] -0.077949240  0.1859101 -0.277645040
 [83,]  0.197494772  0.6131018 -0.614473483
 [84,] -0.744174103  0.3861053 -0.009621709
 [85,] -0.744174103  0.3861053 -0.009621709
 [86,] -0.744174103  0.3861053 -0.009621709
 [87,]  1.216425166  0.6443304  0.164938880
 [88,] -0.744174103  0.3861053 -0.009621709
 [89,]  0.197494772  0.6131018 -0.614473483
 [90,]  0.274756291  0.4173340  0.769790654
 [91,]  0.405834249 -0.9226642  0.899953437
 [92,]  0.274756291  0.4173340  0.769790654
 [93,] -0.613096145 -0.9538928  0.120541074
 [94,] -0.077949240  0.1859101 -0.277645040
 [95,]  0.530060157  0.1605672 -1.149342708
 [96,]  0.405834249 -0.9226642  0.899953437
 [97,] -0.744174103  0.3861053 -0.009621709
 [98,] -0.744174103  0.3861053 -0.009621709
 [99,]  1.347503124 -0.6956677  0.295101663
[100,]  0.530060157  0.1605672 -1.149342708
[101,] -0.744174103  0.3861053 -0.009621709
[102,]  0.338345859 -0.4719277  0.859727411
[103,]  1.216425166  0.6443304  0.164938880
[104,] -0.744174103  0.3861053 -0.009621709
[105,] -0.744174103  0.3861053 -0.009621709
[106,] -0.744174103  0.3861053 -0.009621709
[107,] -0.744174103  0.3861053 -0.009621709
[108,]  0.274756291  0.4173340  0.769790654
[109,]  0.197494772  0.6131018 -0.614473483
[110,]  0.882765688  0.3919911 -0.101907014
[111,] -0.744174103  0.3861053 -0.009621709
[112,]  1.216425166  0.6443304  0.164938880
[113,]  0.197494772  0.6131018 -0.614473483
[114,] -0.744174103  0.3861053 -0.009621709
[115,] -0.744174103  0.3861053 -0.009621709
[116,] -0.744174103  0.3861053 -0.009621709
[117,] -0.744174103  0.3861053 -0.009621709
[118,] -0.744174103  0.3861053 -0.009621709
[119,]  0.274756291  0.4173340  0.769790654
[120,]  0.197494772  0.6131018 -0.614473483
[121,] -0.744174103  0.3861053 -0.009621709
[122,]  1.216425166  0.6443304  0.164938880
[123,] -0.744174103  0.3861053 -0.009621709
[124,] -0.744174103  0.3861053 -0.009621709
[125,] -0.744174103  0.3861053 -0.009621709
[126,] -0.744174103  0.3861053 -0.009621709
[127,]  1.347503124 -0.6956677  0.295101663
[128,]  0.405834249 -0.9226642  0.899953437
[129,] -0.744174103  0.3861053 -0.009621709
[130,] -0.744174103  0.3861053 -0.009621709
[131,] -0.744174103  0.3861053 -0.009621709
[132,] -0.613096145 -0.9538928  0.120541074
[133,]  1.216425166  0.6443304  0.164938880
[134,] -0.613096145 -0.9538928  0.120541074
[135,] -0.613096145 -0.9538928  0.120541074
[136,]  0.197494772  0.6131018 -0.614473483
[137,] -0.744174103  0.3861053 -0.009621709
[138,] -0.744174103  0.3861053 -0.009621709
[139,] -0.744174103  0.3861053 -0.009621709
[140,] -0.744174103  0.3861053 -0.009621709
[141,] -0.744174103  0.3861053 -0.009621709
[142,] -0.744174103  0.3861053 -0.009621709
[143,] -0.744174103  0.3861053 -0.009621709
[144,] -0.744174103  0.3861053 -0.009621709
[145,] -0.744174103  0.3861053 -0.009621709
[146,] -0.744174103  0.3861053 -0.009621709
[147,] -0.744174103  0.3861053 -0.009621709
[148,]  0.328572730 -0.7268964 -0.484310700
[149,] -0.136164706  0.3607624 -0.881319377
[150,] -0.744174103  0.3861053 -0.009621709
[151,]  0.405834249 -0.9226642  0.899953437
[152,] -0.744174103  0.3861053 -0.009621709
[153,]  0.053128719 -1.1540881 -0.147482257
[154,] -0.680584535 -0.5031564  0.080315048
[155,] -0.744174103  0.3861053 -0.009621709
[156,] -0.613096145 -0.9538928  0.120541074
[157,] -0.744174103  0.3861053 -0.009621709
[158,] -0.744174103  0.3861053 -0.009621709
[159,]  0.994797594 -0.9270916 -0.752334032
[160,]  0.328572730 -0.7268964 -0.484310700
[161,]  0.053128719 -1.1540881 -0.147482257
[162,] -0.613096145 -0.9538928  0.120541074
[163,]  0.338345859 -0.4719277  0.859727411
[164,]  0.405834249 -0.9226642  0.899953437
[165,] -0.014359672 -0.7033516 -0.187708284
[166,] -0.744174103  0.3861053 -0.009621709
[167,] -0.680584535 -0.5031564  0.080315048
[168,]  0.661138116 -1.1794310 -1.019179925
[169,] -0.744174103  0.3861053 -0.009621709
[170,] -0.744174103  0.3861053 -0.009621709
[171,]  0.863719636  0.4129066 -0.882496815
[172,]  1.216425166  0.6443304  0.164938880
[173,]  0.405834249 -0.9226642  0.899953437
[174,] -0.744174103  0.3861053 -0.009621709
[175,] -0.744174103  0.3861053 -0.009621709
[176,] -0.744174103  0.3861053 -0.009621709
[177,] -0.744174103  0.3861053 -0.009621709
[178,]  0.274756291  0.4173340  0.769790654
[179,] -0.744174103  0.3861053 -0.009621709
[180,]  0.338345859 -0.4719277  0.859727411
[181,] -0.613096145 -0.9538928  0.120541074
[182,]  0.661138116 -1.1794310 -1.019179925
[183,] -0.613096145 -0.9538928  0.120541074
[184,] -0.744174103  0.3861053 -0.009621709
[185,]  0.274756291  0.4173340  0.769790654
[186,] -0.680584535 -0.5031564  0.080315048
[187,] -0.680584535 -0.5031564  0.080315048
[188,] -0.680584535 -0.5031564  0.080315048
[189,]  0.338345859 -0.4719277  0.859727411
[190,]  0.593649725 -0.7286945 -1.059405952
[191,]  0.882765688  0.3919911 -0.101907014
[192,]  0.274756291  0.4173340  0.769790654
[193,] -0.744174103  0.3861053 -0.009621709
[194,]  0.274756291  0.4173340  0.769790654
[195,]  0.593649725 -0.7286945 -1.059405952
[196,]  0.053128719 -1.1540881 -0.147482257
[197,] -0.744174103  0.3861053 -0.009621709
[198,]  0.197494772  0.6131018 -0.614473483
[199,] -0.072575138 -0.5284993 -0.791382620
[200,] -0.680584535 -0.5031564  0.080315048
[201,]  1.216425166  0.6443304  0.164938880
[202,]  0.661138116 -1.1794310 -1.019179925
[203,]  1.216425166  0.6443304  0.164938880
[204,] -0.744174103  0.3861053 -0.009621709
[205,] -0.680584535 -0.5031564  0.080315048
[206,]  0.053128719 -1.1540881 -0.147482257
[207,]  1.347503124 -0.6956677  0.295101663
[208,]  0.661138116 -1.1794310 -1.019179925
[209,] -0.014359672 -0.7033516 -0.187708284
[210,] -0.744174103  0.3861053 -0.009621709
[211,]  0.661138116 -1.1794310 -1.019179925
[212,] -0.072575138 -0.5284993 -0.791382620
[213,] -0.613096145 -0.9538928  0.120541074
[214,]  0.197494772  0.6131018 -0.614473483
[215,] -0.744174103  0.3861053 -0.009621709
[216,] -0.613096145 -0.9538928  0.120541074
[217,]  0.405834249 -0.9226642  0.899953437
[218,] -0.744174103  0.3861053 -0.009621709
[219,] -0.744174103  0.3861053 -0.009621709
[220,]  0.530060157  0.1605672 -1.149342708
[221,]  0.274756291  0.4173340  0.769790654
[222,]  0.946355256 -0.4972707 -0.011970257
[223,] -0.744174103  0.3861053 -0.009621709
[224,]  1.216425166  0.6443304  0.164938880
[225,]  1.347503124 -0.6956677  0.295101663
[226,] -0.680584535 -0.5031564  0.080315048
[227,]  0.946355256 -0.4972707 -0.011970257
[228,] -0.613096145 -0.9538928  0.120541074
[229,]  0.593649725 -0.7286945 -1.059405952
[230,] -0.744174103  0.3861053 -0.009621709
[231,]  0.405834249 -0.9226642  0.899953437
[232,] -0.744174103  0.3861053 -0.009621709
[233,]  1.216425166  0.6443304  0.164938880
[234,]  1.216425166  0.6443304  0.164938880
[235,]  0.274756291  0.4173340  0.769790654
[236,] -0.744174103  0.3861053 -0.009621709
[237,] -0.744174103  0.3861053 -0.009621709
[238,]  0.863719636  0.4129066 -0.882496815
[239,]  0.197494772  0.6131018 -0.614473483
[240,]  1.216425166  0.6443304  0.164938880
[241,]  1.216425166  0.6443304  0.164938880
[242,]  0.274756291  0.4173340  0.769790654
[243,]  1.280014734 -0.2449313  0.254875636
[244,]  1.216425166  0.6443304  0.164938880
[245,] -0.744174103  0.3861053 -0.009621709
[246,]  1.216425166  0.6443304  0.164938880
[247,] -0.613096145 -0.9538928  0.120541074
[248,]  0.530060157  0.1605672 -1.149342708
[249,]  0.882765688  0.3919911 -0.101907014
[250,] -0.744174103  0.3861053 -0.009621709
[251,]  1.216425166  0.6443304  0.164938880
[252,]  1.216425166  0.6443304  0.164938880
[253,]  1.216425166  0.6443304  0.164938880
[254,] -0.744174103  0.3861053 -0.009621709
[255,] -0.077949240  0.1859101 -0.277645040
[256,] -0.613096145 -0.9538928  0.120541074
[257,] -0.613096145 -0.9538928  0.120541074
[258,] -0.680584535 -0.5031564  0.080315048
[259,]  1.216425166  0.6443304  0.164938880
[260,]  0.274756291  0.4173340  0.769790654
[261,]  0.661138116 -1.1794310 -1.019179925
[262,] -0.680584535 -0.5031564  0.080315048
[263,] -0.613096145 -0.9538928  0.120541074
[264,]  1.216425166  0.6443304  0.164938880
[265,]  1.216425166  0.6443304  0.164938880
[266,]  0.274756291  0.4173340  0.769790654
[267,]  0.405834249 -0.9226642  0.899953437
[268,]  1.216425166  0.6443304  0.164938880
[269,]  1.347503124 -0.6956677  0.295101663
[270,]  1.216425166  0.6443304  0.164938880
[271,]  0.994797594 -0.9270916 -0.752334032
[272,]  0.661138116 -1.1794310 -1.019179925
[273,]  1.216425166  0.6443304  0.164938880
[274,] -0.744174103  0.3861053 -0.009621709
[275,] -0.613096145 -0.9538928  0.120541074
[276,] -0.744174103  0.3861053 -0.009621709
[277,]  0.994797594 -0.9270916 -0.752334032
[278,]  0.994797594 -0.9270916 -0.752334032
[279,]  0.405834249 -0.9226642  0.899953437
[280,] -0.744174103  0.3861053 -0.009621709
[281,] -0.744174103  0.3861053 -0.009621709
[282,] -0.744174103  0.3861053 -0.009621709
[283,]  1.216425166  0.6443304  0.164938880
[284,] -0.613096145 -0.9538928  0.120541074
[285,] -0.744174103  0.3861053 -0.009621709
[286,] -0.744174103  0.3861053 -0.009621709
[287,]  0.530060157  0.1605672 -1.149342708
[288,] -0.613096145 -0.9538928  0.120541074
[289,]  0.197494772  0.6131018 -0.614473483
[290,] -0.744174103  0.3861053 -0.009621709
[291,]  0.274756291  0.4173340  0.769790654
[292,] -0.744174103  0.3861053 -0.009621709
[293,] -0.744174103  0.3861053 -0.009621709
[294,] -0.744174103  0.3861053 -0.009621709
[295,]  1.216425166  0.6443304  0.164938880
[296,] -0.680584535 -0.5031564  0.080315048
[297,]  0.946355256 -0.4972707 -0.011970257
[298,] -0.744174103  0.3861053 -0.009621709
[299,] -0.005086748 -0.9792358 -0.751156594
[300,] -0.613096145 -0.9538928  0.120541074</code></pre>
</div>
</div>
</section>
<section id="tldr-just-give-me-the-code" class="level1">
<h1>TL;DR, just give me the code!</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Object: Performing Multiple Correspondance Analysis in R </span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="do">### Source: Practical Guide to Principal Component Methods </span></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="do">###         (Chapter 5 Code)</span></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Packages</span></span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(<span class="st">"FactoMineR"</span>) <span class="co"># for analysis</span></span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(<span class="st">"factoextra"</span>) <span class="co"># for visualizarion1</span></span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   library("httpg")</span></span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Data Prep ---------------------------------------------------------------</span></span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data</span>(<span class="st">"poison"</span>)</span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(poison[, <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>], <span class="dv">3</span>) <span class="co"># survey style data</span></span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb118-15"><a href="#cb118-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset active individuals and variables</span></span>
<span id="cb118-16"><a href="#cb118-16" aria-hidden="true" tabindex="-1"></a>  poison.active <span class="ot">&lt;-</span> poison[<span class="dv">1</span><span class="sc">:</span><span class="dv">55</span>, <span class="dv">5</span><span class="sc">:</span><span class="dv">15</span>] </span>
<span id="cb118-17"><a href="#cb118-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(poison.active[, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>], <span class="dv">3</span>)</span>
<span id="cb118-18"><a href="#cb118-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb118-19"><a href="#cb118-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Summaries</span></span>
<span id="cb118-20"><a href="#cb118-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str</span>(poison.active)</span>
<span id="cb118-21"><a href="#cb118-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb118-22"><a href="#cb118-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(poison.active[,i], <span class="at">main=</span><span class="fu">colnames</span>(poison.active)[i],</span>
<span id="cb118-23"><a href="#cb118-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylab =</span> <span class="st">"Count"</span>, <span class="at">col=</span><span class="st">"steelblue"</span>, <span class="at">las =</span> <span class="dv">2</span>)</span>
<span id="cb118-24"><a href="#cb118-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb118-25"><a href="#cb118-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb118-26"><a href="#cb118-26" aria-hidden="true" tabindex="-1"></a><span class="co"># The analysis ------------------------------------------------------------</span></span>
<span id="cb118-27"><a href="#cb118-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb118-28"><a href="#cb118-28" aria-hidden="true" tabindex="-1"></a>  res.mca <span class="ot">&lt;-</span> FactoMineR<span class="sc">::</span><span class="fu">MCA</span>(<span class="at">X =</span> poison.active,</span>
<span id="cb118-29"><a href="#cb118-29" aria-hidden="true" tabindex="-1"></a>                             <span class="at">ncp =</span> <span class="dv">5</span>,</span>
<span id="cb118-30"><a href="#cb118-30" aria-hidden="true" tabindex="-1"></a>                             <span class="at">graph =</span> <span class="cn">TRUE</span>)</span>
<span id="cb118-31"><a href="#cb118-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-32"><a href="#cb118-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization -----------------------------------------------------------</span></span>
<span id="cb118-33"><a href="#cb118-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-34"><a href="#cb118-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Eigenvalues / Variances</span></span>
<span id="cb118-35"><a href="#cb118-35" aria-hidden="true" tabindex="-1"></a>  eig.val <span class="ot">&lt;-</span> <span class="fu">get_eigenvalue</span>(res.mca)</span>
<span id="cb118-36"><a href="#cb118-36" aria-hidden="true" tabindex="-1"></a>  eig.val <span class="co"># proportion of variances retained by dimensions</span></span>
<span id="cb118-37"><a href="#cb118-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb118-38"><a href="#cb118-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Percentages of Inertia explained by MCA</span></span>
<span id="cb118-39"><a href="#cb118-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fviz_screeplot</span>(res.mca, <span class="at">addlabels =</span> <span class="cn">TRUE</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">45</span>))</span>
<span id="cb118-40"><a href="#cb118-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb118-41"><a href="#cb118-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Biplot</span></span>
<span id="cb118-42"><a href="#cb118-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fviz_mca_biplot</span>(res.mca,</span>
<span id="cb118-43"><a href="#cb118-43" aria-hidden="true" tabindex="-1"></a>                  <span class="at">repel =</span> <span class="cn">TRUE</span>, <span class="co"># avoid text overlapping</span></span>
<span id="cb118-44"><a href="#cb118-44" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ggtheme =</span> <span class="fu">theme_minimal</span>())</span>
<span id="cb118-45"><a href="#cb118-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Rows (individuals) are represented by blue points;</span></span>
<span id="cb118-46"><a href="#cb118-46" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Columns (variable categories) by red triangles.</span></span>
<span id="cb118-47"><a href="#cb118-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb118-48"><a href="#cb118-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Graph of variables</span></span>
<span id="cb118-49"><a href="#cb118-49" aria-hidden="true" tabindex="-1"></a>  var <span class="ot">&lt;-</span> <span class="fu">get_mca_var</span>(res.mca) </span>
<span id="cb118-50"><a href="#cb118-50" aria-hidden="true" tabindex="-1"></a>  var</span>
<span id="cb118-51"><a href="#cb118-51" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Coordinates </span></span>
<span id="cb118-52"><a href="#cb118-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(var<span class="sc">$</span>coord)</span>
<span id="cb118-53"><a href="#cb118-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Cos2: quality on the factore map </span></span>
<span id="cb118-54"><a href="#cb118-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(var<span class="sc">$</span>cos2)</span>
<span id="cb118-55"><a href="#cb118-55" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Contributions to the principal components</span></span>
<span id="cb118-56"><a href="#cb118-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(var<span class="sc">$</span>contrib)</span>
<span id="cb118-57"><a href="#cb118-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb118-58"><a href="#cb118-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Graph of individuals</span></span>
<span id="cb118-59"><a href="#cb118-59" aria-hidden="true" tabindex="-1"></a>  ind <span class="ot">&lt;-</span> <span class="fu">get_mca_ind</span>(res.mca) <span class="co"># extract the results for individuals</span></span>
<span id="cb118-60"><a href="#cb118-60" aria-hidden="true" tabindex="-1"></a>  ind</span>
<span id="cb118-61"><a href="#cb118-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Coordinates of column points</span></span>
<span id="cb118-62"><a href="#cb118-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(ind<span class="sc">$</span>coord)</span>
<span id="cb118-63"><a href="#cb118-63" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Quality of representation</span></span>
<span id="cb118-64"><a href="#cb118-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(ind<span class="sc">$</span>cos2)</span>
<span id="cb118-65"><a href="#cb118-65" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Contributions</span></span>
<span id="cb118-66"><a href="#cb118-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(ind<span class="sc">$</span>contrib)</span>
<span id="cb118-67"><a href="#cb118-67" aria-hidden="true" tabindex="-1"></a>  <span class="co"># BIplot for individuals only (no vars)</span></span>
<span id="cb118-68"><a href="#cb118-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fviz_mca_ind</span>(res.mca, <span class="at">col.ind =</span> <span class="st">"cos2"</span>,</span>
<span id="cb118-69"><a href="#cb118-69" aria-hidden="true" tabindex="-1"></a>               <span class="at">gradient.cols =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"#FC4E07"</span>),</span>
<span id="cb118-70"><a href="#cb118-70" aria-hidden="true" tabindex="-1"></a>               <span class="at">repel =</span> <span class="cn">TRUE</span>, <span class="at">ggtheme =</span> <span class="fu">theme_minimal</span>())</span>
<span id="cb118-71"><a href="#cb118-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fviz_mca_ind</span>(res.mca, </span>
<span id="cb118-72"><a href="#cb118-72" aria-hidden="true" tabindex="-1"></a>               <span class="at">label =</span> <span class="st">"none"</span>,</span>
<span id="cb118-73"><a href="#cb118-73" aria-hidden="true" tabindex="-1"></a>               <span class="at">habillage =</span> <span class="st">"Vomiting"</span>, <span class="co"># color by groups defined by variable</span></span>
<span id="cb118-74"><a href="#cb118-74" aria-hidden="true" tabindex="-1"></a>               <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>),</span>
<span id="cb118-75"><a href="#cb118-75" aria-hidden="true" tabindex="-1"></a>               <span class="at">addEllipses =</span> <span class="cn">TRUE</span>, <span class="at">ellipse.type =</span> <span class="st">"confidence"</span>,</span>
<span id="cb118-76"><a href="#cb118-76" aria-hidden="true" tabindex="-1"></a>               <span class="at">repel =</span> <span class="cn">TRUE</span>, <span class="at">ggtheme =</span> <span class="fu">theme_minimal</span>())</span>
<span id="cb118-77"><a href="#cb118-77" aria-hidden="true" tabindex="-1"></a>  <span class="co"># More than 1 grouping variable</span></span>
<span id="cb118-78"><a href="#cb118-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fviz_ellipses</span>(res.mca, <span class="fu">c</span>(<span class="st">"Vomiting"</span>, <span class="st">"Fever"</span>),</span>
<span id="cb118-79"><a href="#cb118-79" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom =</span> <span class="st">"point"</span>)</span>
<span id="cb118-80"><a href="#cb118-80" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Bar plot for Cos2 of individuals </span></span>
<span id="cb118-81"><a href="#cb118-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fviz_cos2</span>(res.mca, <span class="at">choice =</span> <span class="st">"ind"</span>, <span class="at">axes =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">top =</span> <span class="dv">20</span>)</span>
<span id="cb118-82"><a href="#cb118-82" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Contribution of individuals to the dimensions </span></span>
<span id="cb118-83"><a href="#cb118-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fviz_contrib</span>(res.mca, <span class="at">choice =</span> <span class="st">"ind"</span>, <span class="at">axes =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">top =</span> <span class="dv">20</span>)</span>
<span id="cb118-84"><a href="#cb118-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-85"><a href="#cb118-85" aria-hidden="true" tabindex="-1"></a><span class="co"># Supplementary elements --------------------------------------------------</span></span>
<span id="cb118-86"><a href="#cb118-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-87"><a href="#cb118-87" aria-hidden="true" tabindex="-1"></a><span class="co">#   res.mca &lt;- MCA(poison, </span></span>
<span id="cb118-88"><a href="#cb118-88" aria-hidden="true" tabindex="-1"></a><span class="co">#                  ind.sup = 53:55)</span></span>
<span id="cb118-89"><a href="#cb118-89" aria-hidden="true" tabindex="-1"></a><span class="co">#   ind &lt;- get_mca_ind(res.mca)</span></span>
<span id="cb118-90"><a href="#cb118-90" aria-hidden="true" tabindex="-1"></a><span class="co">#   ind$coord</span></span>
<span id="cb118-91"><a href="#cb118-91" aria-hidden="true" tabindex="-1"></a><span class="co">#   res.mca$ind.sup # Supplementary individuals </span></span>
<span id="cb118-92"><a href="#cb118-92" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb118-93"><a href="#cb118-93" aria-hidden="true" tabindex="-1"></a><span class="co"># Doing it by hand --------------------------------------------------------</span></span>
<span id="cb118-94"><a href="#cb118-94" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb118-95"><a href="#cb118-95" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Data</span></span>
<span id="cb118-96"><a href="#cb118-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data</span>(wine)</span>
<span id="cb118-97"><a href="#cb118-97" aria-hidden="true" tabindex="-1"></a>  MCA.dt <span class="ot">&lt;-</span> wine[, <span class="fu">sapply</span>(wine, is.factor)]</span>
<span id="cb118-98"><a href="#cb118-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sapply</span>(MCA.dt, nlevels)</span>
<span id="cb118-99"><a href="#cb118-99" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb118-100"><a href="#cb118-100" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Goal: Find the coordinates of </span></span>
<span id="cb118-101"><a href="#cb118-101" aria-hidden="true" tabindex="-1"></a>  npcs <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb118-102"><a href="#cb118-102" aria-hidden="true" tabindex="-1"></a>  res.mca <span class="ot">&lt;-</span> FactoMineR<span class="sc">::</span><span class="fu">MCA</span>(<span class="at">X =</span> MCA.dt, <span class="at">ncp =</span> npcs, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span>
<span id="cb118-103"><a href="#cb118-103" aria-hidden="true" tabindex="-1"></a>  res.mca<span class="sc">$</span>ind<span class="sc">$</span>coord <span class="co"># Coordinates of the individuals on the dimensions</span></span>
<span id="cb118-104"><a href="#cb118-104" aria-hidden="true" tabindex="-1"></a>  res.mca<span class="sc">$</span>svd<span class="sc">$</span>V</span>
<span id="cb118-105"><a href="#cb118-105" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb118-106"><a href="#cb118-106" aria-hidden="true" tabindex="-1"></a><span class="co"># Following AudigierEtAl2016_MICAT ----------------------------------------</span></span>
<span id="cb118-107"><a href="#cb118-107" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb118-108"><a href="#cb118-108" aria-hidden="true" tabindex="-1"></a>  I <span class="ot">&lt;-</span> <span class="fu">nrow</span>(MCA.dt)     <span class="co"># numebr of individuals</span></span>
<span id="cb118-109"><a href="#cb118-109" aria-hidden="true" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">ncol</span>(MCA.dt)     <span class="co"># number of categorical predictors</span></span>
<span id="cb118-110"><a href="#cb118-110" aria-hidden="true" tabindex="-1"></a>  qk <span class="ot">&lt;-</span> <span class="fu">sapply</span>(MCA.dt,  <span class="co"># number of levels per categorical variable </span></span>
<span id="cb118-111"><a href="#cb118-111" aria-hidden="true" tabindex="-1"></a>               nlevels) </span>
<span id="cb118-112"><a href="#cb118-112" aria-hidden="true" tabindex="-1"></a>  J <span class="ot">&lt;-</span> <span class="fu">sum</span>(qk)          <span class="co"># total number of categories</span></span>
<span id="cb118-113"><a href="#cb118-113" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb118-114"><a href="#cb118-114" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Disjunctive table</span></span>
<span id="cb118-115"><a href="#cb118-115" aria-hidden="true" tabindex="-1"></a>  Z <span class="ot">&lt;-</span> <span class="fu">tab.disjonctif</span>(MCA.dt)</span>
<span id="cb118-116"><a href="#cb118-116" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Notice the relationship between the disjunctive table and a </span></span>
<span id="cb118-117"><a href="#cb118-117" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&nbsp;contingency table </span></span>
<span id="cb118-118"><a href="#cb118-118" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="fu">t</span>(Z[, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]) <span class="sc">%*%</span> Z[, <span class="dv">4</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb118-119"><a href="#cb118-119" aria-hidden="true" tabindex="-1"></a>  N <span class="sc">-</span> <span class="fu">table</span>(MCA.dt)</span>
<span id="cb118-120"><a href="#cb118-120" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb118-121"><a href="#cb118-121" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Distance Metric Matrix</span></span>
<span id="cb118-122"><a href="#cb118-122" aria-hidden="true" tabindex="-1"></a>  pxkqk <span class="ot">&lt;-</span> <span class="fu">colSums</span>(Z)<span class="sc">/</span>I <span class="co"># props ids taking category value on variable</span></span>
<span id="cb118-123"><a href="#cb118-123" aria-hidden="true" tabindex="-1"></a>  D_Sigma <span class="ot">&lt;-</span> <span class="fu">diag</span>(pxkqk)</span>
<span id="cb118-124"><a href="#cb118-124" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb118-125"><a href="#cb118-125" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Weight Matrix</span></span>
<span id="cb118-126"><a href="#cb118-126" aria-hidden="true" tabindex="-1"></a>  W_mat <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="fu">rep</span>(<span class="dv">1</span>, I))<span class="sc">/</span>I</span>
<span id="cb118-127"><a href="#cb118-127" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb118-128"><a href="#cb118-128" aria-hidden="true" tabindex="-1"></a>  <span class="co"># M matrix (center matrix)</span></span>
<span id="cb118-129"><a href="#cb118-129" aria-hidden="true" tabindex="-1"></a>  M <span class="ot">&lt;-</span> <span class="fu">matrix</span>((<span class="fu">rep</span>(<span class="fu">colMeans</span>(Z), <span class="fu">nrow</span>(Z))), </span>
<span id="cb118-130"><a href="#cb118-130" aria-hidden="true" tabindex="-1"></a>              <span class="at">nrow =</span> <span class="fu">nrow</span>(Z), </span>
<span id="cb118-131"><a href="#cb118-131" aria-hidden="true" tabindex="-1"></a>              <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb118-132"><a href="#cb118-132" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb118-133"><a href="#cb118-133" aria-hidden="true" tabindex="-1"></a>  <span class="co"># SVD of triplet (Z-M, D_Sigma, W_mat)</span></span>
<span id="cb118-134"><a href="#cb118-134" aria-hidden="true" tabindex="-1"></a>  SVD.trip <span class="ot">&lt;-</span> <span class="fu">svd.triplet</span>(<span class="at">X =</span> Z <span class="sc">-</span> M,</span>
<span id="cb118-135"><a href="#cb118-135" aria-hidden="true" tabindex="-1"></a>                          <span class="at">row.w =</span> <span class="fu">diag</span>(W_mat),</span>
<span id="cb118-136"><a href="#cb118-136" aria-hidden="true" tabindex="-1"></a>                          <span class="at">col.w =</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span>K<span class="sc">*</span><span class="fu">solve</span>(D_Sigma)),</span>
<span id="cb118-137"><a href="#cb118-137" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ncp =</span> npcs)</span>
<span id="cb118-138"><a href="#cb118-138" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb118-139"><a href="#cb118-139" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Manual SVD triplet</span></span>
<span id="cb118-140"><a href="#cb118-140" aria-hidden="true" tabindex="-1"></a>  SVD.man <span class="ot">&lt;-</span> <span class="fu">svd</span>(<span class="fu">sqrt</span>(W_mat) <span class="sc">%*%</span> (Z <span class="sc">-</span> M) <span class="sc">%*%</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span>K<span class="sc">*</span><span class="fu">solve</span>(D_Sigma)))</span>
<span id="cb118-141"><a href="#cb118-141" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb118-142"><a href="#cb118-142" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert back to correct scales (according to Chaven 2017 p. 3)</span></span>
<span id="cb118-143"><a href="#cb118-143" aria-hidden="true" tabindex="-1"></a>  V.man <span class="ot">&lt;-</span> (<span class="fu">solve</span>(<span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span>K<span class="sc">*</span><span class="fu">solve</span>(D_Sigma))) <span class="sc">%*%</span> SVD.man<span class="sc">$</span>v)[, <span class="dv">1</span><span class="sc">:</span>npcs]</span>
<span id="cb118-144"><a href="#cb118-144" aria-hidden="true" tabindex="-1"></a>  U.man <span class="ot">&lt;-</span> (<span class="fu">solve</span>(<span class="fu">sqrt</span>(W_mat)) <span class="sc">%*%</span> SVD.man<span class="sc">$</span>u)[, <span class="dv">1</span><span class="sc">:</span>npcs]</span>
<span id="cb118-145"><a href="#cb118-145" aria-hidden="true" tabindex="-1"></a>  L.man <span class="ot">&lt;-</span> SVD.man<span class="sc">$</span>d[<span class="dv">1</span><span class="sc">:</span>npcs]</span>
<span id="cb118-146"><a href="#cb118-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-147"><a href="#cb118-147" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compare SVD triplet and manual SVD of weighted matrix</span></span>
<span id="cb118-148"><a href="#cb118-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="fu">abs</span>(SVD.trip<span class="sc">$</span>V) <span class="sc">-</span> <span class="fu">abs</span>(V.man), <span class="dv">5</span>)</span>
<span id="cb118-149"><a href="#cb118-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="fu">abs</span>(SVD.trip<span class="sc">$</span>U) <span class="sc">-</span> <span class="fu">abs</span>(U.man), <span class="dv">5</span>)</span>
<span id="cb118-150"><a href="#cb118-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="fu">abs</span>(SVD.trip<span class="sc">$</span>vs[<span class="dv">1</span><span class="sc">:</span>npcs]) <span class="sc">-</span> <span class="fu">abs</span>(L.man), <span class="dv">5</span>)</span>
<span id="cb118-151"><a href="#cb118-151" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb118-152"><a href="#cb118-152" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Reconstruction Formula</span></span>
<span id="cb118-153"><a href="#cb118-153" aria-hidden="true" tabindex="-1"></a>  d_hat <span class="ot">&lt;-</span> SVD.trip<span class="sc">$</span>vs[<span class="dv">1</span><span class="sc">:</span>npcs] <span class="co"># matrix of the singular values </span></span>
<span id="cb118-154"><a href="#cb118-154" aria-hidden="true" tabindex="-1"></a>                            <span class="co"># (Squared would be eigenvalues of Z)</span></span>
<span id="cb118-155"><a href="#cb118-155" aria-hidden="true" tabindex="-1"></a>  u_hat <span class="ot">&lt;-</span> SVD.trip<span class="sc">$</span>U <span class="co"># Left singular vectors matrix</span></span>
<span id="cb118-156"><a href="#cb118-156" aria-hidden="true" tabindex="-1"></a>  v_hat <span class="ot">&lt;-</span> SVD.trip<span class="sc">$</span>V <span class="co"># Right singular vectors matrix</span></span>
<span id="cb118-157"><a href="#cb118-157" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb118-158"><a href="#cb118-158" aria-hidden="true" tabindex="-1"></a>  z_hat <span class="ot">&lt;-</span> u_hat <span class="sc">%*%</span> <span class="fu">diag</span>(d_hat) <span class="sc">%*%</span> <span class="fu">t</span>(v_hat) <span class="sc">+</span> M</span>
<span id="cb118-159"><a href="#cb118-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colSums</span>(z_hat)</span>
<span id="cb118-160"><a href="#cb118-160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colSums</span>(Z)</span>
<span id="cb118-161"><a href="#cb118-161" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb118-162"><a href="#cb118-162" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compare SVD matrices</span></span>
<span id="cb118-163"><a href="#cb118-163" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Matrix of singular values</span></span>
<span id="cb118-164"><a href="#cb118-164" aria-hidden="true" tabindex="-1"></a>  res.mca<span class="sc">$</span>svd<span class="sc">$</span>vs[<span class="dv">1</span><span class="sc">:</span>npcs] <span class="sc">-</span></span>
<span id="cb118-165"><a href="#cb118-165" aria-hidden="true" tabindex="-1"></a>    d_hat[<span class="dv">1</span><span class="sc">:</span>npcs]</span>
<span id="cb118-166"><a href="#cb118-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-167"><a href="#cb118-167" aria-hidden="true" tabindex="-1"></a>  res.mca<span class="sc">$</span>svd<span class="sc">$</span>vs[<span class="dv">1</span><span class="sc">:</span>npcs] <span class="sc">-</span></span>
<span id="cb118-168"><a href="#cb118-168" aria-hidden="true" tabindex="-1"></a>    L.man</span>
<span id="cb118-169"><a href="#cb118-169" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb118-170"><a href="#cb118-170" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Left Singular Vectors Matrix</span></span>
<span id="cb118-171"><a href="#cb118-171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(</span>
<span id="cb118-172"><a href="#cb118-172" aria-hidden="true" tabindex="-1"></a>    res.mca<span class="sc">$</span>svd<span class="sc">$</span>U <span class="sc">-</span> u_hat,</span>
<span id="cb118-173"><a href="#cb118-173" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span></span>
<span id="cb118-174"><a href="#cb118-174" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb118-175"><a href="#cb118-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-176"><a href="#cb118-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(</span>
<span id="cb118-177"><a href="#cb118-177" aria-hidden="true" tabindex="-1"></a>    res.mca<span class="sc">$</span>svd<span class="sc">$</span>U <span class="sc">-</span> U.man,</span>
<span id="cb118-178"><a href="#cb118-178" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span></span>
<span id="cb118-179"><a href="#cb118-179" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb118-180"><a href="#cb118-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-181"><a href="#cb118-181" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Right Singular Vectors Matrix</span></span>
<span id="cb118-182"><a href="#cb118-182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(</span>
<span id="cb118-183"><a href="#cb118-183" aria-hidden="true" tabindex="-1"></a>    res.mca<span class="sc">$</span>svd<span class="sc">$</span>V <span class="sc">-</span></span>
<span id="cb118-184"><a href="#cb118-184" aria-hidden="true" tabindex="-1"></a>      v_hat, </span>
<span id="cb118-185"><a href="#cb118-185" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>)</span>
<span id="cb118-186"><a href="#cb118-186" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Correlation between columns</span></span>
<span id="cb118-187"><a href="#cb118-187" aria-hidden="true" tabindex="-1"></a>  <span class="co"># And look into the PCAmixdata package</span></span>
<span id="cb118-188"><a href="#cb118-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="fu">cor</span>(v_hat, res.mca<span class="sc">$</span>svd<span class="sc">$</span>V), <span class="dv">1</span>)</span>
<span id="cb118-189"><a href="#cb118-189" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb118-190"><a href="#cb118-190" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Coordinates on Dimensions are recovered</span></span>
<span id="cb118-191"><a href="#cb118-191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(</span>
<span id="cb118-192"><a href="#cb118-192" aria-hidden="true" tabindex="-1"></a>    res.mca<span class="sc">$</span>ind<span class="sc">$</span>coord <span class="sc">-</span></span>
<span id="cb118-193"><a href="#cb118-193" aria-hidden="true" tabindex="-1"></a>      u_hat <span class="sc">%*%</span> <span class="fu">diag</span>(d_hat),</span>
<span id="cb118-194"><a href="#cb118-194" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span></span>
<span id="cb118-195"><a href="#cb118-195" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb118-196"><a href="#cb118-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-197"><a href="#cb118-197" aria-hidden="true" tabindex="-1"></a><span class="co"># Following JosseHusson2016 -----------------------------------------------</span></span>
<span id="cb118-198"><a href="#cb118-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-199"><a href="#cb118-199" aria-hidden="true" tabindex="-1"></a>  I <span class="ot">&lt;-</span> <span class="fu">nrow</span>(MCA.dt)</span>
<span id="cb118-200"><a href="#cb118-200" aria-hidden="true" tabindex="-1"></a>  J <span class="ot">&lt;-</span> <span class="fu">ncol</span>(MCA.dt)</span>
<span id="cb118-201"><a href="#cb118-201" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">tab.disjonctif</span>(MCA.dt)</span>
<span id="cb118-202"><a href="#cb118-202" aria-hidden="true" tabindex="-1"></a>  rowMarg <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(X) <span class="co"># = J</span></span>
<span id="cb118-203"><a href="#cb118-203" aria-hidden="true" tabindex="-1"></a>  colMarg <span class="ot">&lt;-</span> <span class="fu">colSums</span>(X) <span class="co"># = number of ids in a category</span></span>
<span id="cb118-204"><a href="#cb118-204" aria-hidden="true" tabindex="-1"></a>  D_Sigma <span class="ot">&lt;-</span> <span class="fu">diag</span>(colMarg)</span>
<span id="cb118-205"><a href="#cb118-205" aria-hidden="true" tabindex="-1"></a>  D <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>I <span class="sc">*</span> <span class="fu">diag</span>(<span class="fu">rep</span>(<span class="dv">1</span>, I)) <span class="co"># rowMasses</span></span>
<span id="cb118-206"><a href="#cb118-206" aria-hidden="true" tabindex="-1"></a>  SVD.trip <span class="ot">&lt;-</span> <span class="fu">svd.triplet</span>(<span class="at">X =</span> <span class="fu">diag</span>(<span class="fu">rep</span>(<span class="dv">1</span>, I)) <span class="sc">%*%</span> X <span class="sc">%*%</span> <span class="fu">solve</span>(D_Sigma),</span>
<span id="cb118-207"><a href="#cb118-207" aria-hidden="true" tabindex="-1"></a>                          <span class="at">row.w =</span> <span class="fu">diag</span>( D ),</span>
<span id="cb118-208"><a href="#cb118-208" aria-hidden="true" tabindex="-1"></a>                          <span class="at">col.w =</span> <span class="fu">diag</span>( <span class="dv">1</span><span class="sc">/</span>(I<span class="sc">*</span>J)<span class="sc">*</span>D_Sigma ),</span>
<span id="cb118-209"><a href="#cb118-209" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ncp=</span><span class="dv">2</span></span>
<span id="cb118-210"><a href="#cb118-210" aria-hidden="true" tabindex="-1"></a>                          )</span>
<span id="cb118-211"><a href="#cb118-211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">svd</span>(I <span class="sc">*</span> X <span class="sc">%*%</span> <span class="fu">solve</span>(D_Sigma))</span>
<span id="cb118-212"><a href="#cb118-212" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb118-213"><a href="#cb118-213" aria-hidden="true" tabindex="-1"></a>  SVD.trip<span class="sc">$</span>vs</span>
<span id="cb118-214"><a href="#cb118-214" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(SVD.trip<span class="sc">$</span>vs[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>] <span class="sc">-</span> res.mca<span class="sc">$</span>svd<span class="sc">$</span>vs[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="dv">3</span>)</span>
<span id="cb118-215"><a href="#cb118-215" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb118-216"><a href="#cb118-216" aria-hidden="true" tabindex="-1"></a>  SVD.trip<span class="sc">$</span>U</span>
<span id="cb118-217"><a href="#cb118-217" aria-hidden="true" tabindex="-1"></a>  res.mca<span class="sc">$</span>svd<span class="sc">$</span>U</span>
<span id="cb118-218"><a href="#cb118-218" aria-hidden="true" tabindex="-1"></a><span class="co">#   round(SVD.trip$U[, 2:3] - res.mca$svd$U, 3)</span></span>
<span id="cb118-219"><a href="#cb118-219" aria-hidden="true" tabindex="-1"></a>  res.mca<span class="sc">$</span>svd<span class="sc">$</span>U</span>
<span id="cb118-220"><a href="#cb118-220" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb118-221"><a href="#cb118-221" aria-hidden="true" tabindex="-1"></a><span class="co">#   SVD.trip$V</span></span>
<span id="cb118-222"><a href="#cb118-222" aria-hidden="true" tabindex="-1"></a><span class="co">#   round(SVD.trip$V[, 2:3] - res.mca$svd$V, 3)</span></span>
<span id="cb118-223"><a href="#cb118-223" aria-hidden="true" tabindex="-1"></a><span class="co">#   res.mca$svd$V</span></span>
<span id="cb118-224"><a href="#cb118-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-225"><a href="#cb118-225" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare environment ----------------------------------------------------------</span></span>
<span id="cb118-226"><a href="#cb118-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-227"><a href="#cb118-227" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb118-228"><a href="#cb118-228" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PCAmixdata)</span>
<span id="cb118-229"><a href="#cb118-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-230"><a href="#cb118-230" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"FactoMineR"</span>)</span>
<span id="cb118-231"><a href="#cb118-231" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"factoextra"</span>)</span>
<span id="cb118-232"><a href="#cb118-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-233"><a href="#cb118-233" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(tea)</span>
<span id="cb118-234"><a href="#cb118-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-235"><a href="#cb118-235" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tea)</span>
<span id="cb118-236"><a href="#cb118-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-237"><a href="#cb118-237" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(tea[, <span class="fu">c</span>(<span class="st">"where"</span>, <span class="st">"how"</span>, <span class="st">"SPC"</span>)], nlevels)</span>
<span id="cb118-238"><a href="#cb118-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-239"><a href="#cb118-239" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(tea, nlevels)</span>
<span id="cb118-240"><a href="#cb118-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-241"><a href="#cb118-241" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> tea[, <span class="fu">c</span>(<span class="st">"where"</span>, <span class="st">"how"</span>, <span class="st">"Tea"</span>)]</span>
<span id="cb118-242"><a href="#cb118-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-243"><a href="#cb118-243" aria-hidden="true" tabindex="-1"></a>CTD <span class="ot">&lt;-</span> <span class="fu">tab.disjonctif</span>(x)</span>
<span id="cb118-244"><a href="#cb118-244" aria-hidden="true" tabindex="-1"></a>pk <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(CTD)</span>
<span id="cb118-245"><a href="#cb118-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-246"><a href="#cb118-246" aria-hidden="true" tabindex="-1"></a>CTD[<span class="dv">1</span>, ] <span class="sc">/</span> pk</span>
<span id="cb118-247"><a href="#cb118-247" aria-hidden="true" tabindex="-1"></a>CTD[<span class="dv">4</span>, ] <span class="sc">/</span> pk</span>
<span id="cb118-248"><a href="#cb118-248" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">/</span>.<span class="dv">64</span></span>
<span id="cb118-249"><a href="#cb118-249" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">/</span>.<span class="dv">56666667</span></span>
<span id="cb118-250"><a href="#cb118-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-251"><a href="#cb118-251" aria-hidden="true" tabindex="-1"></a>CTD_t <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(CTD, <span class="dv">1</span>, <span class="cf">function</span>(r) {<span class="fu">t</span>(r)<span class="sc">/</span>pk} ))</span>
<span id="cb118-252"><a href="#cb118-252" aria-hidden="true" tabindex="-1"></a><span class="fu">colMeans</span>(CTD_t)</span>
<span id="cb118-253"><a href="#cb118-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-254"><a href="#cb118-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-255"><a href="#cb118-255" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">tab.disjonctif</span>(x)</span>
<span id="cb118-256"><a href="#cb118-256" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">/</span><span class="fu">nrow</span>(tea)</span>
<span id="cb118-257"><a href="#cb118-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-258"><a href="#cb118-258" aria-hidden="true" tabindex="-1"></a><span class="co"># Correspondance analysis based on contingency table ---------------------------</span></span>
<span id="cb118-259"><a href="#cb118-259" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> tea[, <span class="fu">c</span>(<span class="st">"SPC"</span>, <span class="st">"where"</span>)]</span>
<span id="cb118-260"><a href="#cb118-260" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb118-261"><a href="#cb118-261" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">nlevels</span>(x[, <span class="dv">1</span>]) </span>
<span id="cb118-262"><a href="#cb118-262" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">nlevels</span>(x[, <span class="dv">2</span>]) </span>
<span id="cb118-263"><a href="#cb118-263" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">table</span>(x)</span>
<span id="cb118-264"><a href="#cb118-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-265"><a href="#cb118-265" aria-hidden="true" tabindex="-1"></a><span class="co"># Contingency table</span></span>
<span id="cb118-266"><a href="#cb118-266" aria-hidden="true" tabindex="-1"></a>N</span>
<span id="cb118-267"><a href="#cb118-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-268"><a href="#cb118-268" aria-hidden="true" tabindex="-1"></a><span class="co"># Indicator matrix</span></span>
<span id="cb118-269"><a href="#cb118-269" aria-hidden="true" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">tab.disjonctif</span>(x)</span>
<span id="cb118-270"><a href="#cb118-270" aria-hidden="true" tabindex="-1"></a>Z1 <span class="ot">&lt;-</span> Z[, <span class="dv">1</span><span class="sc">:</span>r]</span>
<span id="cb118-271"><a href="#cb118-271" aria-hidden="true" tabindex="-1"></a>Z2 <span class="ot">&lt;-</span> Z[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>r)]</span>
<span id="cb118-272"><a href="#cb118-272" aria-hidden="true" tabindex="-1"></a>N <span class="sc">-</span> <span class="fu">t</span>(Z1) <span class="sc">%*%</span> Z2</span>
<span id="cb118-273"><a href="#cb118-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-274"><a href="#cb118-274" aria-hidden="true" tabindex="-1"></a><span class="co"># Correspondance matrix</span></span>
<span id="cb118-275"><a href="#cb118-275" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>n <span class="sc">*</span> N</span>
<span id="cb118-276"><a href="#cb118-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-277"><a href="#cb118-277" aria-hidden="true" tabindex="-1"></a><span class="co"># From Greenacre1984</span></span>
<span id="cb118-278"><a href="#cb118-278" aria-hidden="true" tabindex="-1"></a>N</span>
<span id="cb118-279"><a href="#cb118-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-280"><a href="#cb118-280" aria-hidden="true" tabindex="-1"></a><span class="co"># Column and row sums</span></span>
<span id="cb118-281"><a href="#cb118-281" aria-hidden="true" tabindex="-1"></a>r_bold <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(N)</span>
<span id="cb118-282"><a href="#cb118-282" aria-hidden="true" tabindex="-1"></a>c_bold <span class="ot">&lt;-</span> <span class="fu">colSums</span>(N)</span>
<span id="cb118-283"><a href="#cb118-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-284"><a href="#cb118-284" aria-hidden="true" tabindex="-1"></a><span class="fu">drop</span>(N <span class="sc">%*%</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">ncol</span>(N))) <span class="sc">-</span> r_bold</span>
<span id="cb118-285"><a href="#cb118-285" aria-hidden="true" tabindex="-1"></a><span class="fu">drop</span>(<span class="fu">t</span>(N) <span class="sc">%*%</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(N))) <span class="sc">-</span> c_bold</span>
<span id="cb118-286"><a href="#cb118-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-287"><a href="#cb118-287" aria-hidden="true" tabindex="-1"></a>D_r <span class="ot">&lt;-</span> <span class="fu">diag</span>(r_bold)</span>
<span id="cb118-288"><a href="#cb118-288" aria-hidden="true" tabindex="-1"></a>D_c <span class="ot">&lt;-</span> <span class="fu">diag</span>(c_bold)</span>
<span id="cb118-289"><a href="#cb118-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-290"><a href="#cb118-290" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrices of profiles</span></span>
<span id="cb118-291"><a href="#cb118-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-292"><a href="#cb118-292" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fu">solve</span>(D_r) <span class="sc">%*%</span> P</span>
<span id="cb118-293"><a href="#cb118-293" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">solve</span>(D_c) <span class="sc">%*%</span> <span class="fu">t</span>(P)</span>
<span id="cb118-294"><a href="#cb118-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-295"><a href="#cb118-295" aria-hidden="true" tabindex="-1"></a><span class="co"># Centroids</span></span>
<span id="cb118-296"><a href="#cb118-296" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">t</span>(C) <span class="sc">%*%</span> c_bold</span>
<span id="cb118-297"><a href="#cb118-297" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">t</span>(R) <span class="sc">%*%</span> r_bold</span>
<span id="cb118-298"><a href="#cb118-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-299"><a href="#cb118-299" aria-hidden="true" tabindex="-1"></a><span class="co"># Generalized SVD of P - r_bold t(c_bold)</span></span>
<span id="cb118-300"><a href="#cb118-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-301"><a href="#cb118-301" aria-hidden="true" tabindex="-1"></a>P <span class="sc">-</span> r_bold <span class="sc">%*%</span> <span class="fu">t</span>(c_bold)</span>
<span id="cb118-302"><a href="#cb118-302" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">svd</span>(P <span class="sc">-</span> r <span class="sc">%*%</span> <span class="fu">t</span>(c))<span class="sc">$</span>u</span>
<span id="cb118-303"><a href="#cb118-303" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">svd</span>(P <span class="sc">-</span> r <span class="sc">%*%</span> <span class="fu">t</span>(c))<span class="sc">$</span>v</span>
<span id="cb118-304"><a href="#cb118-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-305"><a href="#cb118-305" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(A) <span class="sc">%*%</span> <span class="fu">solve</span>(D_r) <span class="sc">%*%</span> A</span>
<span id="cb118-306"><a href="#cb118-306" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(B) <span class="sc">%*%</span> <span class="fu">solve</span>(D_c) <span class="sc">%*%</span> B</span>
<span id="cb118-307"><a href="#cb118-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-308"><a href="#cb118-308" aria-hidden="true" tabindex="-1"></a><span class="co"># From Jolliffe p. 37</span></span>
<span id="cb118-309"><a href="#cb118-309" aria-hidden="true" tabindex="-1"></a><span class="co"># r_bold &lt;- rep(1, r)</span></span>
<span id="cb118-310"><a href="#cb118-310" aria-hidden="true" tabindex="-1"></a><span class="co"># c_bold &lt;- rep(1, C)</span></span>
<span id="cb118-311"><a href="#cb118-311" aria-hidden="true" tabindex="-1"></a><span class="co"># D_r &lt;- diag(r_bold)</span></span>
<span id="cb118-312"><a href="#cb118-312" aria-hidden="true" tabindex="-1"></a><span class="co"># D_c &lt;- diag(c_bold)</span></span>
<span id="cb118-313"><a href="#cb118-313" aria-hidden="true" tabindex="-1"></a><span class="co"># Omega &lt;- solve(D_r)</span></span>
<span id="cb118-314"><a href="#cb118-314" aria-hidden="true" tabindex="-1"></a><span class="co"># Psi &lt;- solve(D_c)</span></span>
<span id="cb118-315"><a href="#cb118-315" aria-hidden="true" tabindex="-1"></a><span class="co"># X &lt;- P - r_bold %*% t(c_bold)</span></span>
<span id="cb118-316"><a href="#cb118-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-317"><a href="#cb118-317" aria-hidden="true" tabindex="-1"></a><span class="co"># V &lt;- svd(X)$u</span></span>
<span id="cb118-318"><a href="#cb118-318" aria-hidden="true" tabindex="-1"></a><span class="co"># M &lt;- diag(svd(X)$d)</span></span>
<span id="cb118-319"><a href="#cb118-319" aria-hidden="true" tabindex="-1"></a><span class="co"># B &lt;- svd(X)$v</span></span>
<span id="cb118-320"><a href="#cb118-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-321"><a href="#cb118-321" aria-hidden="true" tabindex="-1"></a><span class="co"># round(t(V) %*% Omega %*% V, 3)</span></span>
<span id="cb118-322"><a href="#cb118-322" aria-hidden="true" tabindex="-1"></a><span class="co"># round(t(B) %*% Psi %*% B, 3)</span></span>
<span id="cb118-323"><a href="#cb118-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-324"><a href="#cb118-324" aria-hidden="true" tabindex="-1"></a><span class="co"># X_til &lt;- sqrt(Omega) %*% X %*% sqrt(Psi)</span></span>
<span id="cb118-325"><a href="#cb118-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-326"><a href="#cb118-326" aria-hidden="true" tabindex="-1"></a><span class="co"># W &lt;- svd(X_til)$u</span></span>
<span id="cb118-327"><a href="#cb118-327" aria-hidden="true" tabindex="-1"></a><span class="co"># K &lt;- diag(svd(X_til)$d)</span></span>
<span id="cb118-328"><a href="#cb118-328" aria-hidden="true" tabindex="-1"></a><span class="co"># C &lt;- svd(X_til)$v</span></span>
<span id="cb118-329"><a href="#cb118-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-330"><a href="#cb118-330" aria-hidden="true" tabindex="-1"></a><span class="co"># solve(sqrt(Omega)) %*% W - V</span></span>
<span id="cb118-331"><a href="#cb118-331" aria-hidden="true" tabindex="-1"></a><span class="co"># solve(sqrt(Omega)) %*% C - B</span></span>
<span id="cb118-332"><a href="#cb118-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-333"><a href="#cb118-333" aria-hidden="true" tabindex="-1"></a><span class="co"># W %*% K</span></span>
<span id="cb118-334"><a href="#cb118-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-335"><a href="#cb118-335" aria-hidden="true" tabindex="-1"></a><span class="co"># # Row profiles</span></span>
<span id="cb118-336"><a href="#cb118-336" aria-hidden="true" tabindex="-1"></a><span class="co"># D_r</span></span>
<span id="cb118-337"><a href="#cb118-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-338"><a href="#cb118-338" aria-hidden="true" tabindex="-1"></a><span class="co"># MCA based on Audigier et al 2017 p. 505 (p. 5 of pdf) ------------------------</span></span>
<span id="cb118-339"><a href="#cb118-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-340"><a href="#cb118-340" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Work with categorical predictors from the tea dataset</span></span>
<span id="cb118-341"><a href="#cb118-341" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> tea[, <span class="fu">c</span>(<span class="st">"where"</span>, <span class="st">"how"</span>, <span class="st">"Tea"</span>)]</span>
<span id="cb118-342"><a href="#cb118-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-343"><a href="#cb118-343" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define row weights</span></span>
<span id="cb118-344"><a href="#cb118-344" aria-hidden="true" tabindex="-1"></a>    I <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb118-345"><a href="#cb118-345" aria-hidden="true" tabindex="-1"></a>    R <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">1</span> <span class="sc">/</span> I, I)</span>
<span id="cb118-346"><a href="#cb118-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-347"><a href="#cb118-347" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define Z (the disjunctive table)</span></span>
<span id="cb118-348"><a href="#cb118-348" aria-hidden="true" tabindex="-1"></a>    Z <span class="ot">&lt;-</span> <span class="fu">tab.disjonctif</span>(x)</span>
<span id="cb118-349"><a href="#cb118-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-350"><a href="#cb118-350" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define column weights</span></span>
<span id="cb118-351"><a href="#cb118-351" aria-hidden="true" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">ncol</span>(x)</span>
<span id="cb118-352"><a href="#cb118-352" aria-hidden="true" tabindex="-1"></a>    plxk <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(Z)</span>
<span id="cb118-353"><a href="#cb118-353" aria-hidden="true" tabindex="-1"></a>    D_sigma <span class="ot">&lt;-</span> <span class="fu">diag</span>(plxk)</span>
<span id="cb118-354"><a href="#cb118-354" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span> <span class="sc">/</span> K <span class="sc">*</span> <span class="fu">solve</span>(D_sigma)</span>
<span id="cb118-355"><a href="#cb118-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-356"><a href="#cb118-356" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define M</span></span>
<span id="cb118-357"><a href="#cb118-357" aria-hidden="true" tabindex="-1"></a>    M <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(plxk, I), <span class="at">nrow =</span> I, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb118-358"><a href="#cb118-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-359"><a href="#cb118-359" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Centered matrix?</span></span>
<span id="cb118-360"><a href="#cb118-360" aria-hidden="true" tabindex="-1"></a>    Z <span class="sc">-</span> M</span>
<span id="cb118-361"><a href="#cb118-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-362"><a href="#cb118-362" aria-hidden="true" tabindex="-1"></a><span class="co"># MCA based on Chavent Et Al 2017 et al 2017 p. 505 (p. 5 of pdf) -----------1  ---</span></span>
<span id="cb118-363"><a href="#cb118-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-364"><a href="#cb118-364" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Work with categorical predictors from the tea dataset</span></span>
<span id="cb118-365"><a href="#cb118-365" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> tea[, <span class="fu">c</span>(<span class="st">"where"</span>, <span class="st">"how"</span>, <span class="st">"Tea"</span>)]</span>
<span id="cb118-366"><a href="#cb118-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-367"><a href="#cb118-367" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define Z (the disjunctive table)</span></span>
<span id="cb118-368"><a href="#cb118-368" aria-hidden="true" tabindex="-1"></a>    G <span class="ot">&lt;-</span> <span class="fu">tab.disjonctif</span>(x)</span>
<span id="cb118-369"><a href="#cb118-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-370"><a href="#cb118-370" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define row weights</span></span>
<span id="cb118-371"><a href="#cb118-371" aria-hidden="true" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb118-372"><a href="#cb118-372" aria-hidden="true" tabindex="-1"></a>    N <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="dv">1</span> <span class="sc">/</span> n, n)</span>
<span id="cb118-373"><a href="#cb118-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-374"><a href="#cb118-374" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define column weights</span></span>
<span id="cb118-375"><a href="#cb118-375" aria-hidden="true" tabindex="-1"></a>    M <span class="ot">&lt;-</span> <span class="fu">diag</span>(n <span class="sc">/</span> <span class="fu">colSums</span>(G))</span>
<span id="cb118-376"><a href="#cb118-376" aria-hidden="true" tabindex="-1"></a>    <span class="fu">solve</span>(D_sigma)</span>
<span id="cb118-377"><a href="#cb118-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-378"><a href="#cb118-378" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create Z, the centered G?</span></span>
<span id="cb118-379"><a href="#cb118-379" aria-hidden="true" tabindex="-1"></a>    plxk <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(G)</span>
<span id="cb118-380"><a href="#cb118-380" aria-hidden="true" tabindex="-1"></a>    G <span class="sc">-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(plxk, I), <span class="at">nrow =</span> I, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb118-381"><a href="#cb118-381" aria-hidden="true" tabindex="-1"></a>    Z <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">t</span>(G) <span class="sc">-</span> plxk)</span>
<span id="cb118-382"><a href="#cb118-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-383"><a href="#cb118-383" aria-hidden="true" tabindex="-1"></a>    <span class="co"># SVD of Z</span></span>
<span id="cb118-384"><a href="#cb118-384" aria-hidden="true" tabindex="-1"></a>    u_til <span class="ot">&lt;-</span> <span class="fu">svd</span>(Z)<span class="sc">$</span>u</span>
<span id="cb118-385"><a href="#cb118-385" aria-hidden="true" tabindex="-1"></a>    lambda_til <span class="ot">&lt;-</span> <span class="fu">svd</span>(Z)<span class="sc">$</span>d</span>
<span id="cb118-386"><a href="#cb118-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-387"><a href="#cb118-387" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Principal Compoent Scores (factor coordinates of the rows)</span></span>
<span id="cb118-388"><a href="#cb118-388" aria-hidden="true" tabindex="-1"></a>    u_til[, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>] <span class="sc">%*%</span> <span class="fu">diag</span>(lambda_til[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } 
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>