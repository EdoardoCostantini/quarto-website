{
  "hash": "f4cddaa3405b7dbd8c1573104f783002",
  "result": {
    "markdown": "---\ndraft: false\ntitle: Understanding boxplots\nauthor: Edoardo Costantini\ndate: '2022-09-05'\nslug: boxplots\ncategories: [\"Plotting\"]\nbibliography: ../../resources/bibshelf.bib\n---\n\n\n# Reading a boxplot\n\nBoxplots are descriptive tools to visualize the distribution of variables with a focus on their measures of spread and center.\nA boxplots report in the same figure the median, the 1st and 3rd quartiles, and indicate possible outliers.\n\nImagine wanting to plot the distribution of age in a court of students enrolled in a master program at a university.\nThe age of the students is likely to be normally distributed around a mean of 26.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Set up ----------------------------------------------------------------------\n\n# Set seed\nset.seed(20220906)\n\n# Generate some age variable for a university master programme\nage <- round(rnorm(1e3, mean = 26, sd = 2), 0)\n```\n:::\n\n\nThen, we can create the boxplot of this age variable in R by using the `boxplot()` function.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Look at the boxplot ---------------------------------------------------------\nboxplot(age)\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](boxplots_files/figure-html/boxplot-explained-1.png){width=720}\n:::\n:::\n\n\nThe variable age is centered around 26 and 50% of the distribution is located between 25 (1st quartile) and 27 (3rd quartile).\nThere are 6 values that represent possible outliers (the circles outside the whiskers).\n\n# Play around with boxplots\n\nYou can compute the statistics used to draw the boxplot explicitly by following this code:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Compute boxplot statistics manually ------------------------------------------\n\n# Compute the median\nmed <- median(age)\n\n# Compute 1st and 3rd quartiles\nqnt <- quantile(age, probs = c(.25, .75))\n\n# Compute interquartile range\nIQR <- diff(qnt)[[1]]\n\n# Compute fences/whisker bounds\nC <- 1.5 # range multiplier\nfences <- c(lwr = qnt[[1]] - C * IQR, upr = qnt[[2]] + C * IQR)\n\n# Put together the boxplot stats\nbxstats <- sort(c(med = med, qnt, f = fences))\n\n# Compute boxplot statistics with R function\nbxstats_auto <- boxplot.stats(age, coef = C)$stats\n\n# Compare results obtain manually and with the R function\ndata.frame(manual = bxstats, R.function = bxstats_auto)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      manual R.function\nf.lwr     22         22\n25%       25         25\nmed       26         26\n75%       27         27\nf.upr     30         30\n```\n:::\n:::\n\n\nYou can visualize the impact of different choices for the range multiplier `C`.\nIn the following pictures, you can see that a larger `C` is less restrictive in which values are considered outliers.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](boxplots_files/figure-html/boxplot-c-1.png){width=1344}\n:::\n:::\n\n\n## TL;DR, just give me the code!\n\n::: {.cell}\n\n```{.r .cell-code}\n# Set up ----------------------------------------------------------------------\n\n# Set seed\nset.seed(20220906)\n\n# Generate some age variable for a university master programme\nage <- round(rnorm(1e3, mean = 26, sd = 2), 0)\n\n# Look at the boxplot ---------------------------------------------------------\nboxplot(age)\n\n# Boxplot with explanation\nC <- 1.5 # range multiplier\nboxplot(age, range = C)\n\n# Add arrows pointings to statistics\narrows(x0 = .69, y0 = boxplot.stats(age, coef = C)$stats,\n       x1 = c(.875, rep(.765, 3), .875), y1 = boxplot.stats(age, coef = C)$stats,\n       length = 0.1)\n\n# Add labels of statistics\ntext(x = rep(.66, 5),\n     y = boxplot.stats(age, coef = C)$stats,\n     labels = c(\"lower whisker\",\n                \"1st quartile\",\n                \"median\",\n                \"3rd quartile\",\n                \"upper whisker\"),\n     adj = 1)\n\n# Add y axis labels\naxis(side = 2, at = boxplot.stats(age, coef = C)$stats[c(1, 3, 4)], labels = TRUE)\n\n# Compute boxplot statistics manually ------------------------------------------\n\n# Compute the median\nmed <- median(age)\n\n# Compute 1st and 3rd quartiles\nqnt <- quantile(age, probs = c(.25, .75))\n\n# Compute interquartile range\nIQR <- diff(qnt)[[1]]\n\n# Compute fences/whisker bounds\nC <- 1.5 # range multiplier\nfences <- c(lwr = qnt[[1]] - C * IQR, upr = qnt[[2]] + C * IQR)\n\n# Put together the boxplot stats\nbxstats <- sort(c(med = med, qnt, f = fences))\n\n# Compute boxplot statistics with R function\nbxstats_auto <- boxplot.stats(age, coef = C)$stats\n\n# Compare results obtain manually and with the R function\ndata.frame(manual = bxstats, R.function = bxstats_auto)\n\n# Visualize the effect of different C -----------------------------------------\n\n# Allow two plots one next to the other\npar(mfrow = c(1, 2))\n\n# Plot C = 1.5 and 3\nlapply(c(1.5, 3.0), FUN = function (x){\n  C <- x\n  boxplot(age, range = C, main = paste0(\"C = \", C))\n\n  # Add arrows pointings to statistics\n  arrows(x0 = .69, y0 = boxplot.stats(age, coef = C)$stats,\n         x1 = c(.875, rep(.765, 3), .875), y1 = boxplot.stats(age, coef = C)$stats,\n         length = 0.1)\n  # Add labels of statistics\n  text(x = rep(.66, 5),\n       y = boxplot.stats(age, coef = C)$stats,\n       labels = c(paste(ifelse(C == 1.5, \"inner\", \"outer\"), \"fence \\n lower bound\"),\n                  \"1st quartile\",\n                  \"median\",\n                  \"3rd quartile\",\n                  paste(ifelse(C == 1.5, \"inner\", \"outer\"), \"fence \\n upper bound\")),\n       adj = 1)\n})\n```\n:::",
    "supporting": [
      "boxplots_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}