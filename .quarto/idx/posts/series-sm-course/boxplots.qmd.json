{"title":"Understanding boxplots","markdown":{"yaml":{"draft":false,"title":"Understanding boxplots","author":"Edoardo Costantini","date":"2022-09-05","slug":"boxplots","categories":["Plotting"],"bibliography":"../../resources/bibshelf.bib"},"headingText":"Reading a boxplot","containsRefs":false,"markdown":"\n\n\nBoxplots are descriptive tools to visualize the distribution of variables with a focus on their measures of spread and center.\nA boxplots report in the same figure the median, the 1st and 3rd quartiles, and indicate possible outliers.\n\nImagine wanting to plot the distribution of age in a court of students enrolled in a master program at a university.\nThe age of the students is likely to be normally distributed around a mean of 26.\n\n```{r generate-data}\n\n# Set up ----------------------------------------------------------------------\n\n# Set seed\nset.seed(20220906)\n\n# Generate some age variable for a university master programme\nage <- round(rnorm(1e3, mean = 26, sd = 2), 0)\n```\n\nThen, we can create the boxplot of this age variable in R by using the `boxplot()` function.\n\n```{r boxplot, eval = FALSE}\n\n# Look at the boxplot ---------------------------------------------------------\nboxplot(age)\n```\n\n```{r boxplot-explained, warning = FALSE, message = FALSE, echo=FALSE, fig.width=7.5, fig.height = 7.5}\n\n# Boxplot with explanation\nC <- 1.5 # range multiplier\nboxplot(age, range = C)\n\n# Add arrows pointings to statistics\narrows(x0 = .69, y0 = boxplot.stats(age, coef = C)$stats,\n       x1 = c(.875, rep(.765, 3), .875), y1 = boxplot.stats(age, coef = C)$stats,\n       length = 0.1)\n\n# Add labels of statistics\ntext(x = rep(.66, 5),\n     y = boxplot.stats(age, coef = C)$stats,\n     labels = c(\"lower whisker\",\n                \"1st quartile\",\n                \"median\",\n                \"3rd quartile\",\n                \"upper whisker\"),\n     adj = 1)\n\n# Add y axis labels\naxis(side = 2, at = boxplot.stats(age, coef = C)$stats[c(1, 3, 4)], labels = TRUE)\n```\n\nThe variable age is centered around 26 and 50% of the distribution is located between 25 (1st quartile) and 27 (3rd quartile).\nThere are 6 values that represent possible outliers (the circles outside the whiskers).\n\n# Play around with boxplots\n\nYou can compute the statistics used to draw the boxplot explicitly by following this code:\n\n```{r boxplot-code}\n\n# Compute boxplot statistics manually ------------------------------------------\n\n# Compute the median\nmed <- median(age)\n\n# Compute 1st and 3rd quartiles\nqnt <- quantile(age, probs = c(.25, .75))\n\n# Compute interquartile range\nIQR <- diff(qnt)[[1]]\n\n# Compute fences/whisker bounds\nC <- 1.5 # range multiplier\nfences <- c(lwr = qnt[[1]] - C * IQR, upr = qnt[[2]] + C * IQR)\n\n# Put together the boxplot stats\nbxstats <- sort(c(med = med, qnt, f = fences))\n\n# Compute boxplot statistics with R function\nbxstats_auto <- boxplot.stats(age, coef = C)$stats\n\n# Compare results obtain manually and with the R function\ndata.frame(manual = bxstats, R.function = bxstats_auto)\n```\n\nYou can visualize the impact of different choices for the range multiplier `C`.\nIn the following pictures, you can see that a larger `C` is less restrictive in which values are considered outliers.\n\n```{r boxplot-c, results='hide', warning = FALSE, message = FALSE, echo=FALSE, fig.width=14, fig.height = 7.5}\n\n# Visualize the effect of different C -----------------------------------------\n\n# Allow two plots one next to the other\npar(mfrow = c(1, 2))\n\n# Plot C = 1.5 and 3\nlapply(c(1.5, 3.0), FUN = function (x){\n  C <- x\n  boxplot(age, range = C, main = paste0(\"C = \", C))\n\n  # Add arrows pointings to statistics\n  arrows(x0 = .69, y0 = boxplot.stats(age, coef = C)$stats,\n         x1 = c(.875, rep(.765, 3), .875), y1 = boxplot.stats(age, coef = C)$stats,\n         length = 0.1)\n  # Add labels of statistics\n  text(x = rep(.66, 5),\n       y = boxplot.stats(age, coef = C)$stats,\n       labels = c(paste(ifelse(C == 1.5, \"inner\", \"outer\"), \"fence \\n lower bound\"),\n                  \"1st quartile\",\n                  \"median\",\n                  \"3rd quartile\",\n                  paste(ifelse(C == 1.5, \"inner\", \"outer\"), \"fence \\n upper bound\")),\n       adj = 1)\n})\n```\n\n## TL;DR, just give me the code!\n```{r TLDR, ref.label = knitr::all_labels(), echo=TRUE, eval=FALSE}\n```","srcMarkdownNoYaml":"\n\n# Reading a boxplot\n\nBoxplots are descriptive tools to visualize the distribution of variables with a focus on their measures of spread and center.\nA boxplots report in the same figure the median, the 1st and 3rd quartiles, and indicate possible outliers.\n\nImagine wanting to plot the distribution of age in a court of students enrolled in a master program at a university.\nThe age of the students is likely to be normally distributed around a mean of 26.\n\n```{r generate-data}\n\n# Set up ----------------------------------------------------------------------\n\n# Set seed\nset.seed(20220906)\n\n# Generate some age variable for a university master programme\nage <- round(rnorm(1e3, mean = 26, sd = 2), 0)\n```\n\nThen, we can create the boxplot of this age variable in R by using the `boxplot()` function.\n\n```{r boxplot, eval = FALSE}\n\n# Look at the boxplot ---------------------------------------------------------\nboxplot(age)\n```\n\n```{r boxplot-explained, warning = FALSE, message = FALSE, echo=FALSE, fig.width=7.5, fig.height = 7.5}\n\n# Boxplot with explanation\nC <- 1.5 # range multiplier\nboxplot(age, range = C)\n\n# Add arrows pointings to statistics\narrows(x0 = .69, y0 = boxplot.stats(age, coef = C)$stats,\n       x1 = c(.875, rep(.765, 3), .875), y1 = boxplot.stats(age, coef = C)$stats,\n       length = 0.1)\n\n# Add labels of statistics\ntext(x = rep(.66, 5),\n     y = boxplot.stats(age, coef = C)$stats,\n     labels = c(\"lower whisker\",\n                \"1st quartile\",\n                \"median\",\n                \"3rd quartile\",\n                \"upper whisker\"),\n     adj = 1)\n\n# Add y axis labels\naxis(side = 2, at = boxplot.stats(age, coef = C)$stats[c(1, 3, 4)], labels = TRUE)\n```\n\nThe variable age is centered around 26 and 50% of the distribution is located between 25 (1st quartile) and 27 (3rd quartile).\nThere are 6 values that represent possible outliers (the circles outside the whiskers).\n\n# Play around with boxplots\n\nYou can compute the statistics used to draw the boxplot explicitly by following this code:\n\n```{r boxplot-code}\n\n# Compute boxplot statistics manually ------------------------------------------\n\n# Compute the median\nmed <- median(age)\n\n# Compute 1st and 3rd quartiles\nqnt <- quantile(age, probs = c(.25, .75))\n\n# Compute interquartile range\nIQR <- diff(qnt)[[1]]\n\n# Compute fences/whisker bounds\nC <- 1.5 # range multiplier\nfences <- c(lwr = qnt[[1]] - C * IQR, upr = qnt[[2]] + C * IQR)\n\n# Put together the boxplot stats\nbxstats <- sort(c(med = med, qnt, f = fences))\n\n# Compute boxplot statistics with R function\nbxstats_auto <- boxplot.stats(age, coef = C)$stats\n\n# Compare results obtain manually and with the R function\ndata.frame(manual = bxstats, R.function = bxstats_auto)\n```\n\nYou can visualize the impact of different choices for the range multiplier `C`.\nIn the following pictures, you can see that a larger `C` is less restrictive in which values are considered outliers.\n\n```{r boxplot-c, results='hide', warning = FALSE, message = FALSE, echo=FALSE, fig.width=14, fig.height = 7.5}\n\n# Visualize the effect of different C -----------------------------------------\n\n# Allow two plots one next to the other\npar(mfrow = c(1, 2))\n\n# Plot C = 1.5 and 3\nlapply(c(1.5, 3.0), FUN = function (x){\n  C <- x\n  boxplot(age, range = C, main = paste0(\"C = \", C))\n\n  # Add arrows pointings to statistics\n  arrows(x0 = .69, y0 = boxplot.stats(age, coef = C)$stats,\n         x1 = c(.875, rep(.765, 3), .875), y1 = boxplot.stats(age, coef = C)$stats,\n         length = 0.1)\n  # Add labels of statistics\n  text(x = rep(.66, 5),\n       y = boxplot.stats(age, coef = C)$stats,\n       labels = c(paste(ifelse(C == 1.5, \"inner\", \"outer\"), \"fence \\n lower bound\"),\n                  \"1st quartile\",\n                  \"median\",\n                  \"3rd quartile\",\n                  paste(ifelse(C == 1.5, \"inner\", \"outer\"), \"fence \\n upper bound\")),\n       adj = 1)\n})\n```\n\n## TL;DR, just give me the code!\n```{r TLDR, ref.label = knitr::all_labels(), echo=TRUE, eval=FALSE}\n```"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../styles.css"],"toc":true,"output-file":"boxplots.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.450","theme":{"light":["flatly","light.scss"],"dark":["darkly","dark.scss"]},"title-block-banner":true,"draft":false,"title":"Understanding boxplots","author":"Edoardo Costantini","date":"2022-09-05","slug":"boxplots","categories":["Plotting"],"bibliography":["../../resources/bibshelf.bib"]},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}